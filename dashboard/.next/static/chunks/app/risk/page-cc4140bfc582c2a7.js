(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{572:(e,t,s)=>{Promise.resolve().then(s.bind(s,8975))},8827:(e,t,s)=>{"use strict";s.d(t,{S:()=>l,WsProvider:()=>a});var r=s(7113),n=s(1565);let c=(0,n.createContext)({lastMessage:null,connected:!1});function l(){return(0,n.useContext)(c)}function a(e){let{children:t}=e,[s,l]=(0,n.useState)(null),[a,i]=(0,n.useState)(!1),d=(0,n.useRef)(null),x=(0,n.useRef)(void 0),o=(0,n.useCallback)(()=>{let e="https:"===window.location.protocol?"wss:":"ws:",t=new WebSocket("".concat(e,"//").concat(window.location.host));d.current=t,t.onopen=()=>i(!0),t.onclose=()=>{i(!1),x.current=setTimeout(o,3e3)},t.onmessage=e=>{try{let t=JSON.parse(e.data);l(t)}catch(e){}}},[]);return(0,n.useEffect)(()=>(o(),()=>{var e;clearTimeout(x.current),null==(e=d.current)||e.close()}),[o]),(0,r.jsx)(c.Provider,{value:{lastMessage:s,connected:a},children:t})}},8975:(e,t,s)=>{"use strict";s.d(t,{RiskTable:()=>l});var r=s(7113),n=s(1565),c=s(8827);function l(){let[e,t]=(0,n.useState)([]),{lastMessage:s}=(0,c.S)();return(0,n.useEffect)(()=>{fetch("/api/risk?limit=50").then(e=>e.json()).then(t)},[]),(0,n.useEffect)(()=>{(null==s?void 0:s.type)==="risk_event"&&t(e=>[s.data,...e].slice(0,50))},[s]),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-xs text-zinc-500 uppercase tracking-wider border-b border-zinc-800",children:[(0,r.jsx)("th",{className:"pb-2 pr-4",children:"Time"}),(0,r.jsx)("th",{className:"pb-2 pr-4",children:"Rule"}),(0,r.jsx)("th",{className:"pb-2 pr-4",children:"Triggered"}),(0,r.jsx)("th",{className:"pb-2 pr-4 text-right",children:"Current"}),(0,r.jsx)("th",{className:"pb-2 pr-4 text-right",children:"Threshold"}),(0,r.jsx)("th",{className:"pb-2 pr-4",children:"Action"}),(0,r.jsx)("th",{className:"pb-2",children:"Details"})]})}),(0,r.jsxs)("tbody",{children:[e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-zinc-800/50 hover:bg-zinc-800/30",children:[(0,r.jsx)("td",{className:"py-2 pr-4 font-mono text-xs text-zinc-400",children:new Date(e.timestamp).toLocaleString()}),(0,r.jsx)("td",{className:"py-2 pr-4",children:(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-zinc-800 text-zinc-300",children:e.rule_name})}),(0,r.jsx)("td",{className:"py-2 pr-4",children:e.triggered?(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-red-900/50 text-red-400",children:"TRIGGERED"}):(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs bg-emerald-900/50 text-emerald-400",children:"PASS"})}),(0,r.jsx)("td",{className:"py-2 pr-4 text-right font-mono text-xs",children:e.current_value.toFixed(4)}),(0,r.jsx)("td",{className:"py-2 pr-4 text-right font-mono text-xs",children:e.threshold.toFixed(4)}),(0,r.jsx)("td",{className:"py-2 pr-4 text-xs text-zinc-400",children:e.action}),(0,r.jsx)("td",{className:"py-2 text-xs text-zinc-500 max-w-xs truncate",children:e.details})]},e.id)),0===e.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"py-8 text-center text-zinc-600",children:"No risk events yet"})})]})]})})}}},e=>{e.O(0,[345,355,358],()=>e(e.s=572)),_N_E=e.O()}]);