"use strict";exports.id=744,exports.ids=[744],exports.modules={2744:(a,b,c)=>{function d(a){var b=a.width,c=a.height;if(b<0)throw Error("Negative width is not allowed for Size");if(c<0)throw Error("Negative height is not allowed for Size");return{width:b,height:c}}function e(a,b){return a.width===b.width&&a.height===b.height}c.r(b),c.d(b,{ColorType:()=>n,CrosshairMode:()=>h,LastPriceAnimationMode:()=>l,LineStyle:()=>g,LineType:()=>f,MismatchDirection:()=>i,PriceLineSource:()=>m,PriceScaleMode:()=>j,TickMarkType:()=>o,TrackingModeExitMode:()=>k,createChart:()=>dP,createChartEx:()=>dO,customSeriesDefaultOptions:()=>dR,defaultHorzScaleBehavior:()=>dQ,isBusinessDay:()=>cm,isUTCTimestamp:()=>cn,version:()=>dS});var f,g,h,i,j,k,l,m,n,o,p,q=function(){function a(a){var b=this;this._resolutionListener=function(){return b._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=a,this._installResolutionListener()}return a.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(a.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),a.prototype.subscribe=function(a){var b=this,c={next:a};return this._observers.push(c),{unsubscribe:function(){b._observers=b._observers.filter(function(a){return a!==c})}}},a.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw Error("Resolution listener is already installed");var a=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(a,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},a.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},a.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},a.prototype._onResolutionChanged=function(){var a=this;this._observers.forEach(function(b){return b.next(a._window.devicePixelRatio)}),this._reinstallResolutionListener()},a}(),r=function(){function a(a,b,c){var e;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=a,this._canvasElementClientSize=d({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=null!=b?b:function(a){return a},this._allowResizeObserver=null==(e=null==c?void 0:c.allowResizeObserver)||e,this._chooseAndInitObserver()}return a.prototype.dispose=function(){var a,b;if(null===this._canvasElement)throw Error("Object is disposed");null==(a=this._canvasElementResizeObserver)||a.disconnect(),this._canvasElementResizeObserver=null,null==(b=this._devicePixelRatioObservable)||b.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(a.prototype,"canvasElement",{get:function(){if(null===this._canvasElement)throw Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bitmapSize",{get:function(){return d({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),a.prototype.resizeCanvasElement=function(a){this._canvasElementClientSize=d(a),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},a.prototype.subscribeBitmapSizeChanged=function(a){this._bitmapSizeChangedListeners.push(a)},a.prototype.unsubscribeBitmapSizeChanged=function(a){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(b){return b!==a})},Object.defineProperty(a.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),a.prototype.subscribeSuggestedBitmapSizeChanged=function(a){this._suggestedBitmapSizeChangedListeners.push(a)},a.prototype.unsubscribeSuggestedBitmapSizeChanged=function(a){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(b){return b!==a})},a.prototype.applySuggestedBitmapSize=function(){if(null!==this._suggestedBitmapSize){var a=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(a),this._emitSuggestedBitmapSizeChanged(a,this._suggestedBitmapSize)}},a.prototype._resizeBitmap=function(a){var b=this.bitmapSize;e(b,a)||(this.canvasElement.width=a.width,this.canvasElement.height=a.height,this._emitBitmapSizeChanged(b,a))},a.prototype._emitBitmapSizeChanged=function(a,b){var c=this;this._bitmapSizeChangedListeners.forEach(function(d){return d.call(c,a,b)})},a.prototype._suggestNewBitmapSize=function(a){var b=this._suggestedBitmapSize,c=d(this._transformBitmapSize(a,this._canvasElementClientSize)),f=e(this.bitmapSize,c)?null:c;(null!==b||null!==f)&&(null!==b&&null!==f&&e(b,f)||(this._suggestedBitmapSize=f,this._emitSuggestedBitmapSizeChanged(b,f)))},a.prototype._emitSuggestedBitmapSizeChanged=function(a,b){var c=this;this._suggestedBitmapSizeChangedListeners.forEach(function(d){return d.call(c,a,b)})},a.prototype._chooseAndInitObserver=function(){var a=this;if(!this._allowResizeObserver)return void this._initDevicePixelRatioObservable();new Promise(function(a){var b=new ResizeObserver(function(c){a(c.every(function(a){return"devicePixelContentBoxSize"in a})),b.disconnect()});b.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1}).then(function(b){return b?a._initResizeObserver():a._initDevicePixelRatioObservable()})},a.prototype._initDevicePixelRatioObservable=function(){var a=this;if(null!==this._canvasElement){var b=s(this._canvasElement);if(null===b)throw Error("No window is associated with the canvas");this._devicePixelRatioObservable=new q(b),this._devicePixelRatioObservable.subscribe(function(){return a._invalidateBitmapSize()}),this._invalidateBitmapSize()}},a.prototype._invalidateBitmapSize=function(){if(null!==this._canvasElement){var a,b,c=s(this._canvasElement);if(null!==c){var e,f,g=null!=(b=null==(a=this._devicePixelRatioObservable)?void 0:a.value)?b:c.devicePixelRatio,h=this._canvasElement.getClientRects(),i=void 0!==h[0]?(e=h[0],f=g,d({width:Math.round(e.left*f+e.width*f)-Math.round(e.left*f),height:Math.round(e.top*f+e.height*f)-Math.round(e.top*f)})):d({width:this._canvasElementClientSize.width*g,height:this._canvasElementClientSize.height*g});this._suggestNewBitmapSize(i)}}},a.prototype._initResizeObserver=function(){var a=this;null!==this._canvasElement&&(this._canvasElementResizeObserver=new ResizeObserver(function(b){var c=b.find(function(b){return b.target===a._canvasElement});if(c&&c.devicePixelContentBoxSize&&c.devicePixelContentBoxSize[0]){var e=c.devicePixelContentBoxSize[0],f=d({width:e.inlineSize,height:e.blockSize});a._suggestNewBitmapSize(f)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},a}();function s(a){return a.ownerDocument.defaultView}var t=function(){function a(a,b,c){if(0===b.width||0===b.height)throw TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=b,0===c.width||0===c.height)throw TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=c,this._context=a}return a.prototype.useMediaCoordinateSpace=function(a){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),a({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},a.prototype.useBitmapCoordinateSpace=function(a){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),a({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(a.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),a}();function u(a,b){var c=a.canvasElementClientSize;if(0===c.width||0===c.height)return null;var d=a.bitmapSize;if(0===d.width||0===d.height)return null;var e=a.canvasElement.getContext("2d",b);return null===e?null:new t(e,c,d)}let v={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},w={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},x={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},y={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},z={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},A={color:"#26a69a",base:0},B={color:"#2196f3"},C={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};function D(a,b){let c={0:[],1:[a.lineWidth,a.lineWidth],2:[2*a.lineWidth,2*a.lineWidth],3:[6*a.lineWidth,6*a.lineWidth],4:[a.lineWidth,4*a.lineWidth]}[b];a.setLineDash(c)}function E(a,b,c,d){a.beginPath();let e=a.lineWidth%2?.5:0;a.moveTo(c,b+e),a.lineTo(d,b+e),a.stroke()}function F(a,b){if(!a)throw Error("Assertion failed"+(b?": "+b:""))}function G(a){if(void 0===a)throw Error("Value is undefined");return a}function H(a){if(null===a)throw Error("Value is null");return a}function I(a){return H(G(a))}!function(a){a[a.Simple=0]="Simple",a[a.WithSteps=1]="WithSteps",a[a.Curved=2]="Curved"}(f||(f={})),function(a){a[a.Solid=0]="Solid",a[a.Dotted=1]="Dotted",a[a.Dashed=2]="Dashed",a[a.LargeDashed=3]="LargeDashed",a[a.SparseDotted=4]="SparseDotted"}(g||(g={}));let J={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function K(a){return a<0?0:a>255?255:Math.round(a)||0}function L(a){return a<=0||a>1?Math.min(Math.max(a,0),1):Math.round(1e4*a)/1e4}let M=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,N=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,O=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,P=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function Q(a){(a=a.toLowerCase())in J&&(a=J[a]);{let b=P.exec(a)||O.exec(a);if(b)return[K(parseInt(b[1],10)),K(parseInt(b[2],10)),K(parseInt(b[3],10)),L(b.length<5?1:parseFloat(b[4]))]}{let b=N.exec(a);if(b)return[K(parseInt(b[1],16)),K(parseInt(b[2],16)),K(parseInt(b[3],16)),1]}{let b=M.exec(a);if(b)return[K(17*parseInt(b[1],16)),K(17*parseInt(b[2],16)),K(17*parseInt(b[3],16)),1]}throw Error(`Cannot parse color: ${a}`)}function R(a){return .199*a[0]+.687*a[1]+.114*a[2]}function S(a){let b=Q(a);return{t:`rgb(${b[0]}, ${b[1]}, ${b[2]})`,i:R(b)>160?"black":"white"}}class T{constructor(){this.h=[]}l(a,b,c){this.h.push({o:a,_:b,u:!0===c})}v(a){let b=this.h.findIndex(b=>a===b.o);b>-1&&this.h.splice(b,1)}p(a){this.h=this.h.filter(b=>b._!==a)}m(a,b,c){let d=[...this.h];this.h=this.h.filter(a=>!a.u),d.forEach(d=>d.o(a,b,c))}M(){return this.h.length>0}S(){this.h=[]}}function U(a,...b){for(let c of b)for(let b in c)void 0!==c[b]&&Object.prototype.hasOwnProperty.call(c,b)&&!["__proto__","constructor","prototype"].includes(b)&&("object"!=typeof c[b]||void 0===a[b]||Array.isArray(c[b])?a[b]=c[b]:U(a[b],c[b]));return a}function V(a){return"number"==typeof a&&isFinite(a)}function W(a){return"number"==typeof a&&a%1==0}function X(a){return"string"==typeof a}function Y(a){return"boolean"==typeof a}function Z(a){let b,c,d;if(!a||"object"!=typeof a)return a;for(c in b=Array.isArray(a)?[]:{},a)a.hasOwnProperty(c)&&(d=a[c],b[c]=d&&"object"==typeof d?Z(d):d);return b}function $(a){return null!==a}function _(a){return null===a?void 0:a}let aa="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function ab(a,b,c){return void 0===b&&(b=aa),`${c=void 0!==c?`${c} `:""}${a}px ${b}`}class ac{constructor(a){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=a}W(){let a=this.k,b=this.j(),c=this.H();return a.P===b&&a.D===c||(a.P=b,a.D=c,a.R=ab(b,c),a.L=2.5/12*b,a.B=a.L,a.A=b/12*a.T,a.I=b/12*a.T,a.N=0),a.V=this.$(),a.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class ad{constructor(){this.Y=[]}Z(a){this.Y=a}X(a,b,c){this.Y.forEach(d=>{d.X(a,b,c)})}}class ae{X(a,b,c){a.useBitmapCoordinateSpace(a=>this.K(a,b,c))}}class af extends ae{constructor(){super(...arguments),this.G=null}J(a){this.G=a}K({context:a,horizontalPixelRatio:b,verticalPixelRatio:c}){if(null===this.G||null===this.G.tt)return;let d=this.G.tt,e=this.G,f=Math.max(1,Math.floor(b))%2/2,g=g=>{a.beginPath();for(let h=d.to-1;h>=d.from;--h){let d=e.it[h],i=Math.round(d.nt*b)+f,j=d.st*c,k=g*c+f;a.moveTo(i,j),a.arc(i,j,k,0,2*Math.PI)}a.fill()};e.et>0&&(a.fillStyle=e.rt,g(e.ht+e.et)),a.fillStyle=e.lt,g(e.ht)}}function ag(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}let ah={from:0,to:1};class ai{constructor(a,b){this.ut=new ad,this.ct=[],this.dt=[],this.ft=!0,this.F=a,this.vt=b,this.ut.Z(this.ct)}bt(a){let b=this.F.wt();b.length!==this.ct.length&&(this.dt=b.map(ag),this.ct=this.dt.map(a=>{let b=new af;return b.J(a),b}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){let a=2===this.vt.W().mode,b=this.F.wt(),c=this.vt.xt(),d=this.F.St();b.forEach((b,e)=>{var f;let g=this.dt[e],h=b.kt(c);if(a||null===h||!b.yt())return void(g.tt=null);let i=H(b.Ct());g.lt=h.Tt,g.ht=h.ht,g.et=h.Pt,g.it[0]._t=h._t,g.it[0].st=b.Dt().Rt(h._t,i.Vt),g.rt=null!=(f=h.Ot)?f:this.F.Bt(g.it[0].st/b.Dt().At()),g.it[0].ot=c,g.it[0].nt=d.It(c),g.tt=ah})}}class aj extends ae{constructor(a){super(),this.zt=a}K({context:a,bitmapSize:b,horizontalPixelRatio:c,verticalPixelRatio:d}){if(null===this.zt)return;let e=this.zt.Lt.yt,f=this.zt.Et.yt;if(!e&&!f)return;let g=Math.round(this.zt.nt*c),h=Math.round(this.zt.st*d);a.lineCap="butt",e&&g>=0&&(a.lineWidth=Math.floor(this.zt.Lt.et*c),a.strokeStyle=this.zt.Lt.V,a.fillStyle=this.zt.Lt.V,D(a,this.zt.Lt.Nt),function(a,b,c,d){a.beginPath();let e=a.lineWidth%2?.5:0;a.moveTo(b+e,0),a.lineTo(b+e,d),a.stroke()}(a,g,0,b.height)),f&&h>=0&&(a.lineWidth=Math.floor(this.zt.Et.et*d),a.strokeStyle=this.zt.Et.V,a.fillStyle=this.zt.Et.V,D(a,this.zt.Et.Nt),E(a,h,0,b.width))}}class ak{constructor(a){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new aj(this.Ft),this.jt=a}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){let a=this.jt.yt(),b=H(this.jt.Ht()),c=b.$t().W().crosshair,d=this.Ft;if(2===c.mode)return d.Et.yt=!1,void(d.Lt.yt=!1);d.Et.yt=a&&this.jt.Ut(b),d.Lt.yt=a&&this.jt.qt(),d.Et.et=c.horzLine.width,d.Et.Nt=c.horzLine.style,d.Et.V=c.horzLine.color,d.Lt.et=c.vertLine.width,d.Lt.Nt=c.vertLine.style,d.Lt.V=c.vertLine.color,d.nt=this.jt.Yt(),d.st=this.jt.Zt()}}function al(a,b,c,d,e,f){a.save(),a.globalCompositeOperation="copy",a.fillStyle=f,a.fillRect(b,c,d,e),a.restore()}function am(a,b,c,d,e,f){a.beginPath(),a.roundRect?a.roundRect(b,c,d,e,f):(a.lineTo(b+d-f[1],c),0!==f[1]&&a.arcTo(b+d,c,b+d,c+f[1],f[1]),a.lineTo(b+d,c+e-f[2]),0!==f[2]&&a.arcTo(b+d,c+e,b+d-f[2],c+e,f[2]),a.lineTo(b+f[3],c+e),0!==f[3]&&a.arcTo(b,c+e,b,c+e-f[3],f[3]),a.lineTo(b,c+f[0]),0!==f[0]&&a.arcTo(b,c,b+f[0],c,f[0]))}function an(a,b,c,d,e,f,g=0,h=[0,0,0,0],i=""){var j;if(a.save(),!g||!i||i===f)return am(a,b,c,d,e,h),a.fillStyle=f,a.fill(),void a.restore();let k=g/2;am(a,b+k,c+k,d-g,e-g,(j=-k,h.map(a=>0===a?a:a+j))),"transparent"!==f&&(a.fillStyle=f,a.fill()),"transparent"!==i&&(a.lineWidth=g,a.strokeStyle=i,a.closePath(),a.stroke()),a.restore()}function ao(a,b,c,d,e,f,g){a.save(),a.globalCompositeOperation="copy";let h=a.createLinearGradient(0,0,0,e);h.addColorStop(0,f),h.addColorStop(1,g),a.fillStyle=h,a.fillRect(b,c,d,e),a.restore()}class ap{constructor(a,b){this.J(a,b)}J(a,b){this.zt=a,this.Xt=b}At(a,b){return this.zt.yt?a.P+a.L+a.B:0}X(a,b,c,d){if(!this.zt.yt||0===this.zt.Kt.length)return;let e=this.zt.V,f=this.Xt.t,g=a.useBitmapCoordinateSpace(a=>{let g=a.context;g.font=b.R;let h=this.Gt(a,b,c,d),i=h.Jt;return h.Qt?an(g,i.ti,i.ii,i.ni,i.si,f,i.ei,[i.ht,0,0,i.ht],f):an(g,i.ri,i.ii,i.ni,i.si,f,i.ei,[0,i.ht,i.ht,0],f),this.zt.hi&&(g.fillStyle=e,g.fillRect(i.ri,i.li,i.ai-i.ri,i.oi)),this.zt._i&&(g.fillStyle=b.O,g.fillRect(h.Qt?i.ui-i.ei:0,i.ii,i.ei,i.ci-i.ii)),h});a.useMediaCoordinateSpace(({context:a})=>{let c=g.di;a.font=b.R,a.textAlign=g.Qt?"right":"left",a.textBaseline="middle",a.fillStyle=e,a.fillText(this.zt.Kt,c.fi,(c.ii+c.ci)/2+c.pi)})}Gt(a,b,c,d){var e;let f,g,h,{context:i,bitmapSize:j,mediaSize:k,horizontalPixelRatio:l,verticalPixelRatio:m}=a,n=this.zt.hi||!this.zt.mi?b.T:0,o=this.zt.bi?b.C:0,p=b.L+this.Xt.wi,q=b.B+this.Xt.gi,r=b.A,s=b.I,t=this.zt.Kt,u=b.P,v=c.Mi(i,t),w=Math.ceil(c.xi(i,t)),x=b.C+r+s+w+n,y=Math.max(1,Math.floor(m)),z=Math.round((u+p+q)*m);z%2!=y%2&&(z+=1);let A=o>0?Math.max(1,Math.floor(o*l)):0,B=Math.round(x*l),C=Math.round(n*l),D=Math.round((null!=(e=this.Xt.Si)?e:this.Xt.ki)*m)-Math.floor(.5*m),E=Math.floor(D+y/2-z/2),F=E+z,G="right"===d,H=G?k.width-o:o,I=G?j.width-A:A;return G?(f=I-B,g=I-C,h=H-n-r-o):(f=I+B,g=I+C,h=H+n+r),{Qt:G,Jt:{ii:E,li:D,ci:F,ni:B,si:z,ht:2*l,ei:A,ti:f,ri:I,ai:g,oi:y,ui:j.width},di:{ii:E/m,ci:F/m,fi:h,pi:v}}}}class aq{constructor(a){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(a||ap)(this.Ci,this.yi),this.Ri=new(a||ap)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(a,b=!1){return Math.max(this.Pi.At(a,b),this.Ri.At(a,b))}Vi(){return this.yi.Si||0}Oi(a){this.yi.Si=a}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(a){return this.Di(),this.Ci.hi=this.Ci.hi&&a.W().ticksVisible,this.Ti.hi=this.Ti.hi&&a.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class ar extends aq{constructor(a,b,c){super(),this.jt=a,this.Li=b,this.Ei=c}zi(a,b,c){if(a.yt=!1,2===this.jt.W().mode)return;let d=this.jt.W().horzLine;if(!d.labelVisible)return;let e=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||null===e)return;let f=S(d.labelBackgroundColor);c.t=f.t,a.V=f.i;let g=2/12*this.Li.P();c.wi=g,c.gi=g;let h=this.Ei(this.Li);c.ki=h.ki,a.Kt=this.Li.Fi(h._t,e),a.yt=!0}}let as=/[1-9]/g;class at{constructor(){this.zt=null}J(a){this.zt=a}X(a,b){if(null===this.zt||!1===this.zt.yt||0===this.zt.Kt.length)return;let c=a.useMediaCoordinateSpace(({context:a})=>(a.font=b.R,Math.round(b.Wi.xi(a,H(this.zt).Kt,as))));if(c<=0)return;let d=b.ji,e=c+2*d,f=e/2,g=this.zt.Hi,h=this.zt.ki,i=Math.floor(h-f)+.5;i<0?(h+=Math.abs(0-i),i=Math.floor(h-f)+.5):i+e>g&&(h-=Math.abs(g-(i+e)),i=Math.floor(h-f)+.5);let j=i+e,k=Math.ceil(0+b.C+b.T+b.L+b.P+b.B);a.useBitmapCoordinateSpace(({context:a,horizontalPixelRatio:c,verticalPixelRatio:d})=>{let e=H(this.zt);a.fillStyle=e.t;let f=Math.round(i*c),g=Math.round(0*d),h=Math.round(j*c),l=Math.round(k*d),m=Math.round(2*c);if(a.beginPath(),a.moveTo(f,g),a.lineTo(f,l-m),a.arcTo(f,l,f+m,l,m),a.lineTo(h-m,l),a.arcTo(h,l,h,l-m,m),a.lineTo(h,g),a.fill(),e.hi){let f=Math.round(e.ki*c),h=Math.round((g+b.T)*d);a.fillStyle=e.V;let i=Math.max(1,Math.floor(c)),j=Math.floor(.5*c);a.fillRect(f-j,g,i,h-g)}}),a.useMediaCoordinateSpace(({context:a})=>{let c=H(this.zt),e=0+b.C+b.T+b.L+b.P/2;a.font=b.R,a.textAlign="left",a.textBaseline="middle",a.fillStyle=c.V;let f=b.Wi.Mi(a,"Apr0");a.translate(i+d,e+f),a.fillText(c.Kt,0,0)})}}class au{constructor(a,b,c){this.ft=!0,this.Wt=new at,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=a,this.$i=b,this.Ei=c}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){let a=this.Ft;if(a.yt=!1,2===this.vt.W().mode)return;let b=this.vt.W().vertLine;if(!b.labelVisible)return;let c=this.$i.St();if(c.Ni())return;a.Hi=c.Hi();let d=this.Ei();if(null===d)return;a.ki=d.ki;let e=c.Ui(this.vt.xt());a.Kt=c.qi(H(e)),a.yt=!0;let f=S(b.labelBackgroundColor);a.t=f.t,a.V=f.i,a.hi=c.W().ticksVisible}}class av{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(a){this.Zi=a}Dt(){return this.Yi}Gi(a){this.Yi=a}Ji(a){return[]}Qi(){return[]}yt(){return!0}}!function(a){a[a.Normal=0]="Normal",a[a.Magnet=1]="Magnet",a[a.Hidden=2]="Hidden"}(h||(h={}));class aw extends av{constructor(a,b){let c,d,e,f;super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=a,this.cn=b,this.dn=new ai(a,this),this.fn=(c=()=>this.nn,d=()=>this.an,a=>{let b=d(),e=c();if(a===H(this.tn).vn())return{_t:e,ki:b};{let c=H(a.Ct());return{_t:a.pn(b,c),ki:b}}});let g=(e=()=>this.sn,f=()=>this.Yt(),()=>{let a=this.$i.St().mn(e()),b=f();return a&&Number.isFinite(b)?{ot:a,ki:b}:null});this.bn=new au(this,a,g),this.wn=new ak(this)}W(){return this.cn}gn(a,b){this._n=a,this.un=b}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(a,b,c){this.hn||(this.hn=!0),this.en=!0,this.yn(a,b,c)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(a){return null!==this.tn?[this.wn,this.dn]:[]}Ut(a){return a===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(a,b){this.en&&this.tn===a||this.rn.clear();let c=[];return this.tn===a&&c.push(this.Dn(this.rn,b,this.fn)),c}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(a=>a.bt()),this.bn.bt(),this.dn.bt()}On(a){return a&&!a.vn().Ni()?a.vn():null}yn(a,b,c){this.Bn(a,b,c)&&this.Vn()}Bn(a,b,c){let d=this.ln,e=this.an,f=this.nn,g=this.sn,h=this.tn,i=this.On(c);this.sn=a,this.ln=isNaN(a)?NaN:this.$i.St().It(a),this.tn=c;let j=null!==i?i.Ct():null;return null!==i&&null!==j?(this.nn=b,this.an=i.Rt(b,j)):(this.nn=NaN,this.an=NaN),d!==this.ln||e!==this.an||g!==this.sn||f!==this.nn||h!==this.tn}Tn(){let a=this.$i.wt().map(a=>a.In().An()).filter($),b=0===a.length?null:Math.max(...a);this.sn=null!==b?b:NaN}Dn(a,b,c){let d=a.get(b);return void 0===d&&(d=new ar(this,b,c),a.set(b,d)),d}}function ax(a){return"left"===a||"right"===a}class ay{constructor(a){this.zn=new Map,this.Ln=[],this.En=a}Nn(a,b){var c;let d=(c=this.zn.get(a),void 0===c?b:{Fn:Math.max(c.Fn,b.Fn),Wn:c.Wn||b.Wn});this.zn.set(a,d)}jn(){return this.En}Hn(a){let b=this.zn.get(a);return void 0===b?{Fn:this.En}:{Fn:Math.max(this.En,b.Fn),Wn:b.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(a){this.Un(),this.Ln=[{qn:1,Vt:a}]}Zn(a){this.Xn(),this.Ln.push({qn:5,Vt:a})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(a){this.Un(),this.Ln.push({qn:2,Vt:a})}Jn(a){this.Un(),this.Ln.push({qn:3,Vt:a})}Qn(){return this.Ln}ts(a){for(let b of a.Ln)this.ns(b);this.En=Math.max(this.En,a.En),a.zn.forEach((a,b)=>{this.Nn(b,a)})}static ss(){return new ay(2)}static es(){return new ay(3)}ns(a){switch(a.qn){case 0:this.$n();break;case 1:this.Yn(a.Vt);break;case 2:this.Gn(a.Vt);break;case 3:this.Jn(a.Vt);break;case 4:this.Kn();break;case 5:this.Zn(a.Vt);break;case 6:this.Xn()}}Xn(){let a=this.Ln.findIndex(a=>5===a.qn);-1!==a&&this.Ln.splice(a,1)}}function az(a,b){if(!V(a))return"n/a";if(!W(b)||b<0||b>16)throw TypeError("invalid length");return 0===b?a.toString():("0000000000000000"+a.toString()).slice(-b)}class aA{constructor(a,b){if(b||(b=1),V(a)&&W(a)||(a=100),a<0)throw TypeError("invalid base");this.Li=a,this.rs=b,this.hs()}format(a){let b=a<0?"âˆ’":"";return a=Math.abs(a),b+this.ls(a)}hs(){if(this._s=0,this.Li>0&&this.rs>0){let a=this.Li;for(;a>1;)a/=10,this._s++}}ls(a){let b=this.Li/this.rs,c=Math.floor(a),d="",e=void 0!==this._s?this._s:NaN;if(b>1){let f=+(Math.round(a*b)-c*b).toFixed(this._s);f>=b&&(f-=b,c+=1),d="."+az(f.toFixed(this._s)*this.rs,e)}else c=Math.round(c*b)/b,e>0&&(d="."+az(0,e));return c.toFixed(0)+d}}class aB extends aA{constructor(a=100){super(a)}format(a){return`${super.format(a)}%`}}class aC{constructor(a){this.us=a}format(a){let b="";return a<0&&(b="-",a=-a),a<995?b+this.cs(a):a<999995?b+this.cs(a/1e3)+"K":a<0x3b9ac9fb?(a=1e3*Math.round(a/1e3),b+this.cs(a/1e6)+"M"):(a=1e6*Math.round(a/1e6),b+this.cs(a/1e9)+"B")}cs(a){let b=Math.pow(10,this.us);return((a=Math.round(a*b)/b)>=1e-15&&a<1?a.toFixed(this.us).replace(/\.?0+$/,""):String(a)).replace(/(\.[1-9]*)0+$/,(a,b)=>b)}}function aD(a,b,c,d,e,f,g){if(0===b.length||d.from>=b.length||d.to<=0)return;let{context:h,horizontalPixelRatio:i,verticalPixelRatio:j}=a,k=b[d.from],l=f(a,k),m=k;if(d.to-d.from<2){let b=e/2;h.beginPath();let c={nt:k.nt-b,st:k.st},d={nt:k.nt+b,st:k.st};h.moveTo(c.nt*i,c.st*j),h.lineTo(d.nt*i,d.st*j),g(a,l,c,d)}else{let e=(b,c)=>{g(a,l,m,c),h.beginPath(),l=b,m=c},n=m;h.beginPath(),h.moveTo(k.nt*i,k.st*j);for(let g=d.from+1;g<d.to;++g){let d=f(a,n=b[g]);switch(c){case 0:h.lineTo(n.nt*i,n.st*j);break;case 1:h.lineTo(n.nt*i,b[g-1].st*j),d!==l&&(e(d,n),h.lineTo(n.nt*i,b[g-1].st*j)),h.lineTo(n.nt*i,n.st*j);break;case 2:{let[a,c]=function(a,b,c){var d,e;let f=Math.max(0,b-1),g=Math.min(a.length-1,c+1);return[(d=a[b],e=aF(aE(a[c],a[f]),6),{nt:d.nt+e.nt,st:d.st+e.st}),aE(a[c],aF(aE(a[g],a[b]),6))]}(b,g-1,g);h.bezierCurveTo(a.nt*i,a.st*j,c.nt*i,c.st*j,n.nt*i,n.st*j)}}1!==c&&d!==l&&(e(d,n),h.moveTo(n.nt*i,n.st*j))}(m!==n||m===n&&1===c)&&g(a,l,m,n)}}function aE(a,b){return{nt:a.nt-b.nt,st:a.st-b.st}}function aF(a,b){return{nt:a.nt/b,st:a.st/b}}function aG(a,b,c,d,e){let{context:f,horizontalPixelRatio:g,verticalPixelRatio:h}=b;f.lineTo(e.nt*g,a*h),f.lineTo(d.nt*g,a*h),f.closePath(),f.fillStyle=c,f.fill()}class aH extends ae{constructor(){super(...arguments),this.G=null}J(a){this.G=a}K(a){var b;if(null===this.G)return;let{it:c,tt:d,ds:e,et:f,Nt:g,fs:h}=this.G,i=null!=(b=this.G.vs)?b:this.G.ps?0:a.mediaSize.height;if(null===d)return;let j=a.context;j.lineCap="butt",j.lineJoin="round",j.lineWidth=f,D(j,g),j.lineWidth=1,aD(a,c,h,d,e,this.bs.bind(this),aG.bind(null,i))}}function aI(a,b,c){return Math.min(Math.max(a,b),c)}function aJ(a){let b=Math.ceil(a);return b%2==0?b-1:b}class aK{ws(a,b){let c=this.gs,{Ms:d,xs:e,Ss:f,ks:g,ys:h,vs:i}=b;if(void 0===this.Cs||void 0===c||c.Ms!==d||c.xs!==e||c.Ss!==f||c.ks!==g||c.vs!==i||c.ys!==h){let c=a.context.createLinearGradient(0,0,0,h);if(c.addColorStop(0,d),null!=i){let b=aI(i*a.verticalPixelRatio/h,0,1);c.addColorStop(b,e),c.addColorStop(b,f)}c.addColorStop(1,g),this.Cs=c,this.gs=b}return this.Cs}}class aL extends aH{constructor(){super(...arguments),this.Ts=new aK}bs(a,b){return this.Ts.ws(a,{Ms:b.Ps,xs:"",Ss:"",ks:b.Rs,ys:a.bitmapSize.height})}}function aM(a,b){let c=a.context;c.strokeStyle=b,c.stroke()}class aN extends ae{constructor(){super(...arguments),this.G=null}J(a){this.G=a}K(a){if(null===this.G)return;let{it:b,tt:c,ds:d,fs:e,et:f,Nt:g,Ds:h}=this.G;if(null===c)return;let i=a.context;i.lineCap="butt",i.lineWidth=f*a.verticalPixelRatio,D(i,g),i.lineJoin="round";let j=this.Vs.bind(this);void 0!==e&&aD(a,b,e,c,d,j,aM),h&&function(a,b,c,d,e){let{horizontalPixelRatio:f,verticalPixelRatio:g,context:h}=a,i=null,j=Math.max(1,Math.floor(f))%2/2,k=c*g+j;for(let c=d.to-1;c>=d.from;--c){let d=b[c];if(d){let b=e(a,d);b!==i&&(h.beginPath(),null!==i&&h.fill(),h.fillStyle=b,i=b);let c=Math.round(d.nt*f)+j,l=d.st*g;h.moveTo(c,l),h.arc(c,l,k,0,2*Math.PI)}}h.fill()}(a,b,h,c,j)}}class aO extends aN{Vs(a,b){return b.lt}}function aP(a,b,c,d,e=0,f=b.length){let g=f-e;for(;0<g;){let f=g>>1,h=e+f;d(b[h],c)===a?(e=h+1,g-=f+1):g=f}return e}let aQ=aP.bind(null,!0),aR=aP.bind(null,!1);function aS(a,b){return a.ot<b}function aT(a,b){return b<a.ot}function aU(a,b,c){let d=b.Os(),e=b.ui(),f=aQ(a,d,aS),g=aR(a,e,aT);if(!c)return{from:f,to:g};let h=f,i=g;return f>0&&f<a.length&&a[f].ot>=d&&(h=f-1),g>0&&g<a.length&&a[g-1].ot<=e&&(i=g+1),{from:h,to:i}}class aV{constructor(a,b,c){this.Bs=!0,this.As=!0,this.Is=!0,this.zs=[],this.Ls=null,this.Es=a,this.Ns=b,this.Fs=c}bt(a){this.Bs=!0,"data"===a&&(this.As=!0),"options"===a&&(this.Is=!0)}gt(){return this.Es.yt()?(this.Ws(),null===this.Ls?null:this.js):null}Hs(){this.zs=this.zs.map(a=>Object.assign(Object.assign({},a),this.Es.Us().$s(a.ot)))}qs(){this.Ls=null}Ws(){this.As&&(this.Ys(),this.As=!1),this.Is&&(this.Hs(),this.Is=!1),this.Bs&&(this.Zs(),this.Bs=!1)}Zs(){let a=this.Es.Dt(),b=this.Ns.St();if(this.qs(),b.Ni()||a.Ni())return;let c=b.Xs();if(null===c||0===this.Es.In().Ks())return;let d=this.Es.Ct();null!==d&&(this.Ls=aU(this.zs,c,this.Fs),this.Gs(a,b,d.Vt),this.Js())}}class aW extends aV{constructor(a,b){super(a,b,!0)}Gs(a,b,c){b.Qs(this.zs,_(this.Ls)),a.te(this.zs,c,_(this.Ls))}ie(a,b){return{ot:a,_t:b,nt:NaN,st:NaN}}Ys(){let a=this.Es.Us();this.zs=this.Es.In().ne().map(b=>{let c=b.Vt[3];return this.se(b.ee,c,a)})}}class aX extends aW{constructor(a,b){super(a,b),this.js=new ad,this.re=new aL,this.he=new aO,this.js.Z([this.re,this.he])}se(a,b,c){return Object.assign(Object.assign({},this.ie(a,b)),c.$s(a))}Js(){let a=this.Es.W();this.re.J({fs:a.lineType,it:this.zs,Nt:a.lineStyle,et:a.lineWidth,vs:null,ps:a.invertFilledArea,tt:this.Ls,ds:this.Ns.St().le()}),this.he.J({fs:a.lineVisible?a.lineType:void 0,it:this.zs,Nt:a.lineStyle,et:a.lineWidth,tt:this.Ls,ds:this.Ns.St().le(),Ds:a.pointMarkersVisible?a.pointMarkersRadius||a.lineWidth/2+2:void 0})}}class aY extends ae{constructor(){super(...arguments),this.zt=null,this.ae=0,this.oe=0}J(a){this.zt=a}K({context:a,horizontalPixelRatio:b,verticalPixelRatio:c}){if(null===this.zt||0===this.zt.In.length||null===this.zt.tt)return;this.ae=this._e(b),this.ae>=2&&Math.max(1,Math.floor(b))%2!=this.ae%2&&this.ae--,this.oe=this.zt.ue?Math.min(this.ae,Math.floor(b)):this.ae;let d=null,e=this.oe<=this.ae&&this.zt.le>=Math.floor(1.5*b);for(let f=this.zt.tt.from;f<this.zt.tt.to;++f){let g=this.zt.In[f];d!==g.ce&&(a.fillStyle=g.ce,d=g.ce);let h=Math.floor(.5*this.oe),i=Math.round(g.nt*b),j=i-h,k=this.oe,l=j+k-1,m=Math.min(g.de,g.fe),n=Math.max(g.de,g.fe),o=Math.round(m*c)-h,p=Math.max(Math.round(n*c)+h-o,this.oe);a.fillRect(j,o,k,p);let q=Math.ceil(1.5*this.ae);if(e){if(this.zt.ve){let b=i-q,d=Math.max(o,Math.round(g.pe*c)-h),e=d+k-1;e>o+p-1&&(d=(e=o+p-1)-k+1),a.fillRect(b,d,j-b,e-d+1)}let b=i+q,d=Math.max(o,Math.round(g.me*c)-h),e=d+k-1;e>o+p-1&&(d=(e=o+p-1)-k+1),a.fillRect(l+1,d,b-l,e-d+1)}}}_e(a){return Math.max(Math.floor(a),Math.floor(Math.floor(.3*H(this.zt).le*a)))}}class aZ extends aV{constructor(a,b){super(a,b,!1)}Gs(a,b,c){b.Qs(this.zs,_(this.Ls)),a.be(this.zs,c,_(this.Ls))}we(a,b,c){return{ot:a,ge:b.Vt[0],Me:b.Vt[1],xe:b.Vt[2],Se:b.Vt[3],nt:NaN,pe:NaN,de:NaN,fe:NaN,me:NaN}}Ys(){let a=this.Es.Us();this.zs=this.Es.In().ne().map(b=>this.se(b.ee,b,a))}}class a$ extends aZ{constructor(){super(...arguments),this.js=new aY}se(a,b,c){return Object.assign(Object.assign({},this.we(a,b,c)),c.$s(a))}Js(){let a=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),ve:a.openVisible,ue:a.thinBars,tt:this.Ls})}}class a_ extends aH{constructor(){super(...arguments),this.Ts=new aK}bs(a,b){let c=this.G;return this.Ts.ws(a,{Ms:b.ke,xs:b.ye,Ss:b.Ce,ks:b.Te,ys:a.bitmapSize.height,vs:c.vs})}}class a0 extends aN{constructor(){super(...arguments),this.Pe=new aK}Vs(a,b){let c=this.G;return this.Pe.ws(a,{Ms:b.Re,xs:b.Re,Ss:b.De,ks:b.De,ys:a.bitmapSize.height,vs:c.vs})}}class a1 extends aW{constructor(a,b){super(a,b),this.js=new ad,this.Ve=new a_,this.Oe=new a0,this.js.Z([this.Ve,this.Oe])}se(a,b,c){return Object.assign(Object.assign({},this.ie(a,b)),c.$s(a))}Js(){let a=this.Es.Ct();if(null===a)return;let b=this.Es.W(),c=this.Es.Dt().Rt(b.baseValue.price,a.Vt),d=this.Ns.St().le();this.Ve.J({it:this.zs,et:b.lineWidth,Nt:b.lineStyle,fs:b.lineType,vs:c,ps:!1,tt:this.Ls,ds:d}),this.Oe.J({it:this.zs,et:b.lineWidth,Nt:b.lineStyle,fs:b.lineVisible?b.lineType:void 0,Ds:b.pointMarkersVisible?b.pointMarkersRadius||b.lineWidth/2+2:void 0,vs:c,tt:this.Ls,ds:d})}}class a2 extends ae{constructor(){super(...arguments),this.zt=null,this.ae=0}J(a){this.zt=a}K(a){if(null===this.zt||0===this.zt.In.length||null===this.zt.tt)return;let{horizontalPixelRatio:b}=a;this.ae=function(a,b){if(a>=2.5&&a<=4)return Math.floor(3*b);let c=1-.2*Math.atan(Math.max(4,a)-4)/(.5*Math.PI),d=Math.min(Math.floor(a*c*b),Math.floor(a*b));return Math.max(Math.floor(b),d)}(this.zt.le,b),this.ae>=2&&Math.floor(b)%2!=this.ae%2&&this.ae--;let c=this.zt.In;this.zt.Be&&this.Ae(a,c,this.zt.tt),this.zt._i&&this.Ie(a,c,this.zt.tt);let d=this.ze(b);(!this.zt._i||this.ae>2*d)&&this.Le(a,c,this.zt.tt)}Ae(a,b,c){if(null===this.zt)return;let{context:d,horizontalPixelRatio:e,verticalPixelRatio:f}=a,g="",h=Math.min(Math.floor(e),Math.floor(this.zt.le*e)),i=Math.floor(.5*(h=Math.max(Math.floor(e),Math.min(h,this.ae)))),j=null;for(let a=c.from;a<c.to;a++){let c=b[a];c.Ee!==g&&(d.fillStyle=c.Ee,g=c.Ee);let k=Math.round(Math.min(c.pe,c.me)*f),l=Math.round(Math.max(c.pe,c.me)*f),m=Math.round(c.de*f),n=Math.round(c.fe*f),o=Math.round(e*c.nt)-i,p=o+h-1;null!==j&&(o=Math.min(o=Math.max(j+1,o),p));let q=p-o+1;d.fillRect(o,m,q,k-m),d.fillRect(o,l+1,q,n-l),j=p}}ze(a){let b=Math.floor(+a);this.ae<=2*b&&(b=Math.floor(.5*(this.ae-1)));let c=Math.max(Math.floor(a),b);return this.ae<=2*c?Math.max(Math.floor(a),Math.floor(+a)):c}Ie(a,b,c){if(null===this.zt)return;let{context:d,horizontalPixelRatio:e,verticalPixelRatio:f}=a,g="",h=this.ze(e),i=null;for(let a=c.from;a<c.to;a++){let c=b[a];c.Ne!==g&&(d.fillStyle=c.Ne,g=c.Ne);let m=Math.round(c.nt*e)-Math.floor(.5*this.ae),n=m+this.ae-1,o=Math.round(Math.min(c.pe,c.me)*f),p=Math.round(Math.max(c.pe,c.me)*f);if(null!==i&&(m=Math.min(m=Math.max(i+1,m),n)),this.zt.le*e>2*h){var j,k,l;j=m,k=n-m+1,l=p-o+1,d.fillRect(j+h,o,k-2*h,h),d.fillRect(j+h,o+l-h,k-2*h,h),d.fillRect(j,o,h,l),d.fillRect(j+k-h,o,h,l)}else{let a=n-m+1;d.fillRect(m,o,a,p-o+1)}i=n}}Le(a,b,c){if(null===this.zt)return;let{context:d,horizontalPixelRatio:e,verticalPixelRatio:f}=a,g="",h=this.ze(e);for(let a=c.from;a<c.to;a++){let c=b[a],i=Math.round(Math.min(c.pe,c.me)*f),j=Math.round(Math.max(c.pe,c.me)*f),k=Math.round(c.nt*e)-Math.floor(.5*this.ae),l=k+this.ae-1;if(c.ce!==g){let a=c.ce;d.fillStyle=a,g=a}this.zt._i&&(k+=h,i+=h,l-=h,j-=h),i>j||d.fillRect(k,i,l-k+1,j-i+1)}}}class a3 extends aZ{constructor(){super(...arguments),this.js=new a2}se(a,b,c){return Object.assign(Object.assign({},this.we(a,b,c)),c.$s(a))}Js(){let a=this.Es.W();this.js.J({In:this.zs,le:this.Ns.St().le(),Be:a.wickVisible,_i:a.borderVisible,tt:this.Ls})}}class a4{constructor(a,b){this.Fe=a,this.Li=b}X(a,b,c){this.Fe.draw(a,this.Li,b,c)}}class a5 extends aV{constructor(a,b,c){super(a,b,!1),this.wn=c,this.js=new a4(this.wn.renderer(),b=>{let c=a.Ct();return null===c?null:a.Dt().Rt(b,c.Vt)})}We(a){return this.wn.priceValueBuilder(a)}je(a){return this.wn.isWhitespace(a)}Ys(){let a=this.Es.Us();this.zs=this.Es.In().ne().map(b=>Object.assign(Object.assign({ot:b.ee,nt:NaN},a.$s(b.ee)),{He:b.$e}))}Gs(a,b){b.Qs(this.zs,_(this.Ls))}Js(){this.wn.update({bars:this.zs.map(a6),barSpacing:this.Ns.St().le(),visibleRange:this.Ls},this.Es.W())}}function a6(a){return{x:a.nt,time:a.ot,originalData:a.He,barColor:a.ce}}class a7 extends ae{constructor(){super(...arguments),this.zt=null,this.Ue=[]}J(a){this.zt=a,this.Ue=[]}K({context:a,horizontalPixelRatio:b,verticalPixelRatio:c}){if(null===this.zt||0===this.zt.it.length||null===this.zt.tt)return;this.Ue.length||this.qe(b);let d=Math.max(1,Math.floor(c)),e=Math.round(this.zt.Ye*c)-Math.floor(d/2),f=e+d;for(let b=this.zt.tt.from;b<this.zt.tt.to;b++){let g,h,i=this.zt.it[b],j=this.Ue[b-this.zt.tt.from],k=Math.round(i.st*c);a.fillStyle=i.ce,k<=e?(g=k,h=f):(g=e,h=k-Math.floor(d/2)+d),a.fillRect(j.Os,g,j.ui-j.Os+1,h-g)}}qe(a){if(null===this.zt||0===this.zt.it.length||null===this.zt.tt)return void(this.Ue=[]);let b=1>=Math.ceil(this.zt.le*a)?0:Math.max(1,Math.floor(a)),c=Math.round(this.zt.le*a)-b;this.Ue=Array(this.zt.tt.to-this.zt.tt.from);for(let b=this.zt.tt.from;b<this.zt.tt.to;b++){let d,e,f=this.zt.it[b],g=Math.round(f.nt*a);if(c%2){let a=(c-1)/2;d=g-a,e=g+a}else{let a=c/2;d=g-a,e=g+a-1}this.Ue[b-this.zt.tt.from]={Os:d,ui:e,Ze:g,Xe:f.nt*a,ot:f.ot}}for(let a=this.zt.tt.from+1;a<this.zt.tt.to;a++){let c=this.Ue[a-this.zt.tt.from],d=this.Ue[a-this.zt.tt.from-1];c.ot===d.ot+1&&c.Os-d.ui!==b+1&&(d.Ze>d.Xe?d.ui=c.Os-b-1:c.Os=d.ui+b+1)}let d=Math.ceil(this.zt.le*a);for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){let b=this.Ue[a-this.zt.tt.from];b.ui<b.Os&&(b.ui=b.Os),d=Math.min(b.ui-b.Os+1,d)}if(b>0&&d<4)for(let a=this.zt.tt.from;a<this.zt.tt.to;a++){let b=this.Ue[a-this.zt.tt.from];b.ui-b.Os+1>d&&(b.Ze>b.Xe?b.ui-=1:b.Os+=1)}}}class a8 extends aW{constructor(){super(...arguments),this.js=new a7}se(a,b,c){return Object.assign(Object.assign({},this.ie(a,b)),c.$s(a))}Js(){let a={it:this.zs,le:this.Ns.St().le(),tt:this.Ls,Ye:this.Es.Dt().Rt(this.Es.W().base,H(this.Es.Ct()).Vt)};this.js.J(a)}}class a9 extends aW{constructor(){super(...arguments),this.js=new aO}se(a,b,c){return Object.assign(Object.assign({},this.ie(a,b)),c.$s(a))}Js(){let a=this.Es.W(),b={it:this.zs,Nt:a.lineStyle,fs:a.lineVisible?a.lineType:void 0,et:a.lineWidth,Ds:a.pointMarkersVisible?a.pointMarkersRadius||a.lineWidth/2+2:void 0,tt:this.Ls,ds:this.Ns.St().le()};this.js.J(b)}}let ba=/[2-9]/g;class bb{constructor(a=50){this.Ke=0,this.Ge=1,this.Je=1,this.Qe={},this.tr=new Map,this.ir=a}nr(){this.Ke=0,this.tr.clear(),this.Ge=1,this.Je=1,this.Qe={}}xi(a,b,c){return this.sr(a,b,c).width}Mi(a,b,c){let d=this.sr(a,b,c);return((d.actualBoundingBoxAscent||0)-(d.actualBoundingBoxDescent||0))/2}sr(a,b,c){let d=String(b).replace(c||ba,"0");if(this.tr.has(d))return G(this.tr.get(d)).er;if(this.Ke===this.ir){let a=this.Qe[this.Je];delete this.Qe[this.Je],this.tr.delete(a),this.Je++,this.Ke--}a.save(),a.textBaseline="middle";let e=a.measureText(d);return a.restore(),0===e.width&&b.length||(this.tr.set(d,{er:e,rr:this.Ge}),this.Qe[this.Ge]=d,this.Ke++,this.Ge++),e}}class bc{constructor(a){this.hr=null,this.k=null,this.lr="right",this.ar=a}_r(a,b,c){this.hr=a,this.k=b,this.lr=c}X(a){null!==this.k&&null!==this.hr&&this.hr.X(a,this.k,this.ar,this.lr)}}class bd{constructor(a,b,c){this.ur=a,this.ar=new bb(50),this.cr=b,this.F=c,this.j=-1,this.Wt=new bc(this.ar)}gt(){let a=this.F.dr(this.cr);if(null===a)return null;let b=a.vr(this.cr)?a.pr():this.cr.Dt();if(null===b)return null;let c=a.mr(b);if("overlay"===c)return null;let d=this.F.br();return d.P!==this.j&&(this.j=d.P,this.ar.nr()),this.Wt._r(this.ur.Ii(),d,c),this.Wt}}class be extends ae{constructor(){super(...arguments),this.zt=null}J(a){this.zt=a}wr(a,b){var c;if(!(null==(c=this.zt)?void 0:c.yt))return null;let{st:d,et:e,gr:f}=this.zt;return b>=d-e-7&&b<=d+e+7?{Mr:this.zt,gr:f}:null}K({context:a,bitmapSize:b,horizontalPixelRatio:c,verticalPixelRatio:d}){if(null===this.zt||!1===this.zt.yt)return;let e=Math.round(this.zt.st*d);e<0||e>b.height||(a.lineCap="butt",a.strokeStyle=this.zt.V,a.lineWidth=Math.floor(this.zt.et*c),D(a,this.zt.Nt),E(a,e,0,b.width))}}class bf{constructor(a){this.Sr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.kr=new be,this.ft=!0,this.Es=a,this.Ns=a.$t(),this.kr.J(this.Sr)}bt(){this.ft=!0}gt(){return this.Es.yt()?(this.ft&&(this.yr(),this.ft=!1),this.kr):null}}class bg extends bf{constructor(a){super(a)}yr(){this.Sr.yt=!1;let a=this.Es.Dt(),b=a.Cr().Cr;if(2!==b&&3!==b)return;let c=this.Es.W();if(!c.baseLineVisible||!this.Es.yt())return;let d=this.Es.Ct();null!==d&&(this.Sr.yt=!0,this.Sr.st=a.Rt(d.Vt,d.Vt),this.Sr.V=c.baseLineColor,this.Sr.et=c.baseLineWidth,this.Sr.Nt=c.baseLineStyle)}}class bh extends ae{constructor(){super(...arguments),this.zt=null}J(a){this.zt=a}$e(){return this.zt}K({context:a,horizontalPixelRatio:b,verticalPixelRatio:c}){let d=this.zt;if(null===d)return;let e=Math.max(1,Math.floor(b)),f=e%2/2,g=Math.round(d.Xe.x*b)+f,h=d.Xe.y*c;a.fillStyle=d.Tr,a.beginPath();let i=Math.max(2,1.5*d.Pr)*b;a.arc(g,h,i,0,2*Math.PI,!1),a.fill(),a.fillStyle=d.Rr,a.beginPath(),a.arc(g,h,d.ht*b,0,2*Math.PI,!1),a.fill(),a.lineWidth=e,a.strokeStyle=d.Dr,a.beginPath(),a.arc(g,h,d.ht*b+e/2,0,2*Math.PI,!1),a.stroke()}}let bi=[{Vr:0,Or:.25,Br:4,Ar:10,Ir:.25,zr:0,Lr:.4,Er:.8},{Vr:.25,Or:.525,Br:10,Ar:14,Ir:0,zr:0,Lr:.8,Er:0},{Vr:.525,Or:1,Br:14,Ar:14,Ir:0,zr:0,Lr:0,Er:0}];function bj(a,b,c,d){if("transparent"===a)return a;let e=Q(a),f=e[3];return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${(c+(d-c)*b)*f})`}function bk(a,b){var c;let d,e=a%2600/2600;for(let a of bi)if(e>=a.Vr&&e<=a.Or){d=a;break}F(void 0!==d,"Last price animation internal logic error");let f=(e-d.Vr)/(d.Or-d.Vr);return{Rr:bj(b,f,d.Ir,d.zr),Dr:bj(b,f,d.Lr,d.Er),ht:(c=d.Br)+(d.Ar-c)*f}}class bl{constructor(a){this.Wt=new bh,this.ft=!0,this.Nr=!0,this.Fr=performance.now(),this.Wr=this.Fr-1,this.jr=a}Hr(){this.Wr=this.Fr-1,this.bt()}$r(){if(this.bt(),2===this.jr.W().lastPriceAnimation){let a=performance.now(),b=this.Wr-a;if(b>0)return void(b<650&&(this.Wr+=2600));this.Fr=a,this.Wr=a+2600}}bt(){this.ft=!0}Ur(){this.Nr=!0}yt(){return 0!==this.jr.W().lastPriceAnimation}qr(){switch(this.jr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Wr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Nr=!1):this.Nr&&(this.Yr(),this.Nr=!1),this.Wt}Mt(){this.Wt.J(null);let a=this.jr.$t().St(),b=a.Xs(),c=this.jr.Ct();if(null===b||null===c)return;let d=this.jr.Zr(!0);if(d.Xr||!b.Kr(d.ee))return;let e={x:a.It(d.ee),y:this.jr.Dt().Rt(d._t,c.Vt)},f=d.V,g=this.jr.W().lineWidth,h=bk(this.Gr(),f);this.Wt.J({Tr:f,Pr:g,Rr:h.Rr,Dr:h.Dr,ht:h.ht,Xe:e})}Yr(){let a=this.Wt.$e();if(null!==a){let b=bk(this.Gr(),a.Tr);a.Rr=b.Rr,a.Dr=b.Dr,a.ht=b.ht}}Gr(){return this.qr()?performance.now()-this.Fr:2599}}function bm(a,b){return aJ(Math.min(Math.max(a,12),30)*b)}function bn(a,b){switch(a){case"arrowDown":case"arrowUp":return bm(b,1);case"circle":return bm(b,.8);case"square":return bm(b,.7)}}function bo(a){let b=Math.ceil(bm(a,1));return b%2!=0?b-1:b}function bp(a){return Math.max(bm(a,.1),3)}function bq(a,b,c){return b?a:c?Math.ceil(a/2):0}function br(a,b,c,d,e){let f=bn("square",c),g=(f-1)/2,h=a-g,i=b-g;return d>=h&&d<=h+f&&e>=i&&e<=i+f}function bs(a,b,c,d){let e=(bn("arrowUp",d)-1)/2*c.Jr,f=(aJ(d/2)-1)/2*c.Jr;b.beginPath(),a?(b.moveTo(c.nt-e,c.st),b.lineTo(c.nt,c.st-e),b.lineTo(c.nt+e,c.st),b.lineTo(c.nt+f,c.st),b.lineTo(c.nt+f,c.st+e),b.lineTo(c.nt-f,c.st+e)):(b.moveTo(c.nt-e,c.st),b.lineTo(c.nt,c.st+e),b.lineTo(c.nt+e,c.st),b.lineTo(c.nt+f,c.st),b.lineTo(c.nt+f,c.st-e),b.lineTo(c.nt-f,c.st-e)),b.lineTo(c.nt-f,c.st),b.fill()}class bt extends ae{constructor(){super(...arguments),this.zt=null,this.ar=new bb,this.j=-1,this.H="",this.Qr=""}J(a){this.zt=a}_r(a,b){this.j===a&&this.H===b||(this.j=a,this.H=b,this.Qr=ab(a,b),this.ar.nr())}wr(a,b){if(null===this.zt||null===this.zt.tt)return null;for(let f=this.zt.tt.from;f<this.zt.tt.to;f++){var c,d,e;let g=this.zt.it[f];if(c=g,d=a,e=b,!(void 0===c.Kt||!function(a,b,c,d,e,f){let g=d/2;return e>=a&&e<=a+c&&f>=b-g&&f<=b+g}(c.Kt.nt,c.Kt.st,c.Kt.Hi,c.Kt.At,d,e))||function(a,b,c){if(0===a.Ks)return!1;switch(a.nh){case"arrowDown":case"arrowUp":var d,e;return d=a.nt,e=a.st,br(d,e,a.Ks,b,c);case"circle":return function(a,b,c,d,e){let f=2+bn("circle",c)/2,g=a-d,h=b-e;return Math.sqrt(g*g+h*h)<=f}(a.nt,a.st,a.Ks,b,c);case"square":return br(a.nt,a.st,a.Ks,b,c)}}(c,d,e))return{Mr:g.th,gr:g.gr}}return null}K({context:a,horizontalPixelRatio:b,verticalPixelRatio:c},d,e){if(null!==this.zt&&null!==this.zt.tt){a.textBaseline="middle",a.font=this.Qr;for(let d=this.zt.tt.from;d<this.zt.tt.to;d++){let e=this.zt.it[d];void 0!==e.Kt&&(e.Kt.Hi=this.ar.xi(a,e.Kt.ih),e.Kt.At=this.j,e.Kt.nt=e.nt-e.Kt.Hi/2),function(a,b,c,d){var e,f,g;b.fillStyle=a.V,void 0!==a.Kt&&(e=a.Kt.ih,f=a.Kt.nt,g=a.Kt.st,b.save(),b.scale(c,d),b.fillText(e,f,g),b.restore()),function(a,b,c){if(0!==a.Ks){switch(a.nh){case"arrowDown":return bs(!1,b,c,a.Ks);case"arrowUp":return bs(!0,b,c,a.Ks);case"circle":let d=(bn("circle",a.Ks)-1)/2;b.beginPath(),b.arc(c.nt,c.st,d*c.Jr,0,2*Math.PI,!1),b.fill();return;case"square":return function(a,b,c){let d=bn("square",c),e=(d-1)*b.Jr/2,f=b.nt-e,g=b.st-e;a.fillRect(f,g,d*b.Jr,d*b.Jr)}(b,c,a.Ks)}a.nh}}(a,b,function(a,b,c){let d=Math.max(1,Math.floor(b))%2/2;return{nt:Math.round(a.nt*b)+d,st:a.st*c,Jr:b}}(a,c,d))}(e,a,b,c)}}}}class bu{constructor(a,b){this.ft=!0,this.rh=!0,this.hh=!0,this.ah=null,this.oh=null,this.Wt=new bt,this.jr=a,this.$i=b,this.zt={it:[],tt:null}}bt(a){this.ft=!0,this.hh=!0,"data"===a&&(this.rh=!0,this.oh=null)}gt(a){if(!this.jr.yt())return null;this.ft&&this._h();let b=this.$i.W().layout;return this.Wt._r(b.fontSize,b.fontFamily),this.Wt.J(this.zt),this.Wt}uh(){if(this.hh){if(this.jr.dh().length>0){let a=this.$i.St().le(),b=bp(a),c=1.5*bo(a)+2*b,d=this.fh();this.ah={above:bq(c,d.aboveBar,d.inBar),below:bq(c,d.belowBar,d.inBar)}}else this.ah=null;this.hh=!1}return this.ah}fh(){return null===this.oh&&(this.oh=this.jr.dh().reduce((a,b)=>(a[b.position]||(a[b.position]=!0),a),{inBar:!1,aboveBar:!1,belowBar:!1})),this.oh}_h(){let a=this.jr.Dt(),b=this.$i.St(),c=this.jr.dh();this.rh&&(this.zt.it=c.map(a=>({ot:a.time,nt:0,st:0,Ks:0,nh:a.shape,V:a.color,th:a.th,gr:a.id,Kt:void 0})),this.rh=!1);let d=this.$i.W().layout;this.zt.tt=null;let e=b.Xs();if(null===e)return;let f=this.jr.Ct();if(null===f||0===this.zt.it.length)return;let g=NaN,h=bp(b.le()),i={sh:h,eh:h};this.zt.tt=aU(this.zt.it,e,!0);for(let e=this.zt.tt.from;e<this.zt.tt.to;e++){let j=c[e];j.time!==g&&(i.sh=h,i.eh=h,g=j.time);let k=this.zt.it[e];k.nt=b.It(j.time),void 0!==j.text&&j.text.length>0&&(k.Kt={ih:j.text,nt:0,st:0,Hi:0,At:0});let l=this.jr.ph(j.time);null!==l&&function(a,b,c,d,e,f,g,h,i){let j=V(c)?c:c.Se,k=V(c)?c:c.Me,l=V(c)?c:c.xe,m=V(b.size)?Math.max(b.size,0):1,n=bo(h.le())*m,o=n/2;switch(a.Ks=n,b.position){case"inBar":return a.st=g.Rt(j,i),void 0!==a.Kt&&(a.Kt.st=a.st+o+f+.6*e);case"aboveBar":return a.st=g.Rt(k,i)-o-d.sh,void 0!==a.Kt&&(a.Kt.st=a.st-o-.6*e,d.sh+=1.2*e),d.sh+=n+f;case"belowBar":return a.st=g.Rt(l,i)+o+d.eh,void 0!==a.Kt&&(a.Kt.st=a.st+o+f+.6*e,d.eh+=1.2*e),d.eh+=n+f}b.position}(k,j,l,i,d.fontSize,h,a,b,f.Vt)}this.ft=!1}}class bv extends bf{constructor(a){super(a)}yr(){let a=this.Sr;a.yt=!1;let b=this.Es.W();if(!b.priceLineVisible||!this.Es.yt())return;let c=this.Es.Zr(0===b.priceLineSource);c.Xr||(a.yt=!0,a.st=c.ki,a.V=this.Es.mh(c.V),a.et=b.priceLineWidth,a.Nt=b.priceLineStyle)}}class bw extends aq{constructor(a){super(),this.jt=a}zi(a,b,c){a.yt=!1,b.yt=!1;let d=this.jt;if(!d.yt())return;let e=d.W(),f=e.lastValueVisible,g=""!==d.bh(),h=0===e.seriesLastValueMode,i=d.Zr(!1);if(i.Xr)return;f&&(a.Kt=this.wh(i,f,h),a.yt=0!==a.Kt.length),(g||h)&&(b.Kt=this.gh(i,f,g,h),b.yt=b.Kt.length>0);let j=d.mh(i.V),k=S(j);c.t=k.t,c.ki=i.ki,b.Ot=d.$t().Bt(i.ki/d.Dt().At()),a.Ot=j,a.V=k.i,b.V=k.i}gh(a,b,c,d){let e="",f=this.jt.bh();return c&&0!==f.length&&(e+=`${f} `),b&&d&&(e+=this.jt.Dt().Mh()?a.xh:a.Sh),e.trim()}wh(a,b,c){return b?c?this.jt.Dt().Mh()?a.Sh:a.xh:a.Kt:""}}function bx(a,b,c,d){let e=Number.isFinite(b),f=Number.isFinite(c);return e&&f?a(b,c):e||f?e?b:c:d}class by{constructor(a,b){this.kh=a,this.yh=b}Ch(a){return null!==a&&this.kh===a.kh&&this.yh===a.yh}Th(){return new by(this.kh,this.yh)}Ph(){return this.kh}Rh(){return this.yh}Dh(){return this.yh-this.kh}Ni(){return this.yh===this.kh||Number.isNaN(this.yh)||Number.isNaN(this.kh)}ts(a){return null===a?this:new by(bx(Math.min,this.Ph(),a.Ph(),-1/0),bx(Math.max,this.Rh(),a.Rh(),1/0))}Vh(a){if(!V(a)||0==this.yh-this.kh)return;let b=.5*(this.yh+this.kh),c=this.yh-b,d=this.kh-b;c*=a,d*=a,this.yh=b+c,this.kh=b+d}Oh(a){V(a)&&(this.yh+=a,this.kh+=a)}Bh(){return{minValue:this.kh,maxValue:this.yh}}static Ah(a){return null===a?null:new by(a.minValue,a.maxValue)}}class bz{constructor(a,b){this.Ih=a,this.zh=b||null}Lh(){return this.Ih}Eh(){return this.zh}Bh(){return null===this.Ih?null:{priceRange:this.Ih.Bh(),margins:this.zh||void 0}}static Ah(a){return null===a?null:new bz(by.Ah(a.priceRange),a.margins)}}class bA extends bf{constructor(a,b){super(a),this.Nh=b}yr(){let a=this.Sr;a.yt=!1;let b=this.Nh.W();if(!this.Es.yt()||!b.lineVisible)return;let c=this.Nh.Fh();null!==c&&(a.yt=!0,a.st=c,a.V=b.color,a.et=b.lineWidth,a.Nt=b.lineStyle,a.gr=this.Nh.W().id)}}class bB extends aq{constructor(a,b){super(),this.jr=a,this.Nh=b}zi(a,b,c){a.yt=!1,b.yt=!1;let d=this.Nh.W(),e=d.axisLabelVisible,f=""!==d.title,g=this.jr;if(!e||!g.yt())return;let h=this.Nh.Fh();if(null===h)return;f&&(b.Kt=d.title,b.yt=!0),b.Ot=g.$t().Bt(h/g.Dt().At()),a.Kt=this.Wh(d.price),a.yt=!0;let i=S(d.axisLabelColor||d.color);c.t=i.t;let j=d.axisLabelTextColor||i.i;a.V=j,b.V=j,c.ki=h}Wh(a){let b=this.jr.Ct();return null===b?"":this.jr.Dt().Fi(a,b.Vt)}}class bC{constructor(a,b){this.jr=a,this.cn=b,this.jh=new bA(a,this),this.ur=new bB(a,this),this.Hh=new bd(this.ur,a,a.$t())}$h(a){U(this.cn,a),this.bt(),this.jr.$t().Uh()}W(){return this.cn}qh(){return this.jh}Yh(){return this.Hh}Zh(){return this.ur}bt(){this.jh.bt(),this.ur.bt()}Fh(){let a=this.jr,b=a.Dt();if(a.$t().St().Ni()||b.Ni())return null;let c=a.Ct();return null===c?null:b.Rt(this.cn.price,c.Vt)}}class bD extends av{constructor(a){super(),this.$i=a}$t(){return this.$i}}let bE={Bar:(a,b,c,d)=>{var e;let f=b.upColor,g=b.downColor,h=H(a(c,d)),i=I(h.Vt[0])<=I(h.Vt[3]);return{ce:null!=(e=h.V)?e:i?f:g}},Candlestick:(a,b,c,d)=>{var e,f,g;let h=b.upColor,i=b.downColor,j=b.borderUpColor,k=b.borderDownColor,l=b.wickUpColor,m=b.wickDownColor,n=H(a(c,d)),o=I(n.Vt[0])<=I(n.Vt[3]);return{ce:null!=(e=n.V)?e:o?h:i,Ne:null!=(f=n.Ot)?f:o?j:k,Ee:null!=(g=n.Xh)?g:o?l:m}},Custom:(a,b,c,d)=>{var e;return{ce:null!=(e=H(a(c,d)).V)?e:b.color}},Area:(a,b,c,d)=>{var e,f,g,h;let i=H(a(c,d));return{ce:null!=(e=i.lt)?e:b.lineColor,lt:null!=(f=i.lt)?f:b.lineColor,Ps:null!=(g=i.Ps)?g:b.topColor,Rs:null!=(h=i.Rs)?h:b.bottomColor}},Baseline:(a,b,c,d)=>{var e,f,g,h,i,j;let k=H(a(c,d));return{ce:k.Vt[3]>=b.baseValue.price?b.topLineColor:b.bottomLineColor,Re:null!=(e=k.Re)?e:b.topLineColor,De:null!=(f=k.De)?f:b.bottomLineColor,ke:null!=(g=k.ke)?g:b.topFillColor1,ye:null!=(h=k.ye)?h:b.topFillColor2,Ce:null!=(i=k.Ce)?i:b.bottomFillColor1,Te:null!=(j=k.Te)?j:b.bottomFillColor2}},Line:(a,b,c,d)=>{var e,f;let g=H(a(c,d));return{ce:null!=(e=g.V)?e:b.color,lt:null!=(f=g.V)?f:b.color}},Histogram:(a,b,c,d)=>{var e;return{ce:null!=(e=H(a(c,d)).V)?e:b.color}}};class bF{constructor(a){this.Kh=(a,b)=>void 0!==b?b.Vt:this.jr.In().Gh(a),this.jr=a,this.Jh=bE[a.Qh()]}$s(a,b){return this.Jh(this.Kh,this.jr.W(),a,b)}}!function(a){a[a.NearestLeft=-1]="NearestLeft",a[a.None=0]="None",a[a.NearestRight=1]="NearestRight"}(i||(i={}));class bG{constructor(){this.tl=[],this.il=new Map,this.nl=new Map}sl(){return this.Ks()>0?this.tl[this.tl.length-1]:null}el(){return this.Ks()>0?this.rl(0):null}An(){return this.Ks()>0?this.rl(this.tl.length-1):null}Ks(){return this.tl.length}Ni(){return 0===this.Ks()}Kr(a){return null!==this.hl(a,0)}Gh(a){return this.ll(a)}ll(a,b=0){let c=this.hl(a,b);return null===c?null:Object.assign(Object.assign({},this.al(c)),{ee:this.rl(c)})}ne(){return this.tl}ol(a,b,c){if(this.Ni())return null;let d=null;for(let e of c)d=bH(d,this._l(a,b,e));return d}J(a){this.nl.clear(),this.il.clear(),this.tl=a}rl(a){return this.tl[a].ee}al(a){return this.tl[a]}hl(a,b){let c=this.ul(a);if(null===c&&0!==b)switch(b){case -1:return this.cl(a);case 1:return this.dl(a);default:throw TypeError("Unknown search mode")}return c}cl(a){let b=this.fl(a);return b>0&&(b-=1),b!==this.tl.length&&this.rl(b)<a?b:null}dl(a){let b=this.vl(a);return b!==this.tl.length&&a<this.rl(b)?b:null}ul(a){let b=this.fl(a);return b===this.tl.length||a<this.tl[b].ee?null:b}fl(a){return aQ(this.tl,a,(a,b)=>a.ee<b)}vl(a){return aR(this.tl,a,(a,b)=>a.ee>b)}pl(a,b,c){let d=null;for(let e=a;e<b;e++){let a=this.tl[e].Vt[c];Number.isNaN(a)||(null===d?d={ml:a,bl:a}:(a<d.ml&&(d.ml=a),a>d.bl&&(d.bl=a)))}return d}_l(a,b,c){if(this.Ni())return null;let d=null,e=H(this.el()),f=H(this.An()),g=Math.max(a,e),h=Math.min(b,f),i=30*Math.ceil(g/30),j=Math.max(i,30*Math.floor(h/30));{let a=this.fl(g),e=this.vl(Math.min(h,i,b));d=bH(d,this.pl(a,e,c))}let k=this.il.get(c);void 0===k&&(k=new Map,this.il.set(c,k));for(let a=Math.max(i+1,g);a<j;a+=30){let b=Math.floor(a/30),e=k.get(b);if(void 0===e){let a=this.fl(30*b),d=this.vl((b+1)*30-1);e=this.pl(a,d,c),k.set(b,e)}d=bH(d,e)}{let a=this.fl(j),b=this.vl(h);d=bH(d,this.pl(a,b,c))}return d}}function bH(a,b){return null===a?b:null===b?a:{ml:Math.min(a.ml,b.ml),bl:Math.max(a.bl,b.bl)}}class bI{constructor(a){this.wl=a}X(a,b,c){this.wl.draw(a)}gl(a,b,c){var d,e;null==(e=(d=this.wl).drawBackground)||e.call(d,a)}}class bJ{constructor(a){this.tr=null,this.wn=a}gt(){var a;let b=this.wn.renderer();if(null===b)return null;if((null==(a=this.tr)?void 0:a.Ml)===b)return this.tr.xl;let c=new bI(b);return this.tr={Ml:b,xl:c},c}Sl(){var a,b,c;return null!=(c=null==(b=(a=this.wn).zOrder)?void 0:b.call(a))?c:"normal"}}function bK(a){var b,c,d,e,f;return{Kt:a.text(),ki:a.coordinate(),Si:null==(b=a.fixedCoordinate)?void 0:b.call(a),V:a.textColor(),t:a.backColor(),yt:null==(d=null==(c=a.visible)?void 0:c.call(a))||d,hi:null==(f=null==(e=a.tickVisible)?void 0:e.call(a))||f}}class bL{constructor(a,b){this.Wt=new at,this.kl=a,this.yl=b}gt(){return this.Wt.J(Object.assign({Hi:this.yl.Hi()},bK(this.kl))),this.Wt}}class bM extends aq{constructor(a,b){super(),this.kl=a,this.Li=b}zi(a,b,c){let d=bK(this.kl);c.t=d.t,a.V=d.V;let e=2/12*this.Li.P();c.wi=e,c.gi=e,c.ki=d.ki,c.Si=d.Si,a.Kt=d.Kt,a.yt=d.yt,a.hi=d.hi}}class bN{constructor(a,b){this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=null,this.Vl=a,this.jr=b}Ol(){return this.Vl}Vn(){var a,b;null==(b=(a=this.Vl).updateAllViews)||b.call(a)}Pn(){var a,b,c,d;let e=null!=(c=null==(b=(a=this.Vl).paneViews)?void 0:b.call(a))?c:[];if((null==(d=this.Cl)?void 0:d.Ml)===e)return this.Cl.xl;let f=e.map(a=>new bJ(a));return this.Cl={Ml:e,xl:f},f}Qi(){var a,b,c,d;let e=null!=(c=null==(b=(a=this.Vl).timeAxisViews)?void 0:b.call(a))?c:[];if((null==(d=this.Tl)?void 0:d.Ml)===e)return this.Tl.xl;let f=this.jr.$t().St(),g=e.map(a=>new bL(a,f));return this.Tl={Ml:e,xl:g},g}Rn(){var a,b,c,d;let e=null!=(c=null==(b=(a=this.Vl).priceAxisViews)?void 0:b.call(a))?c:[];if((null==(d=this.Pl)?void 0:d.Ml)===e)return this.Pl.xl;let f=this.jr.Dt(),g=e.map(a=>new bM(a,f));return this.Pl={Ml:e,xl:g},g}Bl(){var a,b,c,d;let e=null!=(c=null==(b=(a=this.Vl).priceAxisPaneViews)?void 0:b.call(a))?c:[];if((null==(d=this.Rl)?void 0:d.Ml)===e)return this.Rl.xl;let f=e.map(a=>new bJ(a));return this.Rl={Ml:e,xl:f},f}Al(){var a,b,c,d;let e=null!=(c=null==(b=(a=this.Vl).timeAxisPaneViews)?void 0:b.call(a))?c:[];if((null==(d=this.Dl)?void 0:d.Ml)===e)return this.Dl.xl;let f=e.map(a=>new bJ(a));return this.Dl={Ml:e,xl:f},f}Il(a,b){var c,d,e;return null!=(e=null==(d=(c=this.Vl).autoscaleInfo)?void 0:d.call(c,a,b))?e:null}wr(a,b){var c,d,e;return null!=(e=null==(d=(c=this.Vl).hitTest)?void 0:d.call(c,a,b))?e:null}}function bO(a,b,c,d){a.forEach(a=>{b(a).forEach(a=>{a.Sl()===c&&d.push(a)})})}function bP(a){return a.Pn()}function bQ(a){return a.Bl()}function bR(a){return a.Al()}class bS extends bD{constructor(a,b,c,d,e){super(a),this.zt=new bG,this.jh=new bv(this),this.zl=[],this.Ll=new bg(this),this.El=null,this.Nl=null,this.Fl=[],this.Wl=[],this.jl=null,this.Hl=[],this.cn=b,this.$l=c;let f=new bw(this);this.rn=[f],this.Hh=new bd(f,this,a),"Area"!==c&&"Line"!==c&&"Baseline"!==c||(this.El=new bl(this)),this.Ul(),this.ql(e)}S(){null!==this.jl&&clearTimeout(this.jl)}mh(a){return this.cn.priceLineColor||a}Zr(a){let b,c,d={Xr:!0},e=this.Dt();if(this.$t().St().Ni()||e.Ni()||this.zt.Ni())return d;let f=this.$t().St().Xs(),g=this.Ct();if(null===f||null===g)return d;if(a){let a=this.zt.sl();if(null===a)return d;b=a,c=a.ee}else{let a=this.zt.ll(f.ui(),-1);if(null===a||null===(b=this.zt.Gh(a.ee)))return d;c=a.ee}let h=b.Vt[3],i=this.Us().$s(c,{Vt:b}),j=e.Rt(h,g.Vt);return{Xr:!1,_t:h,Kt:e.Fi(h,g.Vt),xh:e.Yl(h),Sh:e.Zl(h,g.Vt),V:i.ce,ki:j,ee:c}}Us(){return null!==this.Nl||(this.Nl=new bF(this)),this.Nl}W(){return this.cn}$h(a){let b=a.priceScaleId;void 0!==b&&b!==this.cn.priceScaleId&&this.$t().Xl(this,b),U(this.cn,a),void 0!==a.priceFormat&&(this.Ul(),this.$t().Kl()),this.$t().Gl(this),this.$t().Jl(),this.wn.bt("options")}J(a,b){this.zt.J(a),this.Ql(),this.wn.bt("data"),this.dn.bt("data"),null!==this.El&&(b&&b.ta?this.El.$r():0===a.length&&this.El.Hr());let c=this.$t().dr(this);this.$t().ia(c),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}na(a){this.Fl=a,this.Ql();let b=this.$t().dr(this);this.dn.bt("data"),this.$t().ia(b),this.$t().Gl(this),this.$t().Jl(),this.$t().Uh()}sa(){return this.Fl}dh(){return this.Wl}ea(a){let b=new bC(this,a);return this.zl.push(b),this.$t().Gl(this),b}ra(a){let b=this.zl.indexOf(a);-1!==b&&this.zl.splice(b,1),this.$t().Gl(this)}Qh(){return this.$l}Ct(){let a=this.ha();return null===a?null:{Vt:a.Vt[3],la:a.ot}}ha(){let a=this.$t().St().Xs();if(null===a)return null;let b=a.Os();return this.zt.ll(b,1)}In(){return this.zt}ph(a){let b=this.zt.Gh(a);return null===b?null:"Bar"===this.$l||"Candlestick"===this.$l||"Custom"===this.$l?{ge:b.Vt[0],Me:b.Vt[1],xe:b.Vt[2],Se:b.Vt[3]}:b.Vt[3]}aa(a){let b=[];bO(this.Hl,bP,"top",b);let c=this.El;return null!==c&&c.yt()&&(null===this.jl&&c.qr()&&(this.jl=setTimeout(()=>{this.jl=null,this.$t().oa()},0)),c.Ur(),b.unshift(c)),b}Pn(){let a=[];this._a()||a.push(this.Ll),a.push(this.wn,this.jh,this.dn);let b=this.zl.map(a=>a.qh());return a.push(...b),bO(this.Hl,bP,"normal",a),a}ua(){return this.ca(bP,"bottom")}da(a){return this.ca(bQ,a)}fa(a){return this.ca(bR,a)}va(a,b){return this.Hl.map(c=>c.wr(a,b)).filter(a=>null!==a)}Ji(a){return[this.Hh,...this.zl.map(a=>a.Yh())]}Rn(a,b){if(b!==this.Yi&&!this._a())return[];let c=[...this.rn];for(let a of this.zl)c.push(a.Zh());return this.Hl.forEach(a=>{c.push(...a.Rn())}),c}Qi(){let a=[];return this.Hl.forEach(b=>{a.push(...b.Qi())}),a}Il(a,b){if(void 0!==this.cn.autoscaleInfoProvider){let c=this.cn.autoscaleInfoProvider(()=>{let c=this.pa(a,b);return null===c?null:c.Bh()});return bz.Ah(c)}return this.pa(a,b)}ma(){return this.cn.priceFormat.minMove}ba(){return this.wa}Vn(){var a;for(let a of(this.wn.bt(),this.dn.bt(),this.rn))a.bt();for(let a of this.zl)a.bt();this.jh.bt(),this.Ll.bt(),null==(a=this.El)||a.bt(),this.Hl.forEach(a=>a.Vn())}Dt(){return H(super.Dt())}kt(a){if(!(("Line"===this.$l||"Area"===this.$l||"Baseline"===this.$l)&&this.cn.crosshairMarkerVisible))return null;let b=this.zt.Gh(a);return null===b?null:{_t:b.Vt[3],ht:this.ga(),Ot:this.Ma(),Pt:this.xa(),Tt:this.Sa(a)}}bh(){return this.cn.title}yt(){return this.cn.visible}ka(a){this.Hl.push(new bN(a,this))}ya(a){this.Hl=this.Hl.filter(b=>b.Ol()!==a)}Ca(){if(this.wn instanceof a5!=!1)return a=>this.wn.We(a)}Ta(){if(this.wn instanceof a5!=!1)return a=>this.wn.je(a)}_a(){return!ax(this.Dt().Pa())}pa(a,b){if(!W(a)||!W(b)||this.zt.Ni())return null;let c="Line"===this.$l||"Area"===this.$l||"Baseline"===this.$l||"Histogram"===this.$l?[3]:[2,1],d=this.zt.ol(a,b,c),e=null!==d?new by(d.ml,d.bl):null;if("Histogram"===this.Qh()){let a=this.cn.base,b=new by(a,a);e=null!==e?e.ts(b):b}let f=this.dn.uh();return this.Hl.forEach(c=>{var d,g,h,i;let j=c.Il(a,b);if(null==j?void 0:j.priceRange){let a=new by(j.priceRange.minValue,j.priceRange.maxValue);e=null!==e?e.ts(a):a}(null==j?void 0:j.margins)&&(d=f,g=j.margins,f={above:Math.max(null!=(h=null==d?void 0:d.above)?h:0,g.above),below:Math.max(null!=(i=null==d?void 0:d.below)?i:0,g.below)})}),new bz(e,f)}ga(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}Ma(){switch(this.$l){case"Line":case"Area":case"Baseline":{let a=this.cn.crosshairMarkerBorderColor;if(0!==a.length)return a}}return null}xa(){switch(this.$l){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}Sa(a){switch(this.$l){case"Line":case"Area":case"Baseline":{let a=this.cn.crosshairMarkerBackgroundColor;if(0!==a.length)return a}}return this.Us().$s(a).ce}Ul(){switch(this.cn.priceFormat.type){case"custom":this.wa={format:this.cn.priceFormat.formatter};break;case"volume":this.wa=new aC(this.cn.priceFormat.precision);break;case"percent":this.wa=new aB(this.cn.priceFormat.precision);break;default:{let a=Math.pow(10,this.cn.priceFormat.precision);this.wa=new aA(a,this.cn.priceFormat.minMove*a)}}null!==this.Yi&&this.Yi.Ra()}Ql(){let a=this.$t().St();if(!a.Da()||this.zt.Ni())return void(this.Wl=[]);let b=H(this.zt.el());this.Wl=this.Fl.map((c,d)=>{let e=H(a.Va(c.time,!0));return{time:H(this.zt.ll(e,e<b?1:-1)).ee,position:c.position,shape:c.shape,color:c.color,id:c.id,th:d,text:c.text,size:c.size,originalTime:c.originalTime}})}ql(a){switch(this.dn=new bu(this,this.$t()),this.$l){case"Bar":this.wn=new a$(this,this.$t());break;case"Candlestick":this.wn=new a3(this,this.$t());break;case"Line":this.wn=new a9(this,this.$t());break;case"Custom":this.wn=new a5(this,this.$t(),G(a));break;case"Area":this.wn=new aX(this,this.$t());break;case"Baseline":this.wn=new a1(this,this.$t());break;case"Histogram":this.wn=new a8(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.$l)}}ca(a,b){let c=[];return bO(this.Hl,a,b,c),c}}class bT{constructor(a){this.cn=a}Oa(a,b,c){if(0===this.cn.mode)return a;let d=c.vn(),e=d.Ct();if(null===e)return a;let f=d.Rt(a,e),g=c.Ba().filter(a=>a instanceof bS).reduce((a,d)=>{if(c.vr(d)||!d.yt())return a;let e=d.Dt(),f=d.In();if(e.Ni()||!f.Kr(b))return a;let g=f.Gh(b);if(null===g)return a;let h=I(d.Ct());return a.concat([e.Rt(g.Vt[3],h.Vt)])},[]);if(0===g.length)return a;g.sort((a,b)=>Math.abs(a-f)-Math.abs(b-f));let h=g[0];return d.pn(h,e)}}class bU extends ae{constructor(){super(...arguments),this.zt=null}J(a){this.zt=a}K({context:a,bitmapSize:b,horizontalPixelRatio:c,verticalPixelRatio:d}){var e;if(null===this.zt)return;let f=Math.max(1,Math.floor(c));a.lineWidth=f,e=()=>{let e=H(this.zt);if(e.Aa){for(let d of(a.strokeStyle=e.Ia,D(a,e.za),a.beginPath(),e.La)){let e=Math.round(d.Ea*c);a.moveTo(e,-f),a.lineTo(e,b.height+f)}a.stroke()}if(e.Na){for(let c of(a.strokeStyle=e.Fa,D(a,e.Wa),a.beginPath(),e.ja)){let e=Math.round(c.Ea*d);a.moveTo(-f,e),a.lineTo(b.width+f,e)}a.stroke()}},a.save(),a.lineWidth%2&&a.translate(.5,.5),e(),a.restore()}}class bV{constructor(a){this.Wt=new bU,this.ft=!0,this.tn=a}bt(){this.ft=!0}gt(){if(this.ft){let a=this.tn.$t().W().grid,b={Na:a.horzLines.visible,Aa:a.vertLines.visible,Fa:a.horzLines.color,Ia:a.vertLines.color,Wa:a.horzLines.style,za:a.vertLines.style,ja:this.tn.vn().Ha(),La:(this.tn.$t().St().Ha()||[]).map(a=>({Ea:a.coord}))};this.Wt.J(b),this.ft=!1}return this.Wt}}class bW{constructor(a){this.wn=new bV(a)}qh(){return this.wn}}let bX={$a:4,Ua:1e-4};function bY(a,b){let c=100*(a-b)/b;return b<0?-c:c}function bZ(a,b){let c=100*(a-b)/b+100;return b<0?-c:c}function b$(a,b){let c=Math.abs(a);if(c<1e-15)return 0;let d=Math.log10(c+b.Ua)+b.$a;return a<0?-d:d}function b_(a,b){let c=Math.abs(a);if(c<1e-15)return 0;let d=Math.pow(10,c-b.$a)-b.Ua;return a<0?-d:d}function b0(a,b){return null===a?null:new by(b$(a.Ph(),b),b$(a.Rh(),b))}function b1(a,b){return null===a?null:new by(b_(a.Ph(),b),b_(a.Rh(),b))}function b2(a){if(null===a)return bX;let b=Math.abs(a.Rh()-a.Ph());if(b>=1||b<1e-15)return bX;let c=Math.ceil(Math.abs(Math.log10(b))),d=bX.$a+c;return{$a:d,Ua:1/Math.pow(10,d)}}class b3{constructor(a,b){if(this.qa=a,this.Ya=b,function(a){if(a<0)return!1;for(let b=a;b>1;b/=10)if(b%10!=0)return!1;return!0}(this.qa))this.Za=[2,2.5,2];else{this.Za=[];for(let a=this.qa;1!==a;){if(a%2==0)this.Za.push(2),a/=2;else{if(a%5!=0)throw Error("unexpected base");this.Za.push(2,2.5),a/=5}if(this.Za.length>100)throw Error("something wrong with base")}}}Xa(a,b,c){let d=0===this.qa?0:1/this.qa,e=Math.pow(10,Math.max(0,Math.ceil(Math.log10(a-b)))),f=0,g=this.Ya[0];for(;;){let a=d-e<=1e-14&&e>d+1e-14,b=c*g-e<=1e-14,h=1-e<=1e-14;if(!(a&&b&&h))break;e/=g,g=this.Ya[++f%this.Ya.length]}if(e<=d+1e-14&&(e=d),e=Math.max(1,e),this.Za.length>0&&1e-14>Math.abs(e-1))for(f=0,g=this.Za[0];c*g-e<=1e-14&&e>d+1e-14;)e/=g,g=this.Za[++f%this.Za.length];return e}}class b4{constructor(a,b,c,d){this.Ka=[],this.Li=a,this.qa=b,this.Ga=c,this.Ja=d}Xa(a,b){if(a<b)throw Error("high < low");let c=this.Li.At(),d=(a-b)*this.Qa()/c,e=new b3(this.qa,[2,2.5,2]),f=new b3(this.qa,[2,2,2.5]),g=new b3(this.qa,[2.5,2,2]),h=[];return h.push(e.Xa(a,b,d),f.Xa(a,b,d),g.Xa(a,b,d)),function(a){if(a.length<1)throw Error("array is empty");let b=a[0];for(let c=1;c<a.length;++c)a[c]<b&&(b=a[c]);return b}(h)}io(){let a=this.Li,b=a.Ct();if(null===b)return void(this.Ka=[]);let c=a.At(),d=this.Ga(c-1,b),e=this.Ga(0,b),f=this.Li.W().entireTextOnly?this.no()/2:0,g=c-1-f,h=Math.max(d,e),i=Math.min(d,e);if(h===i)return void(this.Ka=[]);let j=this.Xa(h,i),k=h%j;k+=k<0?j:0;let l=h>=i?1:-1,m=null,n=0;for(let c=h-k;c>i;c-=j){let d=this.Ja(c,b,!0);null!==m&&Math.abs(d-m)<this.Qa()||d<f||d>g||(n<this.Ka.length?(this.Ka[n].Ea=d,this.Ka[n].so=a.eo(c)):this.Ka.push({Ea:d,so:a.eo(c)}),n++,m=d,a.ro()&&(j=this.Xa(c*l,i)))}this.Ka.length=n}Ha(){return this.Ka}no(){return this.Li.P()}Qa(){return Math.ceil(2.5*this.no())}}function b5(a){return a.slice().sort((a,b)=>H(a.Xi())-H(b.Xi()))}!function(a){a[a.Normal=0]="Normal",a[a.Logarithmic=1]="Logarithmic",a[a.Percentage=2]="Percentage",a[a.IndexedTo100=3]="IndexedTo100"}(j||(j={}));let b6=new aB,b7=new aA(100,1);class b8{constructor(a,b,c,d){this.ho=0,this.lo=null,this.Ih=null,this.ao=null,this.oo={_o:!1,uo:null},this.co=0,this.do=0,this.fo=new T,this.vo=new T,this.po=[],this.mo=null,this.bo=null,this.wo=null,this.Mo=null,this.wa=b7,this.xo=b2(null),this.So=a,this.cn=b,this.ko=c,this.yo=d,this.Co=new b4(this,100,this.To.bind(this),this.Po.bind(this))}Pa(){return this.So}W(){return this.cn}$h(a){if(U(this.cn,a),this.Ra(),void 0!==a.mode&&this.Ro({Cr:a.mode}),void 0!==a.scaleMargins){let b=G(a.scaleMargins.top),c=G(a.scaleMargins.bottom);if(b<0||b>1)throw Error(`Invalid top margin - expect value between 0 and 1, given=${b}`);if(c<0||c>1)throw Error(`Invalid bottom margin - expect value between 0 and 1, given=${c}`);if(b+c>1)throw Error(`Invalid margins - sum of margins must be less than 1, given=${b+c}`);this.Do(),this.bo=null}}Vo(){return this.cn.autoScale}ro(){return 1===this.cn.mode}Mh(){return 2===this.cn.mode}Oo(){return 3===this.cn.mode}Cr(){return{Wn:this.cn.autoScale,Bo:this.cn.invertScale,Cr:this.cn.mode}}Ro(a){let b=this.Cr(),c=null;void 0!==a.Wn&&(this.cn.autoScale=a.Wn),void 0!==a.Cr&&(this.cn.mode=a.Cr,2!==a.Cr&&3!==a.Cr||(this.cn.autoScale=!0),this.oo._o=!1),1===b.Cr&&a.Cr!==b.Cr&&(function(a,b){if(null===a)return!1;let c=b_(a.Ph(),b),d=b_(a.Rh(),b);return isFinite(c)&&isFinite(d)}(this.Ih,this.xo)?null!==(c=b1(this.Ih,this.xo))&&this.Ao(c):this.cn.autoScale=!0),1===a.Cr&&a.Cr!==b.Cr&&null!==(c=b0(this.Ih,this.xo))&&this.Ao(c);let d=b.Cr!==this.cn.mode;d&&(2===b.Cr||this.Mh())&&this.Ra(),d&&(3===b.Cr||this.Oo())&&this.Ra(),void 0!==a.Bo&&b.Bo!==a.Bo&&(this.cn.invertScale=a.Bo,this.Io()),this.vo.m(b,this.Cr())}zo(){return this.vo}P(){return this.ko.fontSize}At(){return this.ho}Lo(a){this.ho!==a&&(this.ho=a,this.Do(),this.bo=null)}Eo(){if(this.lo)return this.lo;let a=this.At()-this.No()-this.Fo();return this.lo=a,a}Lh(){return this.Wo(),this.Ih}Ao(a,b){let c=this.Ih;(b||null===c&&null!==a||null!==c&&!c.Ch(a))&&(this.bo=null,this.Ih=a)}Ni(){return this.Wo(),0===this.ho||!this.Ih||this.Ih.Ni()}jo(a){return this.Bo()?a:this.At()-1-a}Rt(a,b){return this.Mh()?a=bY(a,b):this.Oo()&&(a=bZ(a,b)),this.Po(a,b)}te(a,b,c){this.Wo();let d=this.Fo(),e=H(this.Lh()),f=e.Ph(),g=e.Rh(),h=this.Eo()-1,i=this.Bo(),j=h/(g-f),k=void 0===c?0:c.from,l=void 0===c?a.length:c.to,m=this.Ho();for(let c=k;c<l;c++){let e=a[c],g=e._t;if(isNaN(g))continue;let h=g;null!==m&&(h=m(e._t,b));let k=d+j*(h-f);e.st=i?k:this.ho-1-k}}be(a,b,c){this.Wo();let d=this.Fo(),e=H(this.Lh()),f=e.Ph(),g=e.Rh(),h=this.Eo()-1,i=this.Bo(),j=h/(g-f),k=void 0===c?0:c.from,l=void 0===c?a.length:c.to,m=this.Ho();for(let c=k;c<l;c++){let e=a[c],g=e.ge,h=e.Me,k=e.xe,l=e.Se;null!==m&&(g=m(e.ge,b),h=m(e.Me,b),k=m(e.xe,b),l=m(e.Se,b));let n=d+j*(g-f),o=i?n:this.ho-1-n;e.pe=o,n=d+j*(h-f),e.de=o=i?n:this.ho-1-n,n=d+j*(k-f),e.fe=o=i?n:this.ho-1-n,n=d+j*(l-f),e.me=o=i?n:this.ho-1-n}}pn(a,b){let c=this.To(a,b);return this.$o(c,b)}$o(a,b){var c,d;let e=a;return this.Mh()?(c=e,b<0&&(c=-c),e=c/100*b+b):this.Oo()&&(d=e-100,b<0&&(d=-d),e=d/100*b+b),e}Ba(){return this.po}Uo(){if(this.mo)return this.mo;let a=[];for(let b=0;b<this.po.length;b++){let c=this.po[b];null===c.Xi()&&c.Ki(b+1),a.push(c)}return a=b5(a),this.mo=a,this.mo}qo(a){-1===this.po.indexOf(a)&&(this.po.push(a),this.Ra(),this.Yo())}Zo(a){let b=this.po.indexOf(a);if(-1===b)throw Error("source is not attached to scale");this.po.splice(b,1),0===this.po.length&&(this.Ro({Wn:!0}),this.Ao(null)),this.Ra(),this.Yo()}Ct(){let a=null;for(let b of this.po){let c=b.Ct();null!==c&&(null===a||c.la<a.la)&&(a=c)}return null===a?null:a.Vt}Bo(){return this.cn.invertScale}Ha(){let a=null===this.Ct();if(null!==this.bo&&(a||this.bo.Xo===a))return this.bo.Ha;this.Co.io();let b=this.Co.Ha();return this.bo={Ha:b,Xo:a},this.fo.m(),b}Ko(){return this.fo}Go(a){this.Mh()||this.Oo()||null===this.wo&&null===this.ao&&(this.Ni()||(this.wo=this.ho-a,this.ao=H(this.Lh()).Th()))}Jo(a){if(this.Mh()||this.Oo()||null===this.wo)return;this.Ro({Wn:!1}),(a=this.ho-a)<0&&(a=0);let b=(this.wo+.2*(this.ho-1))/(a+.2*(this.ho-1)),c=H(this.ao).Th();b=Math.max(b,.1),c.Vh(b),this.Ao(c)}Qo(){this.Mh()||this.Oo()||(this.wo=null,this.ao=null)}t_(a){this.Vo()||null===this.Mo&&null===this.ao&&(this.Ni()||(this.Mo=a,this.ao=H(this.Lh()).Th()))}i_(a){if(this.Vo()||null===this.Mo)return;let b=H(this.Lh()).Dh()/(this.Eo()-1),c=a-this.Mo;this.Bo()&&(c*=-1);let d=c*b,e=H(this.ao).Th();e.Oh(d),this.Ao(e,!0),this.bo=null}n_(){this.Vo()||null!==this.Mo&&(this.Mo=null,this.ao=null)}ba(){return this.wa||this.Ra(),this.wa}Fi(a,b){switch(this.cn.mode){case 2:return this.s_(bY(a,b));case 3:return this.ba().format(bZ(a,b));default:return this.Wh(a)}}eo(a){switch(this.cn.mode){case 2:return this.s_(a);case 3:return this.ba().format(a);default:return this.Wh(a)}}Yl(a){return this.Wh(a,H(this.e_()).ba())}Zl(a,b){return a=bY(a,b),this.s_(a,b6)}r_(){return this.po}h_(a){this.oo={uo:a,_o:!1}}Vn(){this.po.forEach(a=>a.Vn())}Ra(){this.bo=null;let a=this.e_(),b=100;null!==a&&(b=Math.round(1/a.ma())),this.wa=b7,this.Mh()?(this.wa=b6,b=100):this.Oo()?(this.wa=new aA(100,1),b=100):null!==a&&(this.wa=a.ba()),this.Co=new b4(this,b,this.To.bind(this),this.Po.bind(this)),this.Co.io()}Yo(){this.mo=null}e_(){return this.po[0]||null}No(){return this.Bo()?this.cn.scaleMargins.bottom*this.At()+this.do:this.cn.scaleMargins.top*this.At()+this.co}Fo(){return this.Bo()?this.cn.scaleMargins.top*this.At()+this.co:this.cn.scaleMargins.bottom*this.At()+this.do}Wo(){this.oo._o||(this.oo._o=!0,this.l_())}Do(){this.lo=null}Po(a,b){if(this.Wo(),this.Ni())return 0;a=this.ro()&&a?b$(a,this.xo):a;let c=H(this.Lh()),d=this.Fo()+(this.Eo()-1)*(a-c.Ph())/c.Dh();return this.jo(d)}To(a,b){if(this.Wo(),this.Ni())return 0;let c=this.jo(a),d=H(this.Lh()),e=d.Ph()+d.Dh()*((c-this.Fo())/(this.Eo()-1));return this.ro()?b_(e,this.xo):e}Io(){this.bo=null,this.Co.io()}l_(){var a,b,c,d,e;let f=this.oo.uo;if(null===f)return;let g=null,h=this.r_(),i=0,j=0;for(let a of h){if(!a.yt())continue;let h=a.Ct();if(null===h)continue;let k=a.Il(f.Os(),f.ui()),l=k&&k.Lh();if(null!==l){switch(this.cn.mode){case 1:l=b0(l,this.xo);break;case 2:b=l,c=h.Vt,l=new by(bY(b.Ph(),c),bY(b.Rh(),c));break;case 3:d=l,e=h.Vt,l=new by(bZ(d.Ph(),e),bZ(d.Rh(),e))}if(g=null===g?l:g.ts(H(l)),null!==k){let a=k.Eh();null!==a&&(i=Math.max(i,a.above),j=Math.max(j,a.below))}}}if(i===this.co&&j===this.do||(this.co=i,this.do=j,this.bo=null,this.Do()),null!==g){if(g.Ph()===g.Rh()){let a=this.e_(),b=5*(null===a||this.Mh()||this.Oo()?1:a.ma());this.ro()&&(g=b1(g,this.xo)),g=new by(g.Ph()-b,g.Rh()+b),this.ro()&&(g=b0(g,this.xo))}if(this.ro()){let b=b1(g,this.xo),c=b2(b);if(a=this.xo,c.$a!==a.$a||c.Ua!==a.Ua){let a=null!==this.ao?b1(this.ao,this.xo):null;this.xo=c,g=b0(b,c),null!==a&&(this.ao=b0(a,c))}}this.Ao(g)}else null===this.Ih&&(this.Ao(new by(-.5,.5)),this.xo=b2(null));this.oo._o=!0}Ho(){return this.Mh()?bY:this.Oo()?bZ:this.ro()?a=>b$(a,this.xo):null}a_(a,b,c){return void 0===b?(void 0===c&&(c=this.ba()),c.format(a)):b(a)}Wh(a,b){return this.a_(a,this.yo.priceFormatter,b)}s_(a,b){return this.a_(a,this.yo.percentageFormatter,b)}}class b9{constructor(a,b){this.po=[],this.o_=new Map,this.ho=0,this.__=0,this.u_=1e3,this.mo=null,this.c_=new T,this.yl=a,this.$i=b,this.d_=new bW(this);let c=b.W();this.f_=this.v_("left",c.leftPriceScale),this.p_=this.v_("right",c.rightPriceScale),this.f_.zo().l(this.m_.bind(this,this.f_),this),this.p_.zo().l(this.m_.bind(this,this.p_),this),this.b_(c)}b_(a){if(a.leftPriceScale&&this.f_.$h(a.leftPriceScale),a.rightPriceScale&&this.p_.$h(a.rightPriceScale),a.localization&&(this.f_.Ra(),this.p_.Ra()),a.overlayPriceScales)for(let b of Array.from(this.o_.values())){let c=H(b[0].Dt());c.$h(a.overlayPriceScales),a.localization&&c.Ra()}}w_(a){switch(a){case"left":return this.f_;case"right":return this.p_}return this.o_.has(a)?G(this.o_.get(a))[0].Dt():null}S(){this.$t().g_().p(this),this.f_.zo().p(this),this.p_.zo().p(this),this.po.forEach(a=>{a.S&&a.S()}),this.c_.m()}M_(){return this.u_}x_(a){this.u_=a}$t(){return this.$i}Hi(){return this.__}At(){return this.ho}S_(a){this.__=a,this.k_()}Lo(a){this.ho=a,this.f_.Lo(a),this.p_.Lo(a),this.po.forEach(b=>{if(this.vr(b)){let c=b.Dt();null!==c&&c.Lo(a)}}),this.k_()}Ba(){return this.po}vr(a){let b=a.Dt();return null===b||this.f_!==b&&this.p_!==b}qo(a,b,c){let d=void 0!==c?c:this.C_().y_+1;this.T_(a,b,d)}Zo(a){let b=this.po.indexOf(a);F(-1!==b,"removeDataSource: invalid data source"),this.po.splice(b,1);let c=H(a.Dt()).Pa();if(this.o_.has(c)){let b=G(this.o_.get(c)),d=b.indexOf(a);-1!==d&&(b.splice(d,1),0===b.length&&this.o_.delete(c))}let d=a.Dt();d&&d.Ba().indexOf(a)>=0&&d.Zo(a),null!==d&&(d.Yo(),this.P_(d)),this.mo=null}mr(a){return a===this.f_?"left":a===this.p_?"right":"overlay"}R_(){return this.f_}D_(){return this.p_}V_(a,b){a.Go(b)}O_(a,b){a.Jo(b),this.k_()}B_(a){a.Qo()}A_(a,b){a.t_(b)}I_(a,b){a.i_(b),this.k_()}z_(a){a.n_()}k_(){this.po.forEach(a=>{a.Vn()})}vn(){let a=null;return this.$i.W().rightPriceScale.visible&&0!==this.p_.Ba().length?a=this.p_:this.$i.W().leftPriceScale.visible&&0!==this.f_.Ba().length?a=this.f_:0!==this.po.length&&(a=this.po[0].Dt()),null===a&&(a=this.p_),a}pr(){let a=null;return this.$i.W().rightPriceScale.visible?a=this.p_:this.$i.W().leftPriceScale.visible&&(a=this.f_),a}P_(a){null!==a&&a.Vo()&&this.L_(a)}E_(a){let b=this.yl.Xs();a.Ro({Wn:!0}),null!==b&&a.h_(b),this.k_()}N_(){this.L_(this.f_),this.L_(this.p_)}F_(){this.P_(this.f_),this.P_(this.p_),this.po.forEach(a=>{this.vr(a)&&this.P_(a.Dt())}),this.k_(),this.$i.Uh()}Uo(){return null===this.mo&&(this.mo=b5(this.po)),this.mo}W_(){return this.c_}j_(){return this.d_}L_(a){let b=a.r_();if(b&&b.length>0&&!this.yl.Ni()){let b=this.yl.Xs();null!==b&&a.h_(b)}a.Vn()}C_(){let a=this.Uo();if(0===a.length)return{H_:0,y_:0};let b=0,c=0;for(let d=0;d<a.length;d++){let e=a[d].Xi();null!==e&&(e<b&&(b=e),e>c&&(c=e))}return{H_:b,y_:c}}T_(a,b,c){let d=this.w_(b);if(null===d&&(d=this.v_(b,this.$i.W().overlayPriceScales)),this.po.push(a),!ax(b)){let c=this.o_.get(b)||[];c.push(a),this.o_.set(b,c)}d.qo(a),a.Gi(d),a.Ki(c),this.P_(d),this.mo=null}m_(a,b,c){b.Cr!==c.Cr&&this.L_(a)}v_(a,b){let c=new b8(a,Object.assign({visible:!0,autoScale:!0},Z(b)),this.$i.W().layout,this.$i.W().localization);return c.Lo(this.At()),c}}class ca{constructor(a,b,c=50){this.Ke=0,this.Ge=1,this.Je=1,this.tr=new Map,this.Qe=new Map,this.U_=a,this.q_=b,this.ir=c}Y_(a){let b=a.time,c=this.q_.cacheKey(b),d=this.tr.get(c);if(void 0!==d)return d.Z_;if(this.Ke===this.ir){let a=this.Qe.get(this.Je);this.Qe.delete(this.Je),this.tr.delete(G(a)),this.Je++,this.Ke--}let e=this.U_(a);return this.tr.set(c,{Z_:e,rr:this.Ge}),this.Qe.set(this.Ge,c),this.Ke++,this.Ge++,e}}class cb{constructor(a,b){F(a<=b,"right should be >= left"),this.X_=a,this.K_=b}Os(){return this.X_}ui(){return this.K_}G_(){return this.K_-this.X_+1}Kr(a){return this.X_<=a&&a<=this.K_}Ch(a){return this.X_===a.Os()&&this.K_===a.ui()}}function cc(a,b){return null===a||null===b?a===b:a.Ch(b)}class cd{constructor(){this.J_=new Map,this.tr=null,this.Q_=!1}tu(a){this.Q_=a,this.tr=null}iu(a,b){this.nu(b),this.tr=null;for(let c=b;c<a.length;++c){let b=a[c],d=this.J_.get(b.timeWeight);void 0===d&&(d=[],this.J_.set(b.timeWeight,d)),d.push({index:c,time:b.time,weight:b.timeWeight,originalTime:b.originalTime})}}su(a,b){let c=Math.ceil(b/a);return null!==this.tr&&this.tr.eu===c||(this.tr={Ha:this.ru(c),eu:c}),this.tr.Ha}nu(a){if(0===a)return void this.J_.clear();let b=[];for(let c of(this.J_.forEach((c,d)=>{a<=c[0].index?b.push(d):c.splice(aQ(c,a,b=>b.index<a),1/0)}),b))this.J_.delete(c)}ru(a){let b=[];for(let c of Array.from(this.J_.keys()).sort((a,b)=>b-a)){if(!this.J_.get(c))continue;let d=b;b=[];let e=d.length,f=0,g=G(this.J_.get(c)),h=g.length,i=1/0,j=-1/0;for(let c=0;c<h;c++){let h=g[c],k=h.index;for(;f<e;){let a=d[f],c=a.index;if(!(c<k)){i=c;break}f++,b.push(a),j=c,i=1/0}if(i-k>=a&&k-j>=a)b.push(h),j=k;else if(this.Q_)return d}for(;f<e;f++)b.push(d[f])}return b}}class ce{constructor(a){this.hu=a}lu(){return null===this.hu?null:new cb(Math.floor(this.hu.Os()),Math.ceil(this.hu.ui()))}au(){return this.hu}static ou(){return new ce(null)}}function cf(a,b){return a.weight>b.weight?a:b}class cg{constructor(a,b,c,d){this.__=0,this._u=null,this.uu=[],this.Mo=null,this.wo=null,this.cu=new cd,this.du=new Map,this.fu=ce.ou(),this.vu=!0,this.pu=new T,this.mu=new T,this.bu=new T,this.wu=null,this.gu=null,this.Mu=[],this.cn=b,this.yo=c,this.xu=b.rightOffset,this.Su=b.barSpacing,this.$i=a,this.q_=d,this.ku(),this.cu.tu(b.uniformDistribution)}W(){return this.cn}yu(a){U(this.yo,a),this.Cu(),this.ku()}$h(a,b){var c;U(this.cn,a),this.cn.fixLeftEdge&&this.Tu(),this.cn.fixRightEdge&&this.Pu(),void 0!==a.barSpacing&&this.$i.Gn(a.barSpacing),void 0!==a.rightOffset&&this.$i.Jn(a.rightOffset),void 0!==a.minBarSpacing&&this.$i.Gn(null!=(c=a.barSpacing)?c:this.Su),this.Cu(),this.ku(),this.bu.m()}mn(a){var b,c;return null!=(c=null==(b=this.uu[a])?void 0:b.time)?c:null}Ui(a){var b;return null!=(b=this.uu[a])?b:null}Va(a,b){if(this.uu.length<1)return null;if(this.q_.key(a)>this.q_.key(this.uu[this.uu.length-1].time))return b?this.uu.length-1:null;let c=aQ(this.uu,this.q_.key(a),(a,b)=>this.q_.key(a.time)<b);return this.q_.key(a)<this.q_.key(this.uu[c].time)?b?c:null:c}Ni(){return 0===this.__||0===this.uu.length||null===this._u}Da(){return this.uu.length>0}Xs(){return this.Ru(),this.fu.lu()}Du(){return this.Ru(),this.fu.au()}Vu(){let a=this.Xs();if(null===a)return null;let b={from:a.Os(),to:a.ui()};return this.Ou(b)}Ou(a){let b=Math.round(a.from),c=Math.round(a.to),d=H(this.Bu()),e=H(this.Au());return{from:H(this.Ui(Math.max(d,b))),to:H(this.Ui(Math.min(e,c)))}}Iu(a){return{from:H(this.Va(a.from,!0)),to:H(this.Va(a.to,!0))}}Hi(){return this.__}S_(a){if(!isFinite(a)||a<=0||this.__===a)return;let b=this.Du(),c=this.__;if(this.__=a,this.vu=!0,this.cn.lockVisibleTimeRangeOnResize&&0!==c){let b=this.Su*a/c;this.Su=b}this.cn.fixLeftEdge&&null!==b&&0>=b.Os()&&(this.xu-=Math.round((c-a)/this.Su)+1,this.vu=!0),this.zu(),this.Lu()}It(a){if(this.Ni()||!W(a))return 0;let b=this.Eu()+this.xu-a;return this.__-(b+.5)*this.Su-1}Qs(a,b){let c=this.Eu(),d=void 0===b?0:b.from,e=void 0===b?a.length:b.to;for(let b=d;b<e;b++){let d=a[b].ot,e=c+this.xu-d,f=this.__-(e+.5)*this.Su-1;a[b].nt=f}}Nu(a){return Math.ceil(this.Fu(a))}Jn(a){this.vu=!0,this.xu=a,this.Lu(),this.$i.Wu(),this.$i.Uh()}le(){return this.Su}Gn(a){this.ju(a),this.Lu(),this.$i.Wu(),this.$i.Uh()}Hu(){return this.xu}Ha(){if(this.Ni())return null;if(null!==this.gu)return this.gu;let a=this.Su,b=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),c=Math.round(b/a),d=H(this.Xs()),e=Math.max(d.Os(),d.Os()-c),f=Math.max(d.ui(),d.ui()-c),g=this.cu.su(a,b),h=this.Bu()+c,i=this.Au()-c,j=this.$u(),k=this.cn.fixLeftEdge||j,l=this.cn.fixRightEdge||j,m=0;for(let a of g){let c;e<=a.index&&a.index<=f&&(m<this.Mu.length?((c=this.Mu[m]).coord=this.It(a.index),c.label=this.Uu(a),c.weight=a.weight):(c={needAlignCoordinate:!1,coord:this.It(a.index),label:this.Uu(a),weight:a.weight},this.Mu.push(c)),this.Su>b/2&&!j?c.needAlignCoordinate=!1:c.needAlignCoordinate=k&&a.index<=h||l&&a.index>=i,m++)}return this.Mu.length=m,this.gu=this.Mu,this.Mu}qu(){this.vu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}Yu(a){this.vu=!0,this._u=a,this.Lu(),this.Tu()}Zu(a,b){let c=this.Fu(a),d=this.le();this.Gn(d+d/10*b),this.cn.rightBarStaysOnScroll||this.Jn(this.Hu()+(c-this.Fu(a)))}Go(a){this.Mo&&this.n_(),null===this.wo&&null===this.wu&&(this.Ni()||(this.wo=a,this.Xu()))}Jo(a){if(null===this.wu)return;let b=aI(this.__-a,0,this.__),c=aI(this.__-H(this.wo),0,this.__);0!==b&&0!==c&&this.Gn(this.wu.le*b/c)}Qo(){null!==this.wo&&(this.wo=null,this.Ku())}t_(a){null===this.Mo&&null===this.wu&&(this.Ni()||(this.Mo=a,this.Xu()))}i_(a){if(null===this.Mo)return;let b=(this.Mo-a)/this.le();this.xu=H(this.wu).Hu+b,this.vu=!0,this.Lu()}n_(){null!==this.Mo&&(this.Mo=null,this.Ku())}Gu(){this.Ju(this.cn.rightOffset)}Ju(a,b=400){if(!isFinite(a))throw RangeError("offset is required and must be finite number");if(!isFinite(b)||b<=0)throw RangeError("animationDuration (optional) must be finite positive number");let c=this.xu,d=performance.now();this.$i.Zn({Qu:a=>(a-d)/b>=1,tc:e=>{let f=(e-d)/b;return f>=1?a:c+(a-c)*f}})}bt(a,b){this.vu=!0,this.uu=a,this.cu.iu(a,b),this.Lu()}nc(){return this.pu}sc(){return this.mu}ec(){return this.bu}Eu(){return this._u||0}rc(a){let b=a.G_();this.ju(this.__/b),this.xu=a.ui()-this.Eu(),this.Lu(),this.vu=!0,this.$i.Wu(),this.$i.Uh()}hc(){let a=this.Bu(),b=this.Au();null!==a&&null!==b&&this.rc(new cb(a,b+this.cn.rightOffset))}lc(a){let b=new cb(a.from,a.to);this.rc(b)}qi(a){return void 0!==this.yo.timeFormatter?this.yo.timeFormatter(a.originalTime):this.q_.formatHorzItem(a.time)}$u(){let{handleScroll:a,handleScale:b}=this.$i.W();return!(a.horzTouchDrag||a.mouseWheel||a.pressedMouseMove||a.vertTouchDrag||b.axisDoubleClickReset.time||b.axisPressedMouseMove.time||b.mouseWheel||b.pinch)}Bu(){return 0===this.uu.length?null:0}Au(){return 0===this.uu.length?null:this.uu.length-1}ac(a){return(this.__-1-a)/this.Su}Fu(a){let b=this.ac(a);return Math.round(1e6*(this.Eu()+this.xu-b))/1e6}ju(a){let b=this.Su;this.Su=a,this.zu(),b!==this.Su&&(this.vu=!0,this.oc())}Ru(){if(!this.vu)return;if(this.vu=!1,this.Ni())return void this._c(ce.ou());let a=this.Eu(),b=this.__/this.Su,c=this.xu+a,d=new cb(c-b+1,c);this._c(new ce(d))}zu(){let a=this.uc();if(this.Su<a&&(this.Su=a,this.vu=!0),0!==this.__){let a=.5*this.__;this.Su>a&&(this.Su=a,this.vu=!0)}}uc(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&0!==this.uu.length?this.__/this.uu.length:this.cn.minBarSpacing}Lu(){let a=this.cc();null!==a&&this.xu<a&&(this.xu=a,this.vu=!0);let b=this.dc();this.xu>b&&(this.xu=b,this.vu=!0)}cc(){let a=this.Bu(),b=this._u;return null===a||null===b?null:a-b-1+(this.cn.fixLeftEdge?this.__/this.Su:Math.min(2,this.uu.length))}dc(){return this.cn.fixRightEdge?0:this.__/this.Su-Math.min(2,this.uu.length)}Xu(){this.wu={le:this.le(),Hu:this.Hu()}}Ku(){this.wu=null}Uu(a){let b=this.du.get(a.weight);return void 0===b&&(b=new ca(a=>this.fc(a),this.q_),this.du.set(a.weight,b)),b.Y_(a)}fc(a){return this.q_.formatTickmark(a,this.yo)}_c(a){let b=this.fu;this.fu=a,cc(b.lu(),this.fu.lu())||this.pu.m(),cc(b.au(),this.fu.au())||this.mu.m(),this.oc()}oc(){this.gu=null}Cu(){this.oc(),this.du.clear()}ku(){this.q_.updateFormatter(this.yo)}Tu(){if(!this.cn.fixLeftEdge)return;let a=this.Bu();if(null===a)return;let b=this.Xs();if(null===b)return;let c=b.Os()-a;if(c<0){let a=this.xu-c-1;this.Jn(a)}this.zu()}Pu(){this.Lu(),this.zu()}}class ch{X(a,b,c){a.useMediaCoordinateSpace(a=>this.K(a,b,c))}gl(a,b,c){a.useMediaCoordinateSpace(a=>this.vc(a,b,c))}vc(a,b,c){}}class ci extends ch{constructor(a){super(),this.mc=new Map,this.zt=a}K(a){}vc(a){if(!this.zt.yt)return;let{context:b,mediaSize:c}=a,d=0;for(let a of this.zt.bc){if(0===a.Kt.length)continue;b.font=a.R;let e=this.wc(b,a.Kt);e>c.width?a.Zu=c.width/e:a.Zu=1,d+=a.gc*a.Zu}let e=0;switch(this.zt.Mc){case"top":e=0;break;case"center":e=Math.max((c.height-d)/2,0);break;case"bottom":e=Math.max(c.height-d,0)}for(let a of(b.fillStyle=this.zt.V,this.zt.bc)){b.save();let d=0;switch(this.zt.xc){case"left":b.textAlign="left",d=a.gc/2;break;case"center":b.textAlign="center",d=c.width/2;break;case"right":b.textAlign="right",d=c.width-1-a.gc/2}b.translate(d,e),b.textBaseline="top",b.font=a.R,b.scale(a.Zu,a.Zu),b.fillText(a.Kt,0,a.Sc),b.restore(),e+=a.gc*a.Zu}}wc(a,b){let c=this.kc(a.font),d=c.get(b);return void 0===d&&(d=a.measureText(b).width,c.set(b,d)),d}kc(a){let b=this.mc.get(a);return void 0===b&&(b=new Map,this.mc.set(a,b)),b}}class cj{constructor(a){this.ft=!0,this.Ft={yt:!1,V:"",bc:[],Mc:"center",xc:"center"},this.Wt=new ci(this.Ft),this.jt=a}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){let a=this.jt.W(),b=this.Ft;b.yt=a.visible,b.yt&&(b.V=a.color,b.xc=a.horzAlign,b.Mc=a.vertAlign,b.bc=[{Kt:a.text,R:ab(a.fontSize,a.fontFamily,a.fontStyle),gc:1.2*a.fontSize,Sc:0,Zu:0}])}}class ck extends av{constructor(a,b){super(),this.cn=b,this.wn=new cj(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}!function(a){a[a.OnTouchEnd=0]="OnTouchEnd",a[a.OnNextTap=1]="OnNextTap"}(k||(k={}));class cl{constructor(a,b,c){this.yc=[],this.Cc=[],this.__=0,this.Tc=null,this.Pc=new T,this.Rc=new T,this.Dc=null,this.Vc=a,this.cn=b,this.q_=c,this.Oc=new ac(this),this.yl=new cg(this,b.timeScale,this.cn.localization,c),this.vt=new aw(this,b.crosshair),this.Bc=new bT(b.crosshair),this.Ac=new ck(this,b.watermark),this.Ic(),this.yc[0].x_(2e3),this.zc=this.Lc(0),this.Ec=this.Lc(1)}Kl(){this.Nc(ay.es())}Uh(){this.Nc(ay.ss())}oa(){this.Nc(new ay(1))}Gl(a){let b=this.Fc(a);this.Nc(b)}Wc(){return this.Tc}jc(a){let b=this.Tc;this.Tc=a,null!==b&&this.Gl(b.Hc),null!==a&&this.Gl(a.Hc)}W(){return this.cn}$h(a){U(this.cn,a),this.yc.forEach(b=>b.b_(a)),void 0!==a.timeScale&&this.yl.$h(a.timeScale),void 0!==a.localization&&this.yl.yu(a.localization),(a.leftPriceScale||a.rightPriceScale)&&this.Pc.m(),this.zc=this.Lc(0),this.Ec=this.Lc(1),this.Kl()}$c(a,b){if("left"===a)return void this.$h({leftPriceScale:b});if("right"===a)return void this.$h({rightPriceScale:b});let c=this.Uc(a);null!==c&&(c.Dt.$h(b),this.Pc.m())}Uc(a){for(let b of this.yc){let c=b.w_(a);if(null!==c)return{Ht:b,Dt:c}}return null}St(){return this.yl}qc(){return this.yc}Yc(){return this.Ac}Zc(){return this.vt}Xc(){return this.Rc}Kc(a,b){a.Lo(b),this.Wu()}S_(a){this.__=a,this.yl.S_(this.__),this.yc.forEach(b=>b.S_(a)),this.Wu()}Ic(a){let b=new b9(this.yl,this);void 0!==a?this.yc.splice(a,0,b):this.yc.push(b);let c=void 0===a?this.yc.length-1:a,d=ay.es();return d.Nn(c,{Fn:0,Wn:!0}),this.Nc(d),b}V_(a,b,c){a.V_(b,c)}O_(a,b,c){a.O_(b,c),this.Jl(),this.Nc(this.Gc(a,2))}B_(a,b){a.B_(b),this.Nc(this.Gc(a,2))}A_(a,b,c){b.Vo()||a.A_(b,c)}I_(a,b,c){b.Vo()||(a.I_(b,c),this.Jl(),this.Nc(this.Gc(a,2)))}z_(a,b){b.Vo()||(a.z_(b),this.Nc(this.Gc(a,2)))}E_(a,b){a.E_(b),this.Nc(this.Gc(a,2))}Jc(a){this.yl.Go(a)}Qc(a,b){let c=this.St();if(c.Ni()||0===b)return;let d=c.Hi();a=Math.max(1,Math.min(a,d)),c.Zu(a,b),this.Wu()}td(a){this.nd(0),this.sd(a),this.ed()}rd(a){this.yl.Jo(a),this.Wu()}hd(){this.yl.Qo(),this.Uh()}nd(a){this.yl.t_(a)}sd(a){this.yl.i_(a),this.Wu()}ed(){this.yl.n_(),this.Uh()}wt(){return this.Cc}ld(a,b,c,d,e){this.vt.gn(a,b);let f=NaN,g=this.yl.Nu(a),h=this.yl.Xs();null!==h&&(g=Math.min(Math.max(h.Os(),g),h.ui()));let i=d.vn(),j=i.Ct();null!==j&&(f=i.pn(b,j)),f=this.Bc.Oa(f,g,d),this.vt.kn(g,f,d),this.oa(),e||this.Rc.m(this.vt.xt(),{x:a,y:b},c)}ad(a,b,c){let d=c.vn(),e=d.Ct(),f=d.Rt(a,H(e)),g=this.yl.Va(b,!0),h=this.yl.It(H(g));this.ld(h,f,null,c,!0)}od(a){this.Zc().Cn(),this.oa(),a||this.Rc.m(null,null,null)}Jl(){let a=this.vt.Ht();if(null!==a){let b=this.vt.xn(),c=this.vt.Sn();this.ld(b,c,null,a)}this.vt.Vn()}_d(a,b,c){let d=this.yl.mn(0);void 0!==b&&void 0!==c&&this.yl.bt(b,c);let e=this.yl.mn(0),f=this.yl.Eu(),g=this.yl.Xs();if(null!==g&&null!==d&&null!==e){let b=g.Kr(f),h=this.q_.key(d)>this.q_.key(e),i=null!==a&&a>f&&!h,j=this.yl.W().allowShiftVisibleRangeOnWhitespaceReplacement,k=b&&(void 0!==c||j)&&this.yl.W().shiftVisibleRangeOnNewBar;if(i&&!k){let b=a-f;this.yl.Jn(this.yl.Hu()-b)}}this.yl.Yu(a)}ia(a){null!==a&&a.F_()}dr(a){let b=this.yc.find(b=>b.Uo().includes(a));return void 0===b?null:b}Wu(){this.Ac.Vn(),this.yc.forEach(a=>a.F_()),this.Jl()}S(){this.yc.forEach(a=>a.S()),this.yc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}ud(){return this.Oc}br(){return this.Oc.W()}g_(){return this.Pc}dd(a,b,c){let d=this.yc[0],e=this.fd(b,a,d,c);return this.Cc.push(e),1===this.Cc.length?this.Kl():this.Uh(),e}vd(a){let b=this.dr(a),c=this.Cc.indexOf(a);F(-1!==c,"Series not found"),this.Cc.splice(c,1),H(b).Zo(a),a.S&&a.S()}Xl(a,b){let c=H(this.dr(a));c.Zo(a);let d=this.Uc(b);if(null===d){let d=a.Xi();c.qo(a,b,d)}else{let e=d.Ht===c?a.Xi():void 0;d.Ht.qo(a,b,e)}}hc(){let a=ay.ss();a.$n(),this.Nc(a)}pd(a){let b=ay.ss();b.Yn(a),this.Nc(b)}Kn(){let a=ay.ss();a.Kn(),this.Nc(a)}Gn(a){let b=ay.ss();b.Gn(a),this.Nc(b)}Jn(a){let b=ay.ss();b.Jn(a),this.Nc(b)}Zn(a){let b=ay.ss();b.Zn(a),this.Nc(b)}Un(){let a=ay.ss();a.Un(),this.Nc(a)}md(){return this.cn.rightPriceScale.visible?"right":"left"}bd(){return this.Ec}q(){return this.zc}Bt(a){let b=this.Ec,c=this.zc;if(b===c)return b;if(a=Math.max(0,Math.min(100,Math.round(100*a))),null===this.Dc||this.Dc.Ps!==c||this.Dc.Rs!==b)this.Dc={Ps:c,Rs:b,wd:new Map};else{let b=this.Dc.wd.get(a);if(void 0!==b)return b}let d=function(a,b,c){let[d,e,f,g]=Q(a),[h,i,j,k]=Q(b),l=[K(d+c*(h-d)),K(e+c*(i-e)),K(f+c*(j-f)),L(g+c*(k-g))];return`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${l[3]})`}(c,b,a/100);return this.Dc.wd.set(a,d),d}Gc(a,b){let c=new ay(b);if(null!==a){let d=this.yc.indexOf(a);c.Nn(d,{Fn:b})}return c}Fc(a,b){return void 0===b&&(b=2),this.Gc(this.dr(a),b)}Nc(a){this.Vc&&this.Vc(a),this.yc.forEach(a=>a.j_().qh().bt())}fd(a,b,c,d){let e=new bS(this,a,b,c,d),f=void 0!==a.priceScaleId?a.priceScaleId:this.md();return c.qo(e,f),ax(f)||e.$h(a),e}Lc(a){let b=this.cn.layout;return"gradient"===b.background.type?0===a?b.background.topColor:b.background.bottomColor:b.background.color}}function cm(a){return!V(a)&&!X(a)}function cn(a){return V(a)}!function(a){a[a.Disabled=0]="Disabled",a[a.Continuous=1]="Continuous",a[a.OnDataUpdate=2]="OnDataUpdate"}(l||(l={})),function(a){a[a.LastBar=0]="LastBar",a[a.LastVisible=1]="LastVisible"}(m||(m={})),function(a){a.Solid="solid",a.VerticalGradient="gradient"}(n||(n={})),function(a){a[a.Year=0]="Year",a[a.Month=1]="Month",a[a.DayOfMonth=2]="DayOfMonth",a[a.Time=3]="Time",a[a.TimeWithSeconds=4]="TimeWithSeconds"}(o||(o={}));let co=a=>a.getUTCFullYear();class cp{constructor(a="yyyy-MM-dd",b="default"){this.gd=a,this.Md=b}Y_(a){return function(a,b,c){return b.replace(/yyyy/g,az(co(a),4)).replace(/yy/g,az(co(a)%100,2)).replace(/MMMM/g,new Date(a.getUTCFullYear(),a.getUTCMonth(),1).toLocaleString(c,{month:"long"})).replace(/MMM/g,new Date(a.getUTCFullYear(),a.getUTCMonth(),1).toLocaleString(c,{month:"short"})).replace(/MM/g,az(a.getUTCMonth()+1,2)).replace(/dd/g,az(a.getUTCDate(),2))}(a,this.gd,this.Md)}}class cq{constructor(a){this.xd=a||"%h:%m:%s"}Y_(a){return this.xd.replace("%h",az(a.getUTCHours(),2)).replace("%m",az(a.getUTCMinutes(),2)).replace("%s",az(a.getUTCSeconds(),2))}}let cr={Sd:"yyyy-MM-dd",kd:"%h:%m:%s",yd:" ",Cd:"default"};class cs{constructor(a={}){let b=Object.assign(Object.assign({},cr),a);this.Td=new cp(b.Sd,b.Cd),this.Pd=new cq(b.kd),this.Rd=b.yd}Y_(a){return`${this.Td.Y_(a)}${this.Rd}${this.Pd.Y_(a)}`}}function ct(a){return 60*a*6e4}function cu(a){return 60*a*1e3}let cv=[{Dd:1e3,Vd:10},{Dd:cu(1),Vd:20},{Dd:cu(5),Vd:21},{Dd:cu(30),Vd:22},{Dd:ct(1),Vd:30},{Dd:ct(3),Vd:31},{Dd:ct(6),Vd:32},{Dd:ct(12),Vd:33}];function cw(a,b){if(a.getUTCFullYear()!==b.getUTCFullYear())return 70;if(a.getUTCMonth()!==b.getUTCMonth())return 60;if(a.getUTCDate()!==b.getUTCDate())return 50;for(let c=cv.length-1;c>=0;--c)if(Math.floor(b.getTime()/cv[c].Dd)!==Math.floor(a.getTime()/cv[c].Dd))return cv[c].Vd;return 0}function cx(a){let b=a;if(X(a)&&(b=cz(a)),!cm(b))throw Error("time must be of type BusinessDay");return{Od:Math.round(new Date(Date.UTC(b.year,b.month-1,b.day,0,0,0,0)).getTime()/1e3),Bd:b}}function cy(a){if(!V(a))throw Error("time must be of type isUTCTimestamp");return{Od:a}}function cz(a){let b=new Date(a);if(isNaN(b.getTime()))throw Error(`Invalid date string=${a}, expected format=yyyy-mm-dd`);return{day:b.getUTCDate(),month:b.getUTCMonth()+1,year:b.getUTCFullYear()}}function cA(a){X(a.time)&&(a.time=cz(a.time))}class cB{options(){return this.cn}setOptions(a){this.cn=a,this.updateFormatter(a.localization)}preprocessData(a){Array.isArray(a)?a.forEach(cA):cA(a)}createConverterToInternalObj(a){return H(0===a.length?null:cm(a[0].time)||X(a[0].time)?cx:cy)}key(a){return"object"==typeof a&&"Od"in a?a.Od:this.key(this.convertHorzItemToInternal(a))}cacheKey(a){return void 0===a.Bd?new Date(1e3*a.Od).getTime():new Date(Date.UTC(a.Bd.year,a.Bd.month-1,a.Bd.day)).getTime()}convertHorzItemToInternal(a){return V(a)?cy(a):cm(a)?cx(a):cx(cz(a))}updateFormatter(a){if(!this.cn)return;let b=a.dateFormat;this.cn.timeScale.timeVisible?this.Ad=new cs({Sd:b,kd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",yd:"   ",Cd:a.locale}):this.Ad=new cp(b,a.locale)}formatHorzItem(a){return this.Ad.Y_(new Date(1e3*a.Od))}formatTickmark(a,b){let c=function(a,b,c){switch(a){case 0:case 10:return b?c?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return b?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(a.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),d=this.cn.timeScale;if(void 0!==d.tickMarkFormatter){let e=d.tickMarkFormatter(a.originalTime,c,b.locale);if(null!==e)return e}return function(a,b,c){let d={};switch(b){case 0:d.year="numeric";break;case 1:d.month="short";break;case 2:d.day="numeric";break;case 3:d.hour12=!1,d.hour="2-digit",d.minute="2-digit";break;case 4:d.hour12=!1,d.hour="2-digit",d.minute="2-digit",d.second="2-digit"}let e=new Date(void 0===a.Bd?1e3*a.Od:Date.UTC(a.Bd.year,a.Bd.month-1,a.Bd.day));return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()).toLocaleString(c,d)}(a.time,c,b.locale)}maxTickMarkWeight(a){let b=a.reduce(cf,a[0]).weight;return b>30&&b<50&&(b=30),b}fillWeightsForPoints(a,b){!function(a,b=0){if(0===a.length)return;let c=0===b?null:a[b-1].time.Od,d=null!==c?new Date(1e3*c):null,e=0;for(let f=b;f<a.length;++f){let b=a[f],g=new Date(1e3*b.time.Od);null!==d&&(b.timeWeight=cw(g,d)),e+=b.time.Od-(c||b.time.Od),c=b.time.Od,d=g}if(0===b&&a.length>1){let b=Math.ceil(e/(a.length-1)),c=new Date(1e3*(a[0].time.Od-b));a[0].timeWeight=cw(new Date(1e3*a[0].time.Od),c)}}(a,b)}static Id(a){return U({localization:{dateFormat:"dd MMM 'yy"}},null!=a?a:{})}}let cC="undefined"!=typeof window;function cD(){return!!cC&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function cE(){return!!cC&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function cF(a,b,c){let d=(a.zd-b.zd)/(a.ot-b.ot);return Math.sign(d)*Math.min(Math.abs(d),c)}class cG{constructor(a,b,c,d){this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=null,this.jd=0,this.Hd=0,this.$d=a,this.Ud=b,this.qd=c,this.rs=d}Yd(a,b){if(null!==this.Ld){if(this.Ld.ot===b)return void(this.Ld.zd=a);if(Math.abs(this.Ld.zd-a)<this.rs)return}this.Fd=this.Nd,this.Nd=this.Ed,this.Ed=this.Ld,this.Ld={ot:b,zd:a}}Vr(a,b){var c,d,e,f,g,h;if(null===this.Ld||null===this.Ed||b-this.Ld.ot>50)return;let i=0,j=cF(this.Ld,this.Ed,this.Ud),k=(c=this.Ld,d=this.Ed,c.zd-d.zd),l=[j],m=[k];if(i+=k,null!==this.Nd){let a=cF(this.Ed,this.Nd,this.Ud);if(Math.sign(a)===Math.sign(j)){let b=(e=this.Ed,f=this.Nd,e.zd-f.zd);if(l.push(a),m.push(b),i+=b,null!==this.Fd){let a=cF(this.Nd,this.Fd,this.Ud);if(Math.sign(a)===Math.sign(j)){let b=(g=this.Nd,h=this.Fd,g.zd-h.zd);l.push(a),m.push(b),i+=b}}}}let n=0;for(let a=0;a<l.length;++a)n+=m[a]/i*l[a];Math.abs(n)<this.$d||(this.Wd={zd:a,ot:b},this.Hd=n,this.jd=function(a,b){let c=Math.log(b);return Math.log(-(c/a))/c}(Math.abs(n),this.qd))}tc(a){let b=H(this.Wd),c=a-b.ot;return b.zd+this.Hd*(Math.pow(this.qd,c)-1)/Math.log(this.qd)}Qu(a){return null===this.Wd||this.Zd(a)===this.jd}Zd(a){return Math.min(a-H(this.Wd).ot,this.jd)}}class cH{constructor(a,b){this.Xd=void 0,this.Kd=void 0,this.Gd=void 0,this.en=!1,this.Jd=a,this.Qd=b,this.tf()}bt(){this.tf()}if(){this.Xd&&this.Jd.removeChild(this.Xd),this.Kd&&this.Jd.removeChild(this.Kd),this.Xd=void 0,this.Kd=void 0}nf(){return this.en!==this.sf()||this.Gd!==this.ef()}ef(){return R(Q(this.Qd.W().layout.textColor))>160?"dark":"light"}sf(){return this.Qd.W().layout.attributionLogo}rf(){let a=new URL(location.href);return a.hostname?"&utm_source="+a.hostname+a.pathname:""}tf(){this.nf()&&(this.if(),this.en=this.sf(),this.en&&(this.Gd=this.ef(),this.Kd=document.createElement("style"),this.Kd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Xd=document.createElement("a"),this.Xd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.rf()}`,this.Xd.title="Charting by TradingView",this.Xd.id="tv-attr-logo",this.Xd.target="_blank",this.Xd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Xd.toggleAttribute("data-dark","dark"===this.Gd),this.Jd.appendChild(this.Kd),this.Jd.appendChild(this.Xd)))}}function cI(a,b){let c=H(a.ownerDocument).createElement("canvas");a.appendChild(c);let d=function(a,b){if("device-pixel-content-box"===b.type)return new r(a,b.transform,b.options);throw Error("Unsupported binding target")}(c,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(a,b)=>({width:Math.max(a.width,b.width),height:Math.max(a.height,b.height)})});return d.resizeCanvasElement(b),d}function cJ(a){var b;a.width=1,a.height=1,null==(b=a.getContext("2d"))||b.clearRect(0,0,1,1)}function cK(a,b,c,d){a.gl&&a.gl(b,c,d)}function cL(a,b,c,d){a.X(b,c,d)}function cM(a,b,c,d){for(let e of a(c,d)){let a=e.gt();null!==a&&b(a)}}class cN{constructor(a,b,c){this.hf=0,this.lf=null,this.af={nt:-1/0,st:1/0},this._f=0,this.uf=null,this.cf={nt:-1/0,st:1/0},this.df=null,this.ff=!1,this.vf=null,this.pf=null,this.mf=!1,this.bf=!1,this.wf=!1,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=null,this.Tf=0,this.Pf=!1,this.Rf=!1,this.Df=!1,this.Vf=0,this.Of=null,this.Bf=!cE(),this.Af=a=>{this.If(a)},this.zf=a=>{if(this.Lf(a)){let b=this.Ef(a);if(++this._f,this.uf&&this._f>1){let{Nf:c}=this.Ff(cQ(a),this.cf);c<30&&!this.wf&&this.Wf(b,this.Hf.jf),this.$f()}}else{let b=this.Ef(a);if(++this.hf,this.lf&&this.hf>1){let{Nf:c}=this.Ff(cQ(a),this.af);c<5&&!this.bf&&this.Uf(b,this.Hf.qf),this.Yf()}}},this.Zf=a,this.Hf=b,this.cn=c,this.Xf()}S(){null!==this.gf&&(this.gf(),this.gf=null),null!==this.Mf&&(this.Mf(),this.Mf=null),null!==this.Sf&&(this.Sf(),this.Sf=null),null!==this.kf&&(this.kf(),this.kf=null),null!==this.yf&&(this.yf(),this.yf=null),null!==this.xf&&(this.xf(),this.xf=null),this.Kf(),this.Yf()}Gf(a){this.Sf&&this.Sf();let b=this.Jf.bind(this);if(this.Sf=()=>{this.Zf.removeEventListener("mousemove",b)},this.Zf.addEventListener("mousemove",b),this.Lf(a))return;let c=this.Ef(a);this.Uf(c,this.Hf.Qf),this.Bf=!0}Yf(){null!==this.lf&&clearTimeout(this.lf),this.hf=0,this.lf=null,this.af={nt:-1/0,st:1/0}}$f(){null!==this.uf&&clearTimeout(this.uf),this._f=0,this.uf=null,this.cf={nt:-1/0,st:1/0}}Jf(a){if(this.Df||null!==this.pf||this.Lf(a))return;let b=this.Ef(a);this.Uf(b,this.Hf.tv),this.Bf=!0}iv(a){let b=cS(a.changedTouches,H(this.Of));if(null===b||(this.Vf=cR(a),null!==this.Cf)||this.Rf)return;this.Pf=!0;let{nv:c,sv:d,Nf:e}=this.Ff(cQ(b),H(this.pf));if(this.mf||!(e<5)){if(!this.mf){let a=.5*c,b=d>=a&&!this.cn.ev(),e=a>d&&!this.cn.rv();b||e||(this.Rf=!0),this.mf=!0,this.wf=!0,this.Kf(),this.$f()}if(!this.Rf){let c=this.Ef(a,b);this.Wf(c,this.Hf.hv),cP(a)}}}lv(a){if(0!==a.button)return;let{Nf:b}=this.Ff(cQ(a),H(this.vf));if(b>=5&&(this.bf=!0,this.Yf()),this.bf){let b=this.Ef(a);this.Uf(b,this.Hf.av)}}Ff(a,b){let c=Math.abs(b.nt-a.nt),d=Math.abs(b.st-a.st);return{nv:c,sv:d,Nf:c+d}}ov(a){let b=cS(a.changedTouches,H(this.Of));if(null===b&&0===a.touches.length&&(b=a.changedTouches[0]),null===b)return;this.Of=null,this.Vf=cR(a),this.Kf(),this.pf=null,this.yf&&(this.yf(),this.yf=null);let c=this.Ef(a,b);if(this.Wf(c,this.Hf._v),++this._f,this.uf&&this._f>1){let{Nf:a}=this.Ff(cQ(b),this.cf);a<30&&!this.wf&&this.Wf(c,this.Hf.jf),this.$f()}else this.wf||(this.Wf(c,this.Hf.uv),this.Hf.uv&&cP(a));0===this._f&&cP(a),0===a.touches.length&&this.ff&&(this.ff=!1,cP(a))}If(a){if(0!==a.button)return;let b=this.Ef(a);if(this.vf=null,this.Df=!1,this.kf&&(this.kf(),this.kf=null),cD()&&this.Zf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Af),!this.Lf(a))if(this.Uf(b,this.Hf.cv),++this.hf,this.lf&&this.hf>1){let{Nf:c}=this.Ff(cQ(a),this.af);c<5&&!this.bf&&this.Uf(b,this.Hf.qf),this.Yf()}else this.bf||this.Uf(b,this.Hf.dv)}Kf(){null!==this.df&&(clearTimeout(this.df),this.df=null)}fv(a){if(null!==this.Of)return;let b=a.changedTouches[0];this.Of=b.identifier,this.Vf=cR(a);let c=this.Zf.ownerDocument.documentElement;this.wf=!1,this.mf=!1,this.Rf=!1,this.pf=cQ(b),this.yf&&(this.yf(),this.yf=null);{let b=this.iv.bind(this),d=this.ov.bind(this);this.yf=()=>{c.removeEventListener("touchmove",b),c.removeEventListener("touchend",d)},c.addEventListener("touchmove",b,{passive:!1}),c.addEventListener("touchend",d,{passive:!1}),this.Kf(),this.df=setTimeout(this.vv.bind(this,a),240)}let d=this.Ef(a,b);this.Wf(d,this.Hf.pv),this.uf||(this._f=0,this.uf=setTimeout(this.$f.bind(this),500),this.cf=cQ(b))}mv(a){if(0!==a.button)return;let b=this.Zf.ownerDocument.documentElement;cD()&&b.addEventListener("mouseleave",this.Af),this.bf=!1,this.vf=cQ(a),this.kf&&(this.kf(),this.kf=null);{let a=this.lv.bind(this),c=this.If.bind(this);this.kf=()=>{b.removeEventListener("mousemove",a),b.removeEventListener("mouseup",c)},b.addEventListener("mousemove",a),b.addEventListener("mouseup",c)}if(this.Df=!0,this.Lf(a))return;let c=this.Ef(a);this.Uf(c,this.Hf.bv),this.lf||(this.hf=0,this.lf=setTimeout(this.Yf.bind(this),500),this.af=cQ(a))}Xf(){var a;this.Zf.addEventListener("mouseenter",this.Gf.bind(this)),this.Zf.addEventListener("touchcancel",this.Kf.bind(this));{let a=this.Zf.ownerDocument,b=a=>{this.Hf.wv&&(a.composed&&this.Zf.contains(a.composedPath()[0])||a.target&&this.Zf.contains(a.target)||this.Hf.wv())};this.Mf=()=>{a.removeEventListener("touchstart",b)},this.gf=()=>{a.removeEventListener("mousedown",b)},a.addEventListener("mousedown",b),a.addEventListener("touchstart",b,{passive:!0})}cE()&&(this.xf=()=>{this.Zf.removeEventListener("dblclick",this.zf)},this.Zf.addEventListener("dblclick",this.zf)),this.Zf.addEventListener("mouseleave",this.gv.bind(this)),this.Zf.addEventListener("touchstart",this.fv.bind(this),{passive:!0}),a=this.Zf,cC&&void 0!==window.chrome&&a.addEventListener("mousedown",a=>{if(1===a.button)return a.preventDefault(),!1}),this.Zf.addEventListener("mousedown",this.mv.bind(this)),this.Mv(),this.Zf.addEventListener("touchmove",()=>{},{passive:!1})}Mv(){void 0===this.Hf.xv&&void 0===this.Hf.Sv&&void 0===this.Hf.kv||(this.Zf.addEventListener("touchstart",a=>this.yv(a.touches),{passive:!0}),this.Zf.addEventListener("touchmove",a=>{if(2===a.touches.length&&null!==this.Cf&&void 0!==this.Hf.Sv){let b=cO(a.touches[0],a.touches[1])/this.Tf;this.Hf.Sv(this.Cf,b),cP(a)}},{passive:!1}),this.Zf.addEventListener("touchend",a=>{this.yv(a.touches)}))}yv(a){1===a.length&&(this.Pf=!1),2!==a.length||this.Pf||this.ff?this.Cv():this.Tv(a)}Tv(a){let b=this.Zf.getBoundingClientRect()||{left:0,top:0};this.Cf={nt:(a[0].clientX-b.left+(a[1].clientX-b.left))/2,st:(a[0].clientY-b.top+(a[1].clientY-b.top))/2},this.Tf=cO(a[0],a[1]),void 0!==this.Hf.xv&&this.Hf.xv(),this.Kf()}Cv(){null!==this.Cf&&(this.Cf=null,void 0!==this.Hf.kv&&this.Hf.kv())}gv(a){if(this.Sf&&this.Sf(),this.Lf(a)||!this.Bf)return;let b=this.Ef(a);this.Uf(b,this.Hf.Pv),this.Bf=!cE()}vv(a){let b=cS(a.touches,H(this.Of));if(null===b)return;let c=this.Ef(a,b);this.Wf(c,this.Hf.Rv),this.wf=!0,this.ff=!0}Lf(a){return a.sourceCapabilities&&void 0!==a.sourceCapabilities.firesTouchEvents?a.sourceCapabilities.firesTouchEvents:cR(a)<this.Vf+500}Wf(a,b){b&&b.call(this.Hf,a)}Uf(a,b){b&&b.call(this.Hf,a)}Ef(a,b){let c=b||a,d=this.Zf.getBoundingClientRect()||{left:0,top:0};return{clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,screenX:c.screenX,screenY:c.screenY,localX:c.clientX-d.left,localY:c.clientY-d.top,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,metaKey:a.metaKey,Dv:!a.type.startsWith("mouse")&&"contextmenu"!==a.type&&"click"!==a.type,Vv:a.type,Ov:c.target,Bv:a.view,Av:()=>{"touchstart"!==a.type&&cP(a)}}}}function cO(a,b){let c=a.clientX-b.clientX,d=a.clientY-b.clientY;return Math.sqrt(c*c+d*d)}function cP(a){a.cancelable&&a.preventDefault()}function cQ(a){return{nt:a.pageX,st:a.pageY}}function cR(a){return a.timeStamp||performance.now()}function cS(a,b){for(let c=0;c<a.length;++c)if(a[c].identifier===b)return a[c];return null}function cT(a){return{Hc:a.Hc,Iv:{gr:a.zv.externalId},Lv:a.zv.cursorStyle}}function cU(a,b){return c=>{var d,e,f,g;return(null!=(e=null==(d=c.Dt())?void 0:d.Pa())?e:"")!==b?[]:null!=(g=null==(f=c.da)?void 0:f.call(c,a))?g:[]}}function cV(a,b,c,d){if(!a.length)return;let e=0,f=c/2,g=a[0].At(d,!0),h=1===b?f-(a[0].Vi()-g/2):a[0].Vi()-g/2-f;h=Math.max(0,h);for(let f=1;f<a.length;f++){let g=a[f],i=a[f-1],j=i.At(d,!1),k=g.Vi(),l=i.Vi();if(1===b?k>l-j:k<l+j){let d=l-j*b;g.Oi(d);let f=d-b*j/2;if((1===b?f<0:f>c)&&h>0){let d=Math.min(1===b?-1-f:f-c,h);for(let c=e;c<a.length;c++)a[c].Oi(a[c].Vi()+b*d);h-=d}}else e=f,h=1===b?l-j-k:k-(l+j)}}class cW{constructor(a,b,c,e){this.Li=null,this.Ev=null,this.Nv=!1,this.Fv=new bb(200),this.Qr=null,this.Wv=0,this.jv=!1,this.Hv=()=>{this.jv||this.tn.$v().$t().Uh()},this.Uv=()=>{this.jv||this.tn.$v().$t().Uh()},this.tn=a,this.cn=b,this.ko=b.layout,this.Oc=c,this.qv="left"===e,this.Yv=cU("normal",e),this.Zv=cU("top",e),this.Xv=cU("bottom",e),this.Kv=document.createElement("div"),this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Kv.style.width="25px",this.Kv.style.left="0",this.Kv.style.position="relative",this.Gv=cI(this.Kv,d({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);let f=this.Gv.canvasElement;f.style.position="absolute",f.style.zIndex="1",f.style.left="0",f.style.top="0",this.Jv=cI(this.Kv,d({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);let g=this.Jv.canvasElement;g.style.position="absolute",g.style.zIndex="2",g.style.left="0",g.style.top="0";let h={bv:this.Qv.bind(this),pv:this.Qv.bind(this),av:this.tp.bind(this),hv:this.tp.bind(this),wv:this.ip.bind(this),cv:this.np.bind(this),_v:this.np.bind(this),qf:this.sp.bind(this),jf:this.sp.bind(this),Qf:this.ep.bind(this),Pv:this.rp.bind(this)};this.hp=new cN(this.Jv.canvasElement,h,{ev:()=>!this.cn.handleScroll.vertTouchDrag,rv:()=>!0})}S(){this.hp.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),cJ(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),cJ(this.Gv.canvasElement),this.Gv.dispose(),null!==this.Li&&this.Li.Ko().p(this),this.Li=null}lp(){return this.Kv}P(){return this.ko.fontSize}ap(){let a=this.Oc.W();return this.Qr!==a.R&&(this.Fv.nr(),this.Qr=a.R),a}op(){var a,b;if(null===this.Li)return 0;let c=0,d=this.ap(),e=H(this.Gv.canvasElement.getContext("2d"));e.save();let f=this.Li.Ha();e.font=this._p(),f.length>0&&(c=Math.max(this.Fv.xi(e,f[0].so),this.Fv.xi(e,f[f.length-1].so)));let g=this.up();for(let a=g.length;a--;){let b=this.Fv.xi(e,g[a].Kt());b>c&&(c=b)}let h=this.Li.Ct();if(null!==h&&null!==this.Ev&&2!==(a=this.cn.crosshair).mode&&a.horzLine.visible&&a.horzLine.labelVisible){let a=this.Li.pn(1,h),b=this.Li.pn(this.Ev.height-2,h);c=Math.max(c,this.Fv.xi(e,this.Li.Fi(Math.floor(Math.min(a,b))+.11111111111111,h)),this.Fv.xi(e,this.Li.Fi(Math.ceil(Math.max(a,b))-.11111111111111,h)))}e.restore();let i=c||34;return(b=Math.ceil(d.C+d.T+d.A+d.I+5+i))+b%2}cp(a){null!==this.Ev&&e(this.Ev,a)||(this.Ev=a,this.jv=!0,this.Gv.resizeCanvasElement(a),this.Jv.resizeCanvasElement(a),this.jv=!1,this.Kv.style.width=`${a.width}px`,this.Kv.style.height=`${a.height}px`)}dp(){return H(this.Ev).width}Gi(a){this.Li!==a&&(null!==this.Li&&this.Li.Ko().p(this),this.Li=a,a.Ko().l(this.fo.bind(this),this))}Dt(){return this.Li}nr(){let a=this.tn.fp();this.tn.$v().$t().E_(a,H(this.Dt()))}vp(a){if(null===this.Ev)return;if(1!==a){this.pp(),this.Gv.applySuggestedBitmapSize();let a=u(this.Gv);null!==a&&(a.useBitmapCoordinateSpace(a=>{this.mp(a),this.Ie(a)}),this.tn.bp(a,this.Xv),this.wp(a),this.tn.bp(a,this.Yv),this.gp(a))}this.Jv.applySuggestedBitmapSize();let b=u(this.Jv);null!==b&&(b.useBitmapCoordinateSpace(({context:a,bitmapSize:b})=>{a.clearRect(0,0,b.width,b.height)}),this.Mp(b),this.tn.bp(b,this.Zv))}xp(){return this.Gv.bitmapSize}Sp(a,b,c){let d=this.xp();d.width>0&&d.height>0&&a.drawImage(this.Gv.canvasElement,b,c)}bt(){var a;null==(a=this.Li)||a.Ha()}Qv(a){if(null===this.Li||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;let b=this.tn.$v().$t(),c=this.tn.fp();this.Nv=!0,b.V_(c,this.Li,a.localY)}tp(a){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let b=this.tn.$v().$t(),c=this.tn.fp(),d=this.Li;b.O_(c,d,a.localY)}ip(){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let a=this.tn.$v().$t(),b=this.tn.fp(),c=this.Li;this.Nv&&(this.Nv=!1,a.B_(b,c))}np(a){if(null===this.Li||!this.cn.handleScale.axisPressedMouseMove.price)return;let b=this.tn.$v().$t(),c=this.tn.fp();this.Nv=!1,b.B_(c,this.Li)}sp(a){this.cn.handleScale.axisDoubleClickReset.price&&this.nr()}ep(a){null!==this.Li&&(!this.tn.$v().$t().W().handleScale.axisPressedMouseMove.price||this.Li.Mh()||this.Li.Oo()||this.kp(1))}rp(a){this.kp(0)}up(){let a=[],b=null===this.Li?void 0:this.Li;return(c=>{for(let d=0;d<c.length;++d){let e=c[d].Rn(this.tn.fp(),b);for(let b=0;b<e.length;b++)a.push(e[b])}})(this.tn.fp().Uo()),a}mp({context:a,bitmapSize:b}){let{width:c,height:d}=b,e=this.tn.fp().$t(),f=e.q(),g=e.bd();f===g?al(a,0,0,c,d,f):ao(a,0,0,c,d,f,g)}Ie({context:a,bitmapSize:b,horizontalPixelRatio:c}){let d;if(null===this.Ev||null===this.Li||!this.Li.W().borderVisible)return;a.fillStyle=this.Li.W().borderColor;let e=Math.max(1,Math.floor(this.ap().C*c));d=this.qv?b.width-e:0,a.fillRect(d,0,e,b.height)}wp(a){if(null===this.Ev||null===this.Li)return;let b=this.Li.Ha(),c=this.Li.W(),d=this.ap(),e=this.qv?this.Ev.width-d.T:0;c.borderVisible&&c.ticksVisible&&a.useBitmapCoordinateSpace(({context:a,horizontalPixelRatio:f,verticalPixelRatio:g})=>{a.fillStyle=c.borderColor;let h=Math.max(1,Math.floor(g)),i=Math.floor(.5*g),j=Math.round(d.T*f);for(let c of(a.beginPath(),b))a.rect(Math.floor(e*f),Math.round(c.Ea*g)-i,j,h);a.fill()}),a.useMediaCoordinateSpace(({context:a})=>{var f;a.font=this._p(),a.fillStyle=null!=(f=c.textColor)?f:this.ko.textColor,a.textAlign=this.qv?"right":"left",a.textBaseline="middle";let g=this.qv?Math.round(e-d.A):Math.round(e+d.T+d.A),h=b.map(b=>this.Fv.Mi(a,b.so));for(let c=b.length;c--;){let d=b[c];a.fillText(d.so,g,d.Ea+h[c])}})}pp(){if(null===this.Ev||null===this.Li)return;let a=[],b=this.Li.Uo().slice(),c=this.tn.fp(),d=this.ap();this.Li===c.pr()&&this.tn.fp().Uo().forEach(a=>{c.vr(a)&&b.push(a)});let e=this.Li;b.forEach(b=>{b.Rn(c,e).forEach(b=>{b.Oi(null),b.Bi()&&a.push(b)})}),a.forEach(a=>a.Oi(a.ki())),this.Li.W().alignLabels&&this.yp(a,d)}yp(a,b){if(null===this.Ev)return;let c=this.Ev.height/2,d=a.filter(a=>a.ki()<=c),e=a.filter(a=>a.ki()>c);for(let c of(d.sort((a,b)=>b.ki()-a.ki()),e.sort((a,b)=>a.ki()-b.ki()),a)){let a=Math.floor(c.At(b)/2),d=c.ki();d>-a&&d<a&&c.Oi(a),d>this.Ev.height-a&&d<this.Ev.height+a&&c.Oi(this.Ev.height-a)}cV(d,1,this.Ev.height,b),cV(e,-1,this.Ev.height,b)}gp(a){if(null===this.Ev)return;let b=this.up(),c=this.ap(),d=this.qv?"right":"left";b.forEach(b=>{b.Ai()&&b.gt(H(this.Li)).X(a,c,this.Fv,d)})}Mp(a){if(null===this.Ev||null===this.Li)return;let b=this.tn.$v().$t(),c=[],d=this.tn.fp(),e=b.Zc().Rn(d,this.Li);e.length&&c.push(e);let f=this.ap(),g=this.qv?"right":"left";c.forEach(b=>{b.forEach(b=>{b.gt(H(this.Li)).X(a,f,this.Fv,g)})})}kp(a){this.Kv.style.cursor=1===a?"ns-resize":"default"}fo(){let a=this.op();this.Wv<a&&this.tn.$v().$t().Kl(),this.Wv=a}_p(){return ab(this.ko.fontSize,this.ko.fontFamily)}}function cX(a,b){var c,d;return null!=(d=null==(c=a.ua)?void 0:c.call(a,b))?d:[]}function cY(a,b){var c,d;return null!=(d=null==(c=a.Pn)?void 0:c.call(a,b))?d:[]}function cZ(a,b){var c,d;return null!=(d=null==(c=a.Ji)?void 0:c.call(a,b))?d:[]}function c$(a,b){var c,d;return null!=(d=null==(c=a.aa)?void 0:c.call(a,b))?d:[]}class c_{constructor(a,b){this.Ev=d({width:0,height:0}),this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=null,this.Dp=!1,this.Vp=new T,this.Op=new T,this.Bp=0,this.Ap=!1,this.Ip=null,this.zp=!1,this.Lp=null,this.Ep=null,this.jv=!1,this.Hv=()=>{this.jv||null===this.Np||this.$i().Uh()},this.Uv=()=>{this.jv||null===this.Np||this.$i().Uh()},this.Qd=a,this.Np=b,this.Np.W_().l(this.Fp.bind(this),this,!0),this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.Wp.style.position="relative";let c=document.createElement("div");c.style.width="100%",c.style.height="100%",c.style.position="relative",c.style.overflow="hidden",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Hp=document.createElement("td"),this.Hp.style.padding="0",this.Wp.appendChild(c),this.Gv=cI(c,d({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);let e=this.Gv.canvasElement;e.style.position="absolute",e.style.zIndex="1",e.style.left="0",e.style.top="0",this.Jv=cI(c,d({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);let f=this.Jv.canvasElement;f.style.position="absolute",f.style.zIndex="2",f.style.left="0",f.style.top="0",this.$p=document.createElement("tr"),this.$p.appendChild(this.jp),this.$p.appendChild(this.Wp),this.$p.appendChild(this.Hp),this.Up(),this.hp=new cN(this.Jv.canvasElement,this,{ev:()=>null===this.Ip&&!this.Qd.W().handleScroll.vertTouchDrag,rv:()=>null===this.Ip&&!this.Qd.W().handleScroll.horzTouchDrag})}S(){null!==this.Cp&&this.Cp.S(),null!==this.Tp&&this.Tp.S(),this.Pp=null,this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),cJ(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),cJ(this.Gv.canvasElement),this.Gv.dispose(),null!==this.Np&&this.Np.W_().p(this),this.hp.S()}fp(){return H(this.Np)}qp(a){var b,c;null!==this.Np&&this.Np.W_().p(this),this.Np=a,null!==this.Np&&this.Np.W_().l(c_.prototype.Fp.bind(this),this,!0),this.Up(),this.Qd.Yp().indexOf(this)===this.Qd.Yp().length-1?(this.Pp=null!=(b=this.Pp)?b:new cH(this.Wp,this.Qd),this.Pp.bt()):(null==(c=this.Pp)||c.if(),this.Pp=null)}$v(){return this.Qd}lp(){return this.$p}Up(){if(null!==this.Np&&(this.Zp(),0!==this.$i().wt().length)){if(null!==this.Cp){let a=this.Np.R_();this.Cp.Gi(H(a))}if(null!==this.Tp){let a=this.Np.D_();this.Tp.Gi(H(a))}}}Xp(){null!==this.Cp&&this.Cp.bt(),null!==this.Tp&&this.Tp.bt()}M_(){return null!==this.Np?this.Np.M_():0}x_(a){this.Np&&this.Np.x_(a)}Qf(a){if(!this.Np)return;this.Kp();let b=a.localX,c=a.localY;this.Gp(b,c,a)}bv(a){this.Kp(),this.Jp(),this.Gp(a.localX,a.localY,a)}tv(a){var b;if(!this.Np)return;this.Kp();let c=a.localX,d=a.localY;this.Gp(c,d,a);let e=this.wr(c,d);this.Qd.Qp(null!=(b=null==e?void 0:e.Lv)?b:null),this.$i().jc(e&&{Hc:e.Hc,Iv:e.Iv})}dv(a){null!==this.Np&&(this.Kp(),this.tm(a))}qf(a){null!==this.Np&&this.im(this.Op,a)}jf(a){this.qf(a)}av(a){this.Kp(),this.nm(a),this.Gp(a.localX,a.localY,a)}cv(a){null!==this.Np&&(this.Kp(),this.Ap=!1,this.sm(a))}uv(a){null!==this.Np&&this.tm(a)}Rv(a){if(this.Ap=!0,null===this.Ip){let b={x:a.localX,y:a.localY};this.rm(b,b,a)}}Pv(a){null!==this.Np&&(this.Kp(),this.Np.$t().jc(null),this.hm())}lm(){return this.Vp}am(){return this.Op}xv(){this.Bp=1,this.$i().Un()}Sv(a,b){if(!this.Qd.W().handleScale.pinch)return;let c=5*(b-this.Bp);this.Bp=b,this.$i().Qc(a.nt,c)}pv(a){this.Ap=!1,this.zp=null!==this.Ip,this.Jp();let b=this.$i().Zc();null!==this.Ip&&b.yt()&&(this.Lp={x:b.Yt(),y:b.Zt()},this.Ip={x:a.localX,y:a.localY})}hv(a){if(null===this.Np)return;let b=a.localX,c=a.localY;if(null===this.Ip)this.nm(a);else{this.zp=!1;let d=H(this.Lp),e=d.x+(b-this.Ip.x),f=d.y+(c-this.Ip.y);this.Gp(e,f,a)}}_v(a){0===this.$v().W().trackingMode.exitMode&&(this.zp=!0),this.om(),this.sm(a)}wr(a,b){let c=this.Np;return null===c?null:function(a,b,c){let d=a.Uo(),e=function(a,b,c){var d,e,f,g;let h,i;for(let j of a)for(let a of null!=(e=null==(d=j.va)?void 0:d.call(j,b,c))?e:[])f=a.zOrder,(g=null==h?void 0:h.zOrder)&&("top"!==f||"top"===g)&&("normal"!==f||"bottom"!==g)||(h=a,i=j);return h&&i?{zv:h,Hc:i}:null}(d,b,c);if("top"===(null==e?void 0:e.zv.zOrder))return cT(e);for(let f of d){if(e&&e.Hc===f&&"bottom"!==e.zv.zOrder&&!e.zv.isBackground)return cT(e);let d=function(a,b,c){for(let d of a){let a=d.gt();if(null!==a&&a.wr){let e=a.wr(b,c);if(null!==e)return{Bv:d,Iv:e}}}return null}(f.Pn(a),b,c);if(null!==d)return{Hc:f,Bv:d.Bv,Iv:d.Iv};if(e&&e.Hc===f&&"bottom"!==e.zv.zOrder&&e.zv.isBackground)return cT(e)}return(null==e?void 0:e.zv)?cT(e):null}(c,a,b)}_m(a,b){H("left"===b?this.Cp:this.Tp).cp(d({width:a,height:this.Ev.height}))}um(){return this.Ev}cp(a){e(this.Ev,a)||(this.Ev=a,this.jv=!0,this.Gv.resizeCanvasElement(a),this.Jv.resizeCanvasElement(a),this.jv=!1,this.Wp.style.width=a.width+"px",this.Wp.style.height=a.height+"px")}dm(){let a=H(this.Np);for(let b of(a.P_(a.R_()),a.P_(a.D_()),a.Ba()))if(a.vr(b)){let c=b.Dt();null!==c&&a.P_(c),b.Vn()}}xp(){return this.Gv.bitmapSize}Sp(a,b,c){let d=this.xp();d.width>0&&d.height>0&&a.drawImage(this.Gv.canvasElement,b,c)}vp(a){if(0===a||null===this.Np)return;if(a>1&&this.dm(),null!==this.Cp&&this.Cp.vp(a),null!==this.Tp&&this.Tp.vp(a),1!==a){this.Gv.applySuggestedBitmapSize();let a=u(this.Gv);null!==a&&(a.useBitmapCoordinateSpace(a=>{this.mp(a)}),this.Np&&(this.fm(a,cX),this.vm(a),this.pm(a),this.fm(a,cY),this.fm(a,cZ)))}this.Jv.applySuggestedBitmapSize();let b=u(this.Jv);null!==b&&(b.useBitmapCoordinateSpace(({context:a,bitmapSize:b})=>{a.clearRect(0,0,b.width,b.height)}),this.bm(b),this.fm(b,c$))}wm(){return this.Cp}gm(){return this.Tp}bp(a,b){this.fm(a,b)}Fp(){null!==this.Np&&this.Np.W_().p(this),this.Np=null}tm(a){this.im(this.Vp,a)}im(a,b){let c=b.localX,d=b.localY;a.M()&&a.m(this.$i().St().Nu(c),{x:c,y:d},b)}mp({context:a,bitmapSize:b}){let{width:c,height:d}=b,e=this.$i(),f=e.q(),g=e.bd();f===g?al(a,0,0,c,d,g):ao(a,0,0,c,d,f,g)}vm(a){let b=H(this.Np).j_().qh().gt();null!==b&&b.X(a,!1)}pm(a){let b=this.$i().Yc();this.Mm(a,cY,cK,b),this.Mm(a,cY,cL,b)}bm(a){this.Mm(a,cY,cL,this.$i().Zc())}fm(a,b){let c=H(this.Np).Uo();for(let d of c)this.Mm(a,b,cK,d);for(let d of c)this.Mm(a,b,cL,d)}Mm(a,b,c,d){let e=H(this.Np),f=e.$t().Wc(),g=null!==f&&f.Hc===d,h=null!==f&&g&&void 0!==f.Iv?f.Iv.Mr:void 0;cM(b,b=>c(b,a,g,h),d,e)}Zp(){if(null===this.Np)return;let a=this.Qd,b=this.Np.R_().W().visible,c=this.Np.D_().W().visible;b||null===this.Cp||(this.jp.removeChild(this.Cp.lp()),this.Cp.S(),this.Cp=null),c||null===this.Tp||(this.Hp.removeChild(this.Tp.lp()),this.Tp.S(),this.Tp=null);let d=a.$t().ud();b&&null===this.Cp&&(this.Cp=new cW(this,a.W(),d,"left"),this.jp.appendChild(this.Cp.lp())),c&&null===this.Tp&&(this.Tp=new cW(this,a.W(),d,"right"),this.Hp.appendChild(this.Tp.lp()))}xm(a){return a.Dv&&this.Ap||null!==this.Ip}Sm(a){return Math.max(0,Math.min(a,this.Ev.width-1))}km(a){return Math.max(0,Math.min(a,this.Ev.height-1))}Gp(a,b,c){this.$i().ld(this.Sm(a),this.km(b),c,H(this.Np))}hm(){this.$i().od()}om(){this.zp&&(this.Ip=null,this.hm())}rm(a,b,c){this.Ip=a,this.zp=!1,this.Gp(b.x,b.y,c);let d=this.$i().Zc();this.Lp={x:d.Yt(),y:d.Zt()}}$i(){return this.Qd.$t()}sm(a){if(!this.Dp)return;let b=this.$i(),c=this.fp();if(b.z_(c,c.vn()),this.Rp=null,this.Dp=!1,b.ed(),null!==this.Ep){let a=performance.now(),c=b.St();this.Ep.Vr(c.Hu(),a),this.Ep.Qu(a)||b.Zn(this.Ep)}}Kp(){this.Ip=null}Jp(){if(this.Np){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)H(document.activeElement).blur();else{let a=document.getSelection();null!==a&&a.removeAllRanges()}this.Np.vn().Ni()||this.$i().St().Ni()}}nm(a){if(null===this.Np)return;let b=this.$i(),c=b.St();if(c.Ni())return;let d=this.Qd.W(),e=d.handleScroll,f=d.kineticScroll;if((!e.pressedMouseMove||a.Dv)&&(!e.horzTouchDrag&&!e.vertTouchDrag||!a.Dv))return;let g=this.Np.vn(),h=performance.now();if(null!==this.Rp||this.xm(a)||(this.Rp={x:a.clientX,y:a.clientY,Od:h,ym:a.localX,Cm:a.localY}),null!==this.Rp&&!this.Dp&&(this.Rp.x!==a.clientX||this.Rp.y!==a.clientY)){if(a.Dv&&f.touch||!a.Dv&&f.mouse){let a=c.le();this.Ep=new cG(.2/a,7/a,.997,15/a),this.Ep.Yd(c.Hu(),this.Rp.Od)}else this.Ep=null;g.Ni()||b.A_(this.Np,g,a.localY),b.nd(a.localX),this.Dp=!0}this.Dp&&(g.Ni()||b.I_(this.Np,g,a.localY),b.sd(a.localX),null!==this.Ep&&this.Ep.Yd(c.Hu(),h))}}class c0{constructor(a,b,c,e,f){this.ft=!0,this.Ev=d({width:0,height:0}),this.Hv=()=>this.vp(3),this.qv="left"===a,this.Oc=c.ud,this.cn=b,this.Tm=e,this.Pm=f,this.Kv=document.createElement("div"),this.Kv.style.width="25px",this.Kv.style.height="100%",this.Kv.style.overflow="hidden",this.Gv=cI(this.Kv,d({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv)}S(){this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),cJ(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Kv}um(){return this.Ev}cp(a){e(this.Ev,a)||(this.Ev=a,this.Gv.resizeCanvasElement(a),this.Kv.style.width=`${a.width}px`,this.Kv.style.height=`${a.height}px`,this.ft=!0)}vp(a){if(a<3&&!this.ft||0===this.Ev.width||0===this.Ev.height)return;this.ft=!1,this.Gv.applySuggestedBitmapSize();let b=u(this.Gv);null!==b&&b.useBitmapCoordinateSpace(a=>{this.mp(a),this.Ie(a)})}xp(){return this.Gv.bitmapSize}Sp(a,b,c){let d=this.xp();d.width>0&&d.height>0&&a.drawImage(this.Gv.canvasElement,b,c)}Ie({context:a,bitmapSize:b,horizontalPixelRatio:c,verticalPixelRatio:d}){if(!this.Tm())return;a.fillStyle=this.cn.timeScale.borderColor;let e=Math.floor(this.Oc.W().C*c),f=Math.floor(this.Oc.W().C*d),g=this.qv?b.width-e:0;a.fillRect(g,0,e,f)}mp({context:a,bitmapSize:b}){al(a,0,0,b.width,b.height,this.Pm())}}function c1(a){return b=>{var c,d;return null!=(d=null==(c=b.fa)?void 0:c.call(b,a))?d:[]}}let c2=c1("normal"),c3=c1("top"),c4=c1("bottom");class c5{constructor(a,b){this.Rm=null,this.Dm=null,this.k=null,this.Vm=!1,this.Ev=d({width:0,height:0}),this.Om=new T,this.Fv=new bb(5),this.jv=!1,this.Hv=()=>{this.jv||this.Qd.$t().Uh()},this.Uv=()=>{this.jv||this.Qd.$t().Uh()},this.Qd=a,this.q_=b,this.cn=a.W().layout,this.Xd=document.createElement("tr"),this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Am=document.createElement("td"),this.Am.style.padding="0",this.Kv=document.createElement("td"),this.Kv.style.height="25px",this.Kv.style.padding="0",this.Im=document.createElement("div"),this.Im.style.width="100%",this.Im.style.height="100%",this.Im.style.position="relative",this.Im.style.overflow="hidden",this.Kv.appendChild(this.Im),this.Gv=cI(this.Im,d({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.Hv);let c=this.Gv.canvasElement;c.style.position="absolute",c.style.zIndex="1",c.style.left="0",c.style.top="0",this.Jv=cI(this.Im,d({width:16,height:16})),this.Jv.subscribeSuggestedBitmapSizeChanged(this.Uv);let e=this.Jv.canvasElement;e.style.position="absolute",e.style.zIndex="2",e.style.left="0",e.style.top="0",this.Xd.appendChild(this.Bm),this.Xd.appendChild(this.Kv),this.Xd.appendChild(this.Am),this.zm(),this.Qd.$t().g_().l(this.zm.bind(this),this),this.hp=new cN(this.Jv.canvasElement,this,{ev:()=>!0,rv:()=>!this.Qd.W().handleScroll.horzTouchDrag})}S(){this.hp.S(),null!==this.Rm&&this.Rm.S(),null!==this.Dm&&this.Dm.S(),this.Jv.unsubscribeSuggestedBitmapSizeChanged(this.Uv),cJ(this.Jv.canvasElement),this.Jv.dispose(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.Hv),cJ(this.Gv.canvasElement),this.Gv.dispose()}lp(){return this.Xd}Lm(){return this.Rm}Em(){return this.Dm}bv(a){if(this.Vm)return;this.Vm=!0;let b=this.Qd.$t();!b.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&b.Jc(a.localX)}pv(a){this.bv(a)}wv(){let a=this.Qd.$t();!a.St().Ni()&&this.Vm&&(this.Vm=!1,this.Qd.W().handleScale.axisPressedMouseMove.time&&a.hd())}av(a){let b=this.Qd.$t();!b.St().Ni()&&this.Qd.W().handleScale.axisPressedMouseMove.time&&b.rd(a.localX)}hv(a){this.av(a)}cv(){this.Vm=!1;let a=this.Qd.$t();a.St().Ni()&&!this.Qd.W().handleScale.axisPressedMouseMove.time||a.hd()}_v(){this.cv()}qf(){this.Qd.W().handleScale.axisDoubleClickReset.time&&this.Qd.$t().Kn()}jf(){this.qf()}Qf(){this.Qd.$t().W().handleScale.axisPressedMouseMove.time&&this.kp(1)}Pv(){this.kp(0)}um(){return this.Ev}Nm(){return this.Om}Fm(a,b,c){e(this.Ev,a)||(this.Ev=a,this.jv=!0,this.Gv.resizeCanvasElement(a),this.Jv.resizeCanvasElement(a),this.jv=!1,this.Kv.style.width=`${a.width}px`,this.Kv.style.height=`${a.height}px`,this.Om.m(a)),null!==this.Rm&&this.Rm.cp(d({width:b,height:a.height})),null!==this.Dm&&this.Dm.cp(d({width:c,height:a.height}))}Wm(){let a=this.jm();return Math.ceil(a.C+a.T+a.P+a.L+a.B+a.Hm)}bt(){this.Qd.$t().St().Ha()}xp(){return this.Gv.bitmapSize}Sp(a,b,c){let d=this.xp();d.width>0&&d.height>0&&a.drawImage(this.Gv.canvasElement,b,c)}vp(a){if(0===a)return;if(1!==a){this.Gv.applySuggestedBitmapSize();let b=u(this.Gv);null!==b&&(b.useBitmapCoordinateSpace(a=>{this.mp(a),this.Ie(a),this.$m(b,c4)}),this.wp(b),this.$m(b,c2)),null!==this.Rm&&this.Rm.vp(a),null!==this.Dm&&this.Dm.vp(a)}this.Jv.applySuggestedBitmapSize();let b=u(this.Jv);null!==b&&(b.useBitmapCoordinateSpace(({context:a,bitmapSize:b})=>{a.clearRect(0,0,b.width,b.height)}),this.Um([...this.Qd.$t().wt(),this.Qd.$t().Zc()],b),this.$m(b,c3))}$m(a,b){let c=this.Qd.$t().wt();for(let d of c)cM(b,b=>cK(b,a,!1,void 0),d,void 0);for(let d of c)cM(b,b=>cL(b,a,!1,void 0),d,void 0)}mp({context:a,bitmapSize:b}){al(a,0,0,b.width,b.height,this.Qd.$t().bd())}Ie({context:a,bitmapSize:b,verticalPixelRatio:c}){if(this.Qd.W().timeScale.borderVisible){a.fillStyle=this.qm();let d=Math.max(1,Math.floor(this.jm().C*c));a.fillRect(0,0,b.width,d)}}wp(a){let b=this.Qd.$t().St(),c=b.Ha();if(!c||0===c.length)return;let d=this.q_.maxTickMarkWeight(c),e=this.jm(),f=b.W();f.borderVisible&&f.ticksVisible&&a.useBitmapCoordinateSpace(({context:a,horizontalPixelRatio:b,verticalPixelRatio:d})=>{a.strokeStyle=this.qm(),a.fillStyle=this.qm();let f=Math.max(1,Math.floor(b)),g=Math.floor(.5*b);a.beginPath();let h=Math.round(e.T*d);for(let d=c.length;d--;){let e=Math.round(c[d].coord*b);a.rect(e-g,0,f,h)}a.fill()}),a.useMediaCoordinateSpace(({context:a})=>{let b=e.C+e.T+e.L+e.P/2;for(let e of(a.textAlign="center",a.textBaseline="middle",a.fillStyle=this.$(),a.font=this._p(),c))if(e.weight<d){let c=e.needAlignCoordinate?this.Ym(a,e.coord,e.label):e.coord;a.fillText(e.label,c,b)}for(let e of(this.Qd.W().timeScale.allowBoldLabels&&(a.font=this.Zm()),c))if(e.weight>=d){let c=e.needAlignCoordinate?this.Ym(a,e.coord,e.label):e.coord;a.fillText(e.label,c,b)}})}Ym(a,b,c){let d=this.Fv.xi(a,c),e=Math.floor(b-d/2)+.5;return e<0?b+=Math.abs(0-e):e+d>this.Ev.width&&(b-=Math.abs(this.Ev.width-(e+d))),b}Um(a,b){let c=this.jm();for(let d of a)for(let a of d.Qi())a.gt().X(b,c)}qm(){return this.Qd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}_p(){return ab(this.j(),this.cn.fontFamily)}Zm(){return ab(this.j(),this.cn.fontFamily,"bold")}jm(){null===this.k&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new bb,Hm:0});let a=this.k,b=this._p();if(a.R!==b){let c=this.j();a.P=c,a.R=b,a.L=3*c/12,a.B=3*c/12,a.ji=9*c/12,a.N=0,a.Hm=4*c/12,a.Wi.nr()}return this.k}kp(a){this.Kv.style.cursor=1===a?"ew-resize":"default"}zm(){let a=this.Qd.$t(),b=a.W();b.leftPriceScale.visible||null===this.Rm||(this.Bm.removeChild(this.Rm.lp()),this.Rm.S(),this.Rm=null),b.rightPriceScale.visible||null===this.Dm||(this.Am.removeChild(this.Dm.lp()),this.Dm.S(),this.Dm=null);let c={ud:this.Qd.$t().ud()},d=()=>b.leftPriceScale.borderVisible&&a.St().W().borderVisible,e=()=>a.bd();b.leftPriceScale.visible&&null===this.Rm&&(this.Rm=new c0("left",b,c,d,e),this.Bm.appendChild(this.Rm.lp())),b.rightPriceScale.visible&&null===this.Dm&&(this.Dm=new c0("right",b,c,d,e),this.Am.appendChild(this.Dm.lp()))}}let c6=!!cC&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(a=>a.brand.includes("Chromium"))&&!!cC&&((null==(p=null==navigator?void 0:navigator.userAgentData)?void 0:p.platform)?"Windows"===navigator.userAgentData.platform:navigator.userAgent.toLowerCase().indexOf("win")>=0);class c7{constructor(a,b,c){var d;this.Xm=[],this.Km=0,this.ho=0,this.__=0,this.Gm=0,this.Jm=0,this.Qm=null,this.tb=!1,this.Vp=new T,this.Op=new T,this.Rc=new T,this.ib=null,this.nb=null,this.Jd=a,this.cn=b,this.q_=c,this.Xd=document.createElement("div"),this.Xd.classList.add("tv-lightweight-charts"),this.Xd.style.overflow="hidden",this.Xd.style.direction="ltr",this.Xd.style.width="100%",this.Xd.style.height="100%",(d=this.Xd).style.userSelect="none",d.style.webkitUserSelect="none",d.style.msUserSelect="none",d.style.MozUserSelect="none",d.style.webkitTapHighlightColor="transparent",this.sb=document.createElement("table"),this.sb.setAttribute("cellspacing","0"),this.Xd.appendChild(this.sb),this.eb=this.rb.bind(this),c8(this.cn)&&this.hb(!0),this.$i=new cl(this.Vc.bind(this),this.cn,c),this.$t().Xc().l(this.lb.bind(this),this),this.ab=new c5(this,this.q_),this.sb.appendChild(this.ab.lp());let e=b.autoSize&&this.ob(),f=this.cn.width,g=this.cn.height;if(e||0===f||0===g){let b=a.getBoundingClientRect();f=f||b.width,g=g||b.height}this._b(f,g),this.ub(),a.appendChild(this.Xd),this.cb(),this.$i.St().ec().l(this.$i.Kl.bind(this.$i),this),this.$i.g_().l(this.$i.Kl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}Yp(){return this.Xm}fb(){return this.ab}S(){for(let a of(this.hb(!1),0!==this.Km&&window.cancelAnimationFrame(this.Km),this.$i.Xc().p(this),this.$i.St().ec().p(this),this.$i.g_().p(this),this.$i.S(),this.Xm))this.sb.removeChild(a.lp()),a.lm().p(this),a.am().p(this),a.S();this.Xm=[],H(this.ab).S(),null!==this.Xd.parentElement&&this.Xd.parentElement.removeChild(this.Xd),this.Rc.S(),this.Vp.S(),this.Op.S(),this.pb()}_b(a,b,c=!1){if(this.ho===b&&this.__===a)return;let e=function(a){let b=Math.floor(a.width),c=Math.floor(a.height);return d({width:b-b%2,height:c-c%2})}(d({width:a,height:b}));this.ho=e.height,this.__=e.width;let f=this.ho+"px",g=this.__+"px";H(this.Xd).style.height=f,H(this.Xd).style.width=g,this.sb.style.height=f,this.sb.style.width=g,c?this.mb(ay.es(),performance.now()):this.$i.Kl()}vp(a){void 0===a&&(a=ay.es());for(let b=0;b<this.Xm.length;b++)this.Xm[b].vp(a.Hn(b).Fn);this.cn.timeScale.visible&&this.ab.vp(a.jn())}$h(a){let b=c8(this.cn);this.$i.$h(a);let c=c8(this.cn);c!==b&&this.hb(c),this.cb(),this.bb(a)}lm(){return this.Vp}am(){return this.Op}Xc(){return this.Rc}wb(){null!==this.Qm&&(this.mb(this.Qm,performance.now()),this.Qm=null);let a=this.gb(null),b=document.createElement("canvas");b.width=a.width,b.height=a.height;let c=H(b.getContext("2d"));return this.gb(c),b}Mb(a){return("left"!==a||this.xb())&&("right"!==a||this.Sb())&&0!==this.Xm.length?H("left"===a?this.Xm[0].wm():this.Xm[0].gm()).dp():0}kb(){return this.cn.autoSize&&null!==this.ib}yb(){return this.Xd}Qp(a){this.nb=a,this.nb?this.yb().style.setProperty("cursor",a):this.yb().style.removeProperty("cursor")}Cb(){return this.nb}Tb(){return G(this.Xm[0]).um()}bb(a){(void 0!==a.autoSize||!this.ib||void 0===a.width&&void 0===a.height)&&(a.autoSize&&!this.ib&&this.ob(),!1===a.autoSize&&null!==this.ib&&this.pb(),a.autoSize||void 0===a.width&&void 0===a.height||this._b(a.width||this.__,a.height||this.ho))}gb(a){let b=0,c=0,e=this.Xm[0],f=(b,c)=>{let d=0;for(let e=0;e<this.Xm.length;e++){let f=this.Xm[e],g=H("left"===b?f.wm():f.gm()),h=g.xp();null!==a&&g.Sp(a,c,d),d+=h.height}};this.xb()&&(f("left",0),b+=H(e.wm()).xp().width);for(let d=0;d<this.Xm.length;d++){let e=this.Xm[d],f=e.xp();null!==a&&e.Sp(a,b,c),c+=f.height}b+=e.xp().width,this.Sb()&&(f("right",b),b+=H(e.gm()).xp().width);let g=(b,c,d)=>{H("left"===b?this.ab.Lm():this.ab.Em()).Sp(H(a),c,d)};if(this.cn.timeScale.visible){let b=this.ab.xp();if(null!==a){let d=0;this.xb()&&(g("left",d,c),d=H(e.wm()).xp().width),this.ab.Sp(a,d,c),d+=b.width,this.Sb()&&g("right",d,c)}c+=b.height}return d({width:b,height:c})}Pb(){var a,b,c;let e=0,f=0,g=0;for(let a of this.Xm)this.xb()&&(f=Math.max(f,H(a.wm()).op(),this.cn.leftPriceScale.minimumWidth)),this.Sb()&&(g=Math.max(g,H(a.gm()).op(),this.cn.rightPriceScale.minimumWidth)),e+=a.M_();f=(b=f)+b%2,g=(c=g)+c%2;let h=this.__,i=this.ho,j=Math.max(h-f-g,0),k=this.cn.timeScale.visible,l=k?Math.max(this.ab.Wm(),this.cn.timeScale.minimumHeight):0,m=0+(l=(a=l)+a%2),n=i<m?0:i-m,o=n/e,p=0;for(let a=0;a<this.Xm.length;++a){let b=this.Xm[a];b.qp(this.$i.qc()[a]);let c=0;c=Math.max(a===this.Xm.length-1?n-p:Math.round(b.M_()*o),2),p+=c,b.cp(d({width:j,height:c})),this.xb()&&b._m(f,"left"),this.Sb()&&b._m(g,"right"),b.fp()&&this.$i.Kc(b.fp(),c)}this.ab.Fm(d({width:k?j:0,height:l}),k?f:0,k?g:0),this.$i.S_(j),this.Gm!==f&&(this.Gm=f),this.Jm!==g&&(this.Jm=g)}hb(a){a?this.Xd.addEventListener("wheel",this.eb,{passive:!1}):this.Xd.removeEventListener("wheel",this.eb)}Rb(a){switch(a.deltaMode){case a.DOM_DELTA_PAGE:return 120;case a.DOM_DELTA_LINE:return 32}return c6?1/window.devicePixelRatio:1}rb(a){if(!(0!==a.deltaX&&this.cn.handleScroll.mouseWheel||0!==a.deltaY&&this.cn.handleScale.mouseWheel))return;let b=this.Rb(a),c=b*a.deltaX/100,d=-b*a.deltaY/100;if(a.cancelable&&a.preventDefault(),0!==d&&this.cn.handleScale.mouseWheel){let b=Math.sign(d)*Math.min(1,Math.abs(d)),c=a.clientX-this.Xd.getBoundingClientRect().left;this.$t().Qc(c,b)}0!==c&&this.cn.handleScroll.mouseWheel&&this.$t().td(-80*c)}mb(a,b){var c;let d=a.jn();3===d&&this.Db(),3!==d&&2!==d||(this.Vb(a),this.Ob(a,b),this.ab.bt(),this.Xm.forEach(a=>{a.Xp()}),3===(null==(c=this.Qm)?void 0:c.jn())&&(this.Qm.ts(a),this.Db(),this.Vb(this.Qm),this.Ob(this.Qm,b),a=this.Qm,this.Qm=null)),this.vp(a)}Ob(a,b){for(let c of a.Qn())this.ns(c,b)}Vb(a){let b=this.$i.qc();for(let c=0;c<b.length;c++)a.Hn(c).Wn&&b[c].N_()}ns(a,b){let c=this.$i.St();switch(a.qn){case 0:c.hc();break;case 1:c.lc(a.Vt);break;case 2:c.Gn(a.Vt);break;case 3:c.Jn(a.Vt);break;case 4:c.qu();break;case 5:a.Vt.Qu(b)||c.Jn(a.Vt.tc(b))}}Vc(a){null!==this.Qm?this.Qm.ts(a):this.Qm=a,this.tb||(this.tb=!0,this.Km=window.requestAnimationFrame(a=>{if(this.tb=!1,this.Km=0,null!==this.Qm){let b=this.Qm;for(let c of(this.Qm=null,this.mb(b,a),b.Qn()))if(5===c.qn&&!c.Vt.Qu(a)){this.$t().Zn(c.Vt);break}}}))}Db(){this.ub()}ub(){let a=this.$i.qc(),b=a.length,c=this.Xm.length;for(let a=b;a<c;a++){let a=G(this.Xm.pop());this.sb.removeChild(a.lp()),a.lm().p(this),a.am().p(this),a.S()}for(let d=c;d<b;d++){let b=new c_(this,a[d]);b.lm().l(this.Bb.bind(this),this),b.am().l(this.Ab.bind(this),this),this.Xm.push(b),this.sb.insertBefore(b.lp(),this.ab.lp())}for(let c=0;c<b;c++){let b=a[c],d=this.Xm[c];d.fp()!==b?d.qp(b):d.Up()}this.cb(),this.Pb()}Ib(a,b,c){var d;let e,f=new Map;if(null!==a&&this.$i.wt().forEach(b=>{let c=b.In().ll(a);null!==c&&f.set(b,c)}),null!==a){let b=null==(d=this.$i.St().Ui(a))?void 0:d.originalTime;void 0!==b&&(e=b)}let g=this.$t().Wc();return{zb:e,ee:null!=a?a:void 0,Lb:null!=b?b:void 0,Eb:null!==g&&g.Hc instanceof bS?g.Hc:void 0,Nb:f,Fb:null!==g&&void 0!==g.Iv?g.Iv.gr:void 0,Wb:null!=c?c:void 0}}Bb(a,b,c){this.Vp.m(()=>this.Ib(a,b,c))}Ab(a,b,c){this.Op.m(()=>this.Ib(a,b,c))}lb(a,b,c){this.Rc.m(()=>this.Ib(a,b,c))}cb(){let a=this.cn.timeScale.visible?"":"none";this.ab.lp().style.display=a}xb(){return this.Xm[0].fp().R_().W().visible}Sb(){return this.Xm[0].fp().D_().W().visible}ob(){return"ResizeObserver"in window&&(this.ib=new ResizeObserver(a=>{let b=a.find(a=>a.target===this.Jd);b&&this._b(b.contentRect.width,b.contentRect.height)}),this.ib.observe(this.Jd,{box:"border-box"}),!0)}pb(){null!==this.ib&&this.ib.disconnect(),this.ib=null}}function c8(a){return!!(a.handleScroll.mouseWheel||a.handleScale.mouseWheel)}function c9(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]])}return c}function da(a,b,c,d){let e=c.value,f={ee:b,ot:a,Vt:[e,e,e,e],zb:d};return void 0!==c.color&&(f.V=c.color),f}function db(a,b,c,d){let e=c.value,f={ee:b,ot:a,Vt:[e,e,e,e],zb:d};return void 0!==c.lineColor&&(f.lt=c.lineColor),void 0!==c.topColor&&(f.Ps=c.topColor),void 0!==c.bottomColor&&(f.Rs=c.bottomColor),f}function dc(a,b,c,d){let e=c.value,f={ee:b,ot:a,Vt:[e,e,e,e],zb:d};return void 0!==c.topLineColor&&(f.Re=c.topLineColor),void 0!==c.bottomLineColor&&(f.De=c.bottomLineColor),void 0!==c.topFillColor1&&(f.ke=c.topFillColor1),void 0!==c.topFillColor2&&(f.ye=c.topFillColor2),void 0!==c.bottomFillColor1&&(f.Ce=c.bottomFillColor1),void 0!==c.bottomFillColor2&&(f.Te=c.bottomFillColor2),f}function dd(a,b,c,d){let e={ee:b,ot:a,Vt:[c.open,c.high,c.low,c.close],zb:d};return void 0!==c.color&&(e.V=c.color),e}function de(a,b,c,d){let e={ee:b,ot:a,Vt:[c.open,c.high,c.low,c.close],zb:d};return void 0!==c.color&&(e.V=c.color),void 0!==c.borderColor&&(e.Ot=c.borderColor),void 0!==c.wickColor&&(e.Xh=c.wickColor),e}function df(a,b,c,d,e){let f=G(e)(c),g=Math.max(...f),h=Math.min(...f),i=f[f.length-1],{time:j,color:k}=c;return{ee:b,ot:a,Vt:[i,g,h,i],zb:d,$e:c9(c,["time","color"]),V:k}}function dg(a){return void 0!==a.Vt}function dh(a,b){return void 0!==b.customValues&&(a.jb=b.customValues),a}function di(a){return(b,c,d,e,f,g)=>{var h,i;return(h=d,(i=g)?i(h):void 0===h.open&&void 0===h.value)?dh({ot:b,ee:c,zb:e},d):dh(a(b,c,d,e,f),d)}}function dj(a){return({Candlestick:di(de),Bar:di(dd),Area:di(db),Baseline:di(dc),Histogram:di(da),Line:di(da),Custom:di(df)})[a]}function dk(a){return{ee:0,Hb:new Map,la:a}}function dl(a,b){if(void 0!==a&&0!==a.length)return{$b:b.key(a[0].ot),Ub:b.key(a[a.length-1].ot)}}function dm(a){let b;return a.forEach(a=>{void 0===b&&(b=a.zb)}),G(b)}class dn{constructor(a){this.qb=new Map,this.Yb=new Map,this.Zb=new Map,this.Xb=[],this.q_=a}S(){this.qb.clear(),this.Yb.clear(),this.Zb.clear(),this.Xb=[]}Kb(a,b){let c=0!==this.qb.size,d=!1,e=this.Yb.get(a);if(void 0!==e)if(1===this.Yb.size)c=!1,d=!0,this.qb.clear();else for(let b of this.Xb)b.pointData.Hb.delete(a)&&(d=!0);let f=[];if(0!==b.length){let c=b.map(a=>a.time),e=this.q_.createConverterToInternalObj(b),g=dj(a.Qh()),h=a.Ca(),i=a.Ta();f=b.map((b,f)=>{let j=e(b.time),k=this.q_.key(j),l=this.qb.get(k);void 0===l&&(l=dk(j),this.qb.set(k,l),d=!0);let m=g(j,l.ee,b,c[f],h,i);return l.Hb.set(a,m),m})}c&&this.Gb(),this.Jb(a,f);let g=-1;if(d){let a=[];this.qb.forEach(b=>{a.push({timeWeight:0,time:b.la,pointData:b,originalTime:dm(b.Hb)})}),a.sort((a,b)=>this.q_.key(a.time)-this.q_.key(b.time)),g=this.Qb(a)}return this.tw(a,g,function(a,b,c){let d=dl(a,c),e=dl(b,c);if(void 0!==d&&void 0!==e)return{ta:d.Ub>=e.Ub&&d.$b>=e.$b}}(this.Yb.get(a),e,this.q_))}vd(a){return this.Kb(a,[])}iw(a,b){void 0===b.zb&&(b.zb=b.time),this.q_.preprocessData(b);let c=this.q_.createConverterToInternalObj([b])(b.time),d=this.Zb.get(a);if(void 0!==d&&this.q_.key(c)<this.q_.key(d))throw Error(`Cannot update oldest data, last time=${d}, new time=${c}`);let e=this.qb.get(this.q_.key(c)),f=void 0===e;void 0===e&&(e=dk(c),this.qb.set(this.q_.key(c),e));let g=dj(a.Qh()),h=a.Ca(),i=a.Ta(),j=g(c,e.ee,b,b.zb,h,i);e.Hb.set(a,j),this.nw(a,j);let k={ta:dg(j)};if(!f)return this.tw(a,-1,k);let l={timeWeight:0,time:e.la,pointData:e,originalTime:dm(e.Hb)},m=aQ(this.Xb,this.q_.key(l.time),(a,b)=>this.q_.key(a.time)<b);this.Xb.splice(m,0,l);for(let a=m;a<this.Xb.length;++a)dp(this.Xb[a].pointData,a);return this.q_.fillWeightsForPoints(this.Xb,m),this.tw(a,m,k)}nw(a,b){let c=this.Yb.get(a);void 0===c&&(c=[],this.Yb.set(a,c));let d=0!==c.length?c[c.length-1]:null;null===d||this.q_.key(b.ot)>this.q_.key(d.ot)?dg(b)&&c.push(b):dg(b)?c[c.length-1]=b:c.splice(-1,1),this.Zb.set(a,b.ot)}Jb(a,b){0!==b.length?(this.Yb.set(a,b.filter(dg)),this.Zb.set(a,b[b.length-1].ot)):(this.Yb.delete(a),this.Zb.delete(a))}Gb(){for(let a of this.Xb)0===a.pointData.Hb.size&&this.qb.delete(this.q_.key(a.time))}Qb(a){let b=-1;for(let c=0;c<this.Xb.length&&c<a.length;++c){let d=this.Xb[c],e=a[c];if(this.q_.key(d.time)!==this.q_.key(e.time)){b=c;break}e.timeWeight=d.timeWeight,dp(e.pointData,c)}if(-1===b&&this.Xb.length!==a.length&&(b=Math.min(this.Xb.length,a.length)),-1===b)return -1;for(let c=b;c<a.length;++c)dp(a[c].pointData,c);return this.q_.fillWeightsForPoints(a,b),this.Xb=a,b}sw(){if(0===this.Yb.size)return null;let a=0;return this.Yb.forEach(b=>{0!==b.length&&(a=Math.max(a,b[b.length-1].ee))}),a}tw(a,b,c){let d={ew:new Map,St:{Eu:this.sw()}};if(-1!==b)this.Yb.forEach((b,e)=>{d.ew.set(e,{$e:b,rw:e===a?c:void 0})}),this.Yb.has(a)||d.ew.set(a,{$e:[],rw:c}),d.St.hw=this.Xb,d.St.lw=b;else{let b=this.Yb.get(a);d.ew.set(a,{$e:b||[],rw:c})}return d}}function dp(a,b){a.ee=b,a.Hb.forEach(a=>{a.ee=b})}function dq(a){let b={value:a.Vt[3],time:a.zb};return void 0!==a.jb&&(b.customValues=a.jb),b}function dr(a){let b=dq(a);return void 0!==a.V&&(b.color=a.V),b}function ds(a){let b=dq(a);return void 0!==a.lt&&(b.lineColor=a.lt),void 0!==a.Ps&&(b.topColor=a.Ps),void 0!==a.Rs&&(b.bottomColor=a.Rs),b}function dt(a){let b=dq(a);return void 0!==a.Re&&(b.topLineColor=a.Re),void 0!==a.De&&(b.bottomLineColor=a.De),void 0!==a.ke&&(b.topFillColor1=a.ke),void 0!==a.ye&&(b.topFillColor2=a.ye),void 0!==a.Ce&&(b.bottomFillColor1=a.Ce),void 0!==a.Te&&(b.bottomFillColor2=a.Te),b}function du(a){let b={open:a.Vt[0],high:a.Vt[1],low:a.Vt[2],close:a.Vt[3],time:a.zb};return void 0!==a.jb&&(b.customValues=a.jb),b}function dv(a){let b=du(a);return void 0!==a.V&&(b.color=a.V),b}function dw(a){let b=du(a),{V:c,Ot:d,Xh:e}=a;return void 0!==c&&(b.color=c),void 0!==d&&(b.borderColor=d),void 0!==e&&(b.wickColor=e),b}function dx(a){return({Area:ds,Line:dr,Baseline:dt,Histogram:dr,Bar:dv,Candlestick:dw,Custom:dy})[a]}function dy(a){let b=a.zb;return Object.assign(Object.assign({},a.$e),{time:b})}let dz={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},dA={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},dB={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:aa,attributionLogo:!0},dC={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},dD={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},dE={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:aa,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function dF(){return{width:0,height:0,autoSize:!1,layout:dB,crosshair:dz,grid:dA,overlayPriceScales:Object.assign({},dC),leftPriceScale:Object.assign(Object.assign({},dC),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},dC),{visible:!0}),timeScale:dD,watermark:dE,localization:{locale:cC?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class dG{constructor(a,b){this.aw=a,this.ow=b}applyOptions(a){this.aw.$t().$c(this.ow,a)}options(){return this.Li().W()}width(){return ax(this.ow)?this.aw.Mb(this.ow):0}Li(){return H(this.aw.$t().Uc(this.ow)).Dt}}function dH(a,b,c){let d=Object.assign({time:b},c9(a,["time","originalTime"]));return void 0!==c&&(d.originalTime=c),d}let dI={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class dJ{constructor(a){this.Nh=a}applyOptions(a){this.Nh.$h(a)}options(){return this.Nh.W()}_w(){return this.Nh}}class dK{constructor(a,b,c,d,e){this.uw=new T,this.Es=a,this.cw=b,this.dw=c,this.q_=e,this.fw=d}S(){this.uw.S()}priceFormatter(){return this.Es.ba()}priceToCoordinate(a){let b=this.Es.Ct();return null===b?null:this.Es.Dt().Rt(a,b.Vt)}coordinateToPrice(a){let b=this.Es.Ct();return null===b?null:this.Es.Dt().pn(a,b.Vt)}barsInLogicalRange(a){if(null===a)return null;let b=new ce(new cb(a.from,a.to)).lu(),c=this.Es.In();if(c.Ni())return null;let d=c.ll(b.Os(),1),e=c.ll(b.ui(),-1),f=H(c.el()),g=H(c.An());if(null!==d&&null!==e&&d.ee>e.ee)return{barsBefore:a.from-f,barsAfter:g-a.to};let h={barsBefore:null===d||d.ee===f?a.from-f:d.ee-f,barsAfter:null===e||e.ee===g?g-a.to:g-e.ee};return null!==d&&null!==e&&(h.from=d.zb,h.to=e.zb),h}setData(a){this.q_,this.Es.Qh(),this.cw.pw(this.Es,a),this.mw("full")}update(a){this.Es.Qh(),this.cw.bw(this.Es,a),this.mw("update")}dataByIndex(a,b){let c=this.Es.In().ll(a,b);return null===c?null:dx(this.seriesType())(c)}data(){let a=dx(this.seriesType());return this.Es.In().ne().map(b=>a(b))}subscribeDataChanged(a){this.uw.l(a)}unsubscribeDataChanged(a){this.uw.v(a)}setMarkers(a){this.q_;let b=a.map(a=>dH(a,this.q_.convertHorzItemToInternal(a.time),a.time));this.Es.na(b)}markers(){return this.Es.sa().map(a=>dH(a,a.originalTime,void 0))}applyOptions(a){this.Es.$h(a)}options(){return Z(this.Es.W())}priceScale(){return this.dw.priceScale(this.Es.Dt().Pa())}createPriceLine(a){let b=U(Z(dI),a);return new dJ(this.Es.ea(b))}removePriceLine(a){this.Es.ra(a._w())}seriesType(){return this.Es.Qh()}attachPrimitive(a){this.Es.ka(a),a.attached&&a.attached({chart:this.fw,series:this,requestUpdate:()=>this.Es.$t().Kl()})}detachPrimitive(a){this.Es.ya(a),a.detached&&a.detached()}mw(a){this.uw.M()&&this.uw.m(a)}}class dL{constructor(a,b,c){this.ww=new T,this.mu=new T,this.Om=new T,this.$i=a,this.yl=a.St(),this.ab=b,this.yl.nc().l(this.gw.bind(this)),this.yl.sc().l(this.Mw.bind(this)),this.ab.Nm().l(this.xw.bind(this)),this.q_=c}S(){this.yl.nc().p(this),this.yl.sc().p(this),this.ab.Nm().p(this),this.ww.S(),this.mu.S(),this.Om.S()}scrollPosition(){return this.yl.Hu()}scrollToPosition(a,b){b?this.yl.Ju(a,1e3):this.$i.Jn(a)}scrollToRealTime(){this.yl.Gu()}getVisibleRange(){let a=this.yl.Vu();return null===a?null:{from:a.from.originalTime,to:a.to.originalTime}}setVisibleRange(a){let b={from:this.q_.convertHorzItemToInternal(a.from),to:this.q_.convertHorzItemToInternal(a.to)},c=this.yl.Iu(b);this.$i.pd(c)}getVisibleLogicalRange(){let a=this.yl.Du();return null===a?null:{from:a.Os(),to:a.ui()}}setVisibleLogicalRange(a){F(a.from<=a.to,"The from index cannot be after the to index."),this.$i.pd(a)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.hc()}logicalToCoordinate(a){let b=this.$i.St();return b.Ni()?null:b.It(a)}coordinateToLogical(a){return this.yl.Ni()?null:this.yl.Nu(a)}timeToCoordinate(a){let b=this.q_.convertHorzItemToInternal(a),c=this.yl.Va(b,!1);return null===c?null:this.yl.It(c)}coordinateToTime(a){let b=this.$i.St(),c=b.Nu(a),d=b.Ui(c);return null===d?null:d.originalTime}width(){return this.ab.um().width}height(){return this.ab.um().height}subscribeVisibleTimeRangeChange(a){this.ww.l(a)}unsubscribeVisibleTimeRangeChange(a){this.ww.v(a)}subscribeVisibleLogicalRangeChange(a){this.mu.l(a)}unsubscribeVisibleLogicalRangeChange(a){this.mu.v(a)}subscribeSizeChange(a){this.Om.l(a)}unsubscribeSizeChange(a){this.Om.v(a)}applyOptions(a){this.yl.$h(a)}options(){return Object.assign(Object.assign({},Z(this.yl.W())),{barSpacing:this.yl.le()})}gw(){this.ww.M()&&this.ww.m(this.getVisibleRange())}Mw(){this.mu.M()&&this.mu.m(this.getVisibleLogicalRange())}xw(a){this.Om.m(a.width,a.height)}}function dM(a){return function(a){if(Y(a.handleScale)){let b=a.handleScale;a.handleScale={axisDoubleClickReset:{time:b,price:b},axisPressedMouseMove:{time:b,price:b},mouseWheel:b,pinch:b}}else if(void 0!==a.handleScale){let{axisPressedMouseMove:b,axisDoubleClickReset:c}=a.handleScale;Y(b)&&(a.handleScale.axisPressedMouseMove={time:b,price:b}),Y(c)&&(a.handleScale.axisDoubleClickReset={time:c,price:c})}let b=a.handleScroll;Y(b)&&(a.handleScroll={horzTouchDrag:b,vertTouchDrag:b,mouseWheel:b,pressedMouseMove:b})}(a),a}class dN{constructor(a,b,c){this.Sw=new Map,this.kw=new Map,this.yw=new T,this.Cw=new T,this.Tw=new T,this.Pw=new dn(b);let d=void 0===c?Z(dF()):U(Z(dF()),dM(c));this.q_=b,this.aw=new c7(a,d,b),this.aw.lm().l(a=>{this.yw.M()&&this.yw.m(this.Rw(a()))},this),this.aw.am().l(a=>{this.Cw.M()&&this.Cw.m(this.Rw(a()))},this),this.aw.Xc().l(a=>{this.Tw.M()&&this.Tw.m(this.Rw(a()))},this);let e=this.aw.$t();this.Dw=new dL(e,this.aw.fb(),this.q_)}remove(){this.aw.lm().p(this),this.aw.am().p(this),this.aw.Xc().p(this),this.Dw.S(),this.aw.S(),this.Sw.clear(),this.kw.clear(),this.yw.S(),this.Cw.S(),this.Tw.S(),this.Pw.S()}resize(a,b,c){this.autoSizeActive()||this.aw._b(a,b,c)}addCustomSeries(a,b){let c=I(a),d=Object.assign(Object.assign({},B),c.defaultOptions());return this.Vw("Custom",d,b,c)}addAreaSeries(a){return this.Vw("Area",y,a)}addBaselineSeries(a){return this.Vw("Baseline",z,a)}addBarSeries(a){return this.Vw("Bar",w,a)}addCandlestickSeries(a={}){return void 0!==a.borderColor&&(a.borderUpColor=a.borderColor,a.borderDownColor=a.borderColor),void 0!==a.wickColor&&(a.wickUpColor=a.wickColor,a.wickDownColor=a.wickColor),this.Vw("Candlestick",v,a)}addHistogramSeries(a){return this.Vw("Histogram",A,a)}addLineSeries(a){return this.Vw("Line",x,a)}removeSeries(a){let b=G(this.Sw.get(a)),c=this.Pw.vd(b);this.aw.$t().vd(b),this.Ow(c),this.Sw.delete(a),this.kw.delete(b)}pw(a,b){this.Ow(this.Pw.Kb(a,b))}bw(a,b){this.Ow(this.Pw.iw(a,b))}subscribeClick(a){this.yw.l(a)}unsubscribeClick(a){this.yw.v(a)}subscribeCrosshairMove(a){this.Tw.l(a)}unsubscribeCrosshairMove(a){this.Tw.v(a)}subscribeDblClick(a){this.Cw.l(a)}unsubscribeDblClick(a){this.Cw.v(a)}priceScale(a){return new dG(this.aw,a)}timeScale(){return this.Dw}applyOptions(a){this.aw.$h(dM(a))}options(){return this.aw.W()}takeScreenshot(){return this.aw.wb()}autoSizeActive(){return this.aw.kb()}chartElement(){return this.aw.yb()}paneSize(){let a=this.aw.Tb();return{height:a.height,width:a.width}}setCrosshairPosition(a,b,c){let d=this.Sw.get(c);if(void 0===d)return;let e=this.aw.$t().dr(d);null!==e&&this.aw.$t().ad(a,b,e)}clearCrosshairPosition(){this.aw.$t().od(!0)}Vw(a,b,c={},d){var e;void 0!==(e=c.priceFormat)&&"custom"!==e.type&&void 0!==e.minMove&&void 0===e.precision&&(e.precision=function(a){if(a>=1)return 0;let b=0;for(;b<8&&!(1e-8>Math.abs(Math.round(a)-a));b++)a*=10;return b}(e.minMove));let f=U(Z(C),Z(b),c),g=this.aw.$t().dd(a,f,d),h=new dK(g,this,this,this,this.q_);return this.Sw.set(h,g),this.kw.set(g,h),h}Ow(a){let b=this.aw.$t();b._d(a.St.Eu,a.St.hw,a.St.lw),a.ew.forEach((a,b)=>b.J(a.$e,a.rw)),b.Wu()}Bw(a){return G(this.kw.get(a))}Rw(a){let b=new Map;a.Nb.forEach((a,c)=>{let d=c.Qh(),e=dx(d)(a);if("Custom"!==d){var f;F(void 0!==(f=e).open||void 0!==f.value)}else{let a=c.Ta();F(!a||!1===a(e))}b.set(this.Bw(c),e)});let c=void 0!==a.Eb&&this.kw.has(a.Eb)?this.Bw(a.Eb):void 0;return{time:a.zb,logical:a.ee,point:a.Lb,hoveredSeries:c,hoveredObjectId:a.Fb,seriesData:b,sourceEvent:a.Wb}}}function dO(a,b,c){let d;if(X(a)){let b=document.getElementById(a);F(null!==b,`Cannot find element in DOM with id=${a}`),d=b}else d=a;let e=new dN(d,b,c);return b.setOptions(e.options()),e}function dP(a,b){return dO(a,new cB,cB.Id(b))}function dQ(){return cB}let dR=Object.assign(Object.assign({},C),B);function dS(){return"4.2.3"}}};